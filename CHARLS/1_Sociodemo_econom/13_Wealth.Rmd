---
title: "Wealth"
output: 
  html_document:
    theme: united
    highlight: tango
    toc: true
    toc_depth: 6
    toc_float:
      collapsed: true
      smooth_scroll: true
    number_sections: true
---

<!-- ########################################################## --> 

<!-- # Installation, loading packages -->
<!-- **R script:** -->



```{r setup, include=FALSE,  echo=FALSE}
source("M:/WPs/WP1/Maelstrom/data_process/athlos-project.github.io/setup_laia.r")
source("M:/WPs/WP1/Maelstrom/data_process/athlos-project.github.io/CHARLS/CHARLS_ids.R")
```

<!-- ########################################################## --> 

# Description of DataSchema variable 

* Short name: `wealth`
* Variable label: `Total score based in all sources of income transformed into a comparable and normalized categoric variable.`
* Domain: `Socio-demographic and economic characteristics`
* Value type: `categorical ordinal`
* Category coding:

**Code** | **Category Label**
-------- | ------------------
1        | 1st quintile
2        | 2nd quintile
3        | 3rd quintile
4        | 4th quintile
5        | 5th quintile

* Category missings: 

**Code** | **Category Label**
----| ------------------
991 | CAPI/interviewer error
992 | Impute
993 | Disable to measure
994 | Not attempt/not done
995 | Does not answer
996 | Not applicable
997 | Refuse
998 | Do not know
999 | Missing

* Comments: `Need to pay attention to specificities like: before/after taxes or contributions. People: HH income is prioritized. When not available individual/caregiver/informant/family income is caolected. Source: Pension/family/work/government/disablity/total. all sources are taken into account. For some studies, the maximum value can be compared (and crossed by sex and age to control biases) . Time-lapse: weekly, monthly, in the last 12 months. 'Many values are missing since not all respondents have all sources of income or, within the household there is not always more members, in these cases do not confuse missing data with missing values and mean a 0 should be added to the total sum in each case.`

```{r lab, echo=FALSE}
ds_label <- "Wealth"
ds_label_all <- "Total score based in all sources of income transformed into a comparable and normalized categoric variable"
```


# Data process

## CHARLS

### Wave 1 

#### Study-specific variable description

| **Name** | `ga002`, `ga002_a`, `ga002_b`, `ga002_1`, `hc024`, `ga004_1_1_`, `ga004_2_1_`, `ga004_1_2_`, `ga004_2_2_`, `ga004_1_3_`, `ga004_2_3_`, `ga004_1_4_`, `ga004_2_4_`, `ga004_1_5_`, `ga004_2_5_`, `ga004_1_6_`, `ga004_2_6_`, `ga004_1_7_`, `ga004_2_7_`, `ga004_1_8_`, `ga004_2_8_`, `ga004_1_9_`, `ga004_2_9_`, `ga004_1_10_`, `ga004_2_10_`, `ga004_1_11_`, `ga004_2_11_`,  `gb005`, `gb005_a`, `gb005_b`, `gb009`, `gb009_a`, `gb009_b`, `gb011`, `gb011_a`, `gb011_b`, `gb012`, `gb012_a`, `gb012_b`, `gc005_1_`, `gc005_a_1_`, `gc005_b_1_`, `gc005_2_`, `gc005_a_2_`, `gc005_b_2_`, `gc005_3_`, `gd001_c`, `gd002_1`, `gd002_2`, `gd002_3`, `gd002_4`, `gd002_5`, `gd002_6`, `gd002_7`, `ha052_1`, `ha053_1`, `ha060_1_`, `ha060_2_`, `ha060_3_`, `ha060_4_`, `ha064_1`, `ha071`, `ga006_1_1_`, `ga006_2_1_`, `ga006_a_1_`, `ga006_b_1_`, `ga006_1_2_`, `ga006_2_2_`, `ga006_a_2_`, `ga006_b_2_`, `ga006_1_3_`, `ga006_2_3_`, `ga006_a_3_`, `ga006_b_3_`, `ga006_1_4_`, `ga006_2_4_`, `ga006_a_4_`, `ga006_b_4_`, `ga006_1_5_`, `ga006_2_5_`, `ga006_a_5_`, `ga006_b_5_`, `ga006_1_6_`, `ga006_2_6_`, `ga006_a_6_`, `ga006_b_6_`, `ga006_1_7_`, `ga006_2_7_`, `ga006_a_7_`, `ga006_b_7_`, `ga006_1_8_`, `ga006_2_8_`, `ga006_a_8_`, `ga006_b_8_`, `ga006_1_9_`, `ga006_2_9_`, `ga006_a_9_`, `ga006_b_9_`, `ga006_1_10_`, `ga006_2_10_`, `ga006_1_11_`, `ga006_2_11_`, `ga006_1_12_`, `ga006_2_12_`, `ga006_a_12_`, `ga006_b_12_`, `ga006_1_13_`, `ga006_2_13_`, `ga006_1_14_`, `ga006_2_14_`, `ga006_1_15_`, `ga006_2_15_`, `ga008_1_a_1_`, `ga008_1_b_1_`, `ga008_1_a_2_`, `ga008_1_b_2_`, `ga008_1_a_3_`, `ga008_1_b_3_`, `ga008_1_a_4_`, `ga008_1_b_4_`, `ga008_1_a_5_`, `ga008_1_b_5_`, `ga008_1_a_6_`, `ga008_1_b_6_`, `ga008_1_a_7_`, `ga008_1_b_7_`, `ga008_1_a_8_`, `ga008_1_b_8_`, `ga008_1_a_9_`, `ga008_1_b_9_`, `ga008_1_a_26_`, `ga008_1_b_26_`, `ga008_2_a_4_`, `ga008_2_b_4_`, `ga008_2_a_3_`, `ga008_2_b_3_`, `ga008_3_a_1_`, `ga008_3_b_1_`, `ga008_3_a_2_`, `ga008_3_b_2_`, `ga008_3_a_3_`, `ga008_3_b_3_`, `ga008_3_a_4_`, `ga008_3_b_4_`, `ga008_3_a_6_`, `ga008_3_b_6_`, `ga008_3_a_7_`, `ga008_3_b_7_`, `ga008_3_a_9_`, `ga008_3_b_9_`, `ga008_3_a_11_`, `ga008_3_b_11_`, `ga008_4_a_1_`, `ga008_4_b_1_`, `ga008_4_a_2_`, `ga008_4_b_2_`, `ga008_4_a_3_`, `ga008_4_b_3_`, `ga008_4_a_4_`, `ga008_4_b_4_`, `ga008_4_a_6_`, `ga008_4_b_6_`, `ga008_5_a_1_`, `ga008_5_b_1_`, `ga008_5_a_2_`, `ga008_5_b_2_`, `ga008_5_a_3_`, `ga008_5_b_3_`, `ga008_5_a_4_`, `ga008_5_b_4_`, `ga008_5_a_5_`, `ga008_5_b_5_`, `ga008_5_a_6_`, `ga008_5_b_6_`, `ga008_5_a_7_`, `ga008_5_b_7_`, `ga008_6_a_1_`, `ga008_6_b_1_`, `ga008_6_a_2_`, `ga008_6_b_2_`, `ga008_6_a_3_`, `ga008_6_b_3_`, `ga008_6_a_4_`, `ga008_6_b_4_`, `ga008_6_a_5_`, `ga008_6_b_5_`, `ga008_6_a_6_`, `ga008_6_b_6_`, `ga008_6_a_7_`, `ga008_6_b_7_`, `ga008_6_a_26_`, `ga008_6_b_26_`, `ga008_7_a_1_`, `ga008_7_b_1_`, `ga008_7_a_2_`, `ga008_7_b_2_`, `ga008_7_a_3_`, `ga008_7_b_3_`, `ga008_7_a_4_`, `ga008_7_b_4_`, `ga008_7_a_5_`, `ga008_7_b_5_`, `ga008_7_a_6_`, `ga008_7_b_6_`, `ga008_7_a_7_`, `ga008_7_b_7_`, `ga008_8_a_1_`, `ga008_8_b_1_`, `ga008_8_a_2_`, `ga008_8_b_2_`, `ga008_8_a_3_`, `ga008_8_b_3_`, `ga008_8_a_4_`, `ga008_8_b_4_`, `ga008_8_a_5_`, `ga008_8_b_5_`, `ga008_8_a_6_`, `ga008_8_b_6_`, `ga008_8_a_8_`, `ga008_8_b_8_`, `ga008_9_a_1_`, `ga008_9_b_1_`, `ga008_9_a_2_`, `ga008_9_b_2_`, `ga008_9_a_3_`, `ga008_9_b_3_`, `ga008_9_a_4_`, `ga008_9_b_4_`, `ga008_9_a_5_`, `ga008_9_b_5_`, `ga008_9_a_6_`, `ga008_9_b_6_`, `ga008_9_a_7_`, `ga008_9_b_7_` | 
|----------|------------|
<!-- | **Label** | `When were You Born:Year` |  `Birth Year` | --> 
| **Table name** | `individual_income_wave1` , `household_income_wave1` |
| **Description** |  |  




```{r assign1, echo=F}
opal.assign.table.tibble(o, 'CHARLS_wealth1','CHARLS.individual_income_wave1',
variables=list('householdID', 'ga002', 'ga002_a', 'ga002_b', 'ga002_1', 'hc024', 'ga004_1_1_', 'ga004_2_1_', 'ga004_1_2_', 'ga004_2_2_', 'ga004_1_3_', 'ga004_2_3_', 'ga004_1_4_', 'ga004_2_4_', 'ga004_1_5_', 'ga004_2_5_', 'ga004_1_6_', 'ga004_2_6_', 'ga004_1_7_', 'ga004_2_7_', 'ga004_1_8_', 'ga004_2_8_', 'ga004_1_9_', 'ga004_2_9_', 'ga004_1_10_', 'ga004_2_10_', 'ga004_1_11_', 'ga004_2_11_'), missings = TRUE)
CHARLS_wealth1 <- opal.execute(o,'CHARLS_wealth1')

opal.assign.table.tibble(o, 'CHARLS_wealth2','CHARLS.household_income_wave1',
variables=list('gb005', 'gb005_a', 'gb005_b', 'gb009', 'gb009_a', 'gb009_b', 'gb011', 'gb011_a', 'gb011_b', 'gb012', 'gb012_a', 'gb012_b', 'gc005_1_', 'gc005_a_1_', 'gc005_b_1_', 'gc005_2_', 'gc005_a_2_', 'gc005_b_2_', 'gc005_3_', 'gd001_c', 'gd002_1', 'gd002_2', 'gd002_3', 'gd002_4', 'gd002_5', 'gd002_6', 'gd002_7', 'ha052_1', 'ha053_1', 'ha060_1_', 'ha060_2_', 'ha060_3_', 'ha060_4_', 'ha064_1', 'ha071', 'ga006_1_1_', 'ga006_2_1_', 'ga006_a_1_', 'ga006_b_1_', 'ga006_1_2_', 'ga006_2_2_', 'ga006_a_2_', 'ga006_b_2_', 'ga006_1_3_', 'ga006_2_3_', 'ga006_a_3_', 'ga006_b_3_', 'ga006_1_4_', 'ga006_2_4_', 'ga006_a_4_', 'ga006_b_4_', 'ga006_1_5_', 'ga006_2_5_', 'ga006_a_5_', 'ga006_b_5_', 'ga006_1_6_', 'ga006_2_6_', 'ga006_a_6_', 'ga006_b_6_', 'ga006_1_7_', 'ga006_2_7_', 'ga006_a_7_', 'ga006_b_7_', 'ga006_1_8_', 'ga006_2_8_', 'ga006_a_8_', 'ga006_b_8_', 'ga006_1_9_', 'ga006_2_9_', 'ga006_a_9_', 'ga006_b_9_', 'ga006_1_10_', 'ga006_2_10_', 'ga006_1_11_', 'ga006_2_11_', 'ga006_1_12_', 'ga006_2_12_', 'ga006_a_12_', 'ga006_b_12_', 'ga006_1_13_', 'ga006_2_13_', 'ga006_1_14_', 'ga006_2_14_', 'ga006_1_15_', 'ga006_2_15_', 'ga008_1_a_1_', 'ga008_1_b_1_', 'ga008_1_a_2_', 'ga008_1_b_2_', 'ga008_1_a_3_', 'ga008_1_b_3_', 'ga008_1_a_4_', 'ga008_1_b_4_', 'ga008_1_a_5_', 'ga008_1_b_5_', 'ga008_1_a_6_', 'ga008_1_b_6_', 'ga008_1_a_7_', 'ga008_1_b_7_', 'ga008_1_a_8_', 'ga008_1_b_8_', 'ga008_1_a_9_', 'ga008_1_b_9_', 'ga008_1_a_26_', 'ga008_1_b_26_', 'ga008_2_a_4_', 'ga008_2_b_4_', 'ga008_2_a_3_', 'ga008_2_b_3_', 'ga008_3_a_1_', 'ga008_3_b_1_', 'ga008_3_a_2_', 'ga008_3_b_2_', 'ga008_3_a_3_', 'ga008_3_b_3_', 'ga008_3_a_4_', 'ga008_3_b_4_', 'ga008_3_a_6_', 'ga008_3_b_6_', 'ga008_3_a_7_', 'ga008_3_b_7_', 'ga008_3_a_9_', 'ga008_3_b_9_', 'ga008_3_a_11_', 'ga008_3_b_11_', 'ga008_4_a_1_', 'ga008_4_b_1_', 'ga008_4_a_2_', 'ga008_4_b_2_', 'ga008_4_a_3_', 'ga008_4_b_3_', 'ga008_4_a_4_', 'ga008_4_b_4_', 'ga008_4_a_6_', 'ga008_4_b_6_', 'ga008_5_a_1_', 'ga008_5_b_1_', 'ga008_5_a_2_', 'ga008_5_b_2_', 'ga008_5_a_3_', 'ga008_5_b_3_', 'ga008_5_a_4_', 'ga008_5_b_4_', 'ga008_5_a_5_', 'ga008_5_b_5_', 'ga008_5_a_6_', 'ga008_5_b_6_', 'ga008_5_a_7_', 'ga008_5_b_7_', 'ga008_6_a_1_', 'ga008_6_b_1_', 'ga008_6_a_2_', 'ga008_6_b_2_', 'ga008_6_a_3_', 'ga008_6_b_3_', 'ga008_6_a_4_', 'ga008_6_b_4_', 'ga008_6_a_5_', 'ga008_6_b_5_', 'ga008_6_a_6_', 'ga008_6_b_6_', 'ga008_6_a_7_', 'ga008_6_b_7_', 'ga008_6_a_26_', 'ga008_6_b_26_', 'ga008_7_a_1_', 'ga008_7_b_1_', 'ga008_7_a_2_', 'ga008_7_b_2_', 'ga008_7_a_3_', 'ga008_7_b_3_', 'ga008_7_a_4_', 'ga008_7_b_4_', 'ga008_7_a_5_', 'ga008_7_b_5_', 'ga008_7_a_6_', 'ga008_7_b_6_', 'ga008_7_a_7_', 'ga008_7_b_7_', 'ga008_8_a_1_', 'ga008_8_b_1_', 'ga008_8_a_2_', 'ga008_8_b_2_', 'ga008_8_a_3_', 'ga008_8_b_3_', 'ga008_8_a_4_', 'ga008_8_b_4_', 'ga008_8_a_5_', 'ga008_8_b_5_', 'ga008_8_a_6_', 'ga008_8_b_6_', 'ga008_8_a_8_', 'ga008_8_b_8_', 'ga008_9_a_1_', 'ga008_9_b_1_', 'ga008_9_a_2_', 'ga008_9_b_2_', 'ga008_9_a_3_', 'ga008_9_b_3_', 'ga008_9_a_4_', 'ga008_9_b_4_', 'ga008_9_a_5_', 'ga008_9_b_5_', 'ga008_9_a_6_', 'ga008_9_b_6_', 'ga008_9_a_7_', 'ga008_9_b_7_' ), missings = TRUE)
CHARLS_wealth2 <- opal.execute(o,'CHARLS_wealth2')

opal.assign.table.tibble(o, 'CHARLS_w1_id','CHARLS.CHARLS_w1_ids',
variables=list('var'), missings = TRUE)
CHARLS_w1_id <- opal.execute(o,'CHARLS_w1_id')

CHARLS_wealth1$oldid <- CHARLS_wealth1$id
CHARLS_wealth1$id <- CHARLS_ids(ids = CHARLS_wealth1$oldid)
CHARLS_wealth12 <- left_join(CHARLS_w1_id, CHARLS_wealth1, by='id')
CHARLS_wealth12 <- CHARLS_wealth12[,-2]


names(CHARLS_wealth2) <- c("householdID", names(CHARLS_wealth2)[2:length(CHARLS_wealth2)])
attributes(CHARLS_wealth12$householdID) <- NULL
CHARLS_wealth <- left_join(CHARLS_wealth12, CHARLS_wealth2, by='householdID')
```

##### Data management

All the incomes and assets are asked per year, if the individual prefers per month and otherwise a intervals. This information is going to join in one variable per kind of income / asset using the amount per year, therefore the amounts per month are going to be multiplied by 12 and the individuals that provide an interval is computed the midpoint of this interval.

The variable 'gb009' has a value -6000 that is going to recode as 6000. 
The variable 'gc005_1_' has a value -30000 and -2 that is going to recode as 30000 and 2 respectively. 
The variable 'gd002_2' has a value -9999 that is going to recode as NA. 



```{r dm1, echo=TRUE}
CHARLS_wealth$ga002_a <- car::recode(CHARLS_wealth$ga002_a, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$ga002_b <- car::recode(CHARLS_wealth$ga002_b, "0 = NA; 9999=NA; 99999996=NA")

CHARLS_wealth$recive <- CHARLS_wealth$ga002
CHARLS_wealth$recive[is.na(CHARLS_wealth$recive)] <- CHARLS_wealth$ga002_1[is.na(CHARLS_wealth$recive)]*12
CHARLS_wealth$recive[is.na(CHARLS_wealth$recive)] <- apply(select(CHARLS_wealth, ga002_a, ga002_b)[is.na(CHARLS_wealth$recive),], MARGIN = 1, FUN = function(x) x[1]+((x[2]-x[1])/2) )
CHARLS_wealth$recive <- car::recode(CHARLS_wealth$recive, "0=NA")

CHARLS_wealth$gb005_a <- car::recode(CHARLS_wealth$gb005_a, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$gb005_b <- car::recode(CHARLS_wealth$gb005_b, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$crops_forestry <- CHARLS_wealth$gb005
CHARLS_wealth$crops_forestry[is.na(CHARLS_wealth$crops_forestry)] <- apply(select(CHARLS_wealth, gb005_a, gb005_b)[is.na(CHARLS_wealth$crops_forestry),], MARGIN = 1, FUN = function(x) x[1]+((x[2]-x[1])/2) )
CHARLS_wealth$crops_forestry <- car::recode(CHARLS_wealth$crops_forestry, "0=NA")

CHARLS_wealth$gb009_a <- car::recode(CHARLS_wealth$gb009_a, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$gb009_b <- car::recode(CHARLS_wealth$gb009_b, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$gb009 <- car::recode(CHARLS_wealth$gb009, "-6000=6000")
CHARLS_wealth$livestock1 <- CHARLS_wealth$gb009
CHARLS_wealth$livestock1[is.na(CHARLS_wealth$livestock1)] <- apply(select(CHARLS_wealth, gb009_a, gb009_b)[is.na(CHARLS_wealth$livestock1),], MARGIN = 1, FUN = function(x) x[1]+((x[2]-x[1])/2) )
CHARLS_wealth$livestock1 <- car::recode(CHARLS_wealth$livestock1, "0=NA")

CHARLS_wealth$gb011_a <- car::recode(CHARLS_wealth$gb011_a, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$gb011_b <- car::recode(CHARLS_wealth$gb011_b, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$livestock2 <- CHARLS_wealth$gb011
CHARLS_wealth$livestock2[is.na(CHARLS_wealth$livestock2)] <- apply(select(CHARLS_wealth, gb011_a, gb011_b)[is.na(CHARLS_wealth$livestock2),], MARGIN = 1, FUN = function(x) x[1]+((x[2]-x[1])/2) )
CHARLS_wealth$livestock2 <- car::recode(CHARLS_wealth$livestock2, "0=NA")

CHARLS_wealth$gb012_a <- car::recode(CHARLS_wealth$gb012_a, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$gb012_b <- car::recode(CHARLS_wealth$gb012_b, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$livestock3 <- CHARLS_wealth$gb012
CHARLS_wealth$livestock3[is.na(CHARLS_wealth$livestock3)] <- apply(select(CHARLS_wealth, gb012_a, gb012_b)[is.na(CHARLS_wealth$livestock3),], MARGIN = 1, FUN = function(x) x[1]+((x[2]-x[1])/2) )
CHARLS_wealth$livestock3 <- car::recode(CHARLS_wealth$livestock3, "0=NA")

CHARLS_wealth$livestock <- apply(select(CHARLS_wealth, livestock1, livestock2, livestock3), MARGIN = 1, FUN = function(x) sum(x, na.rm = TRUE))
CHARLS_wealth$livestock <- car::recode(CHARLS_wealth$livestock, "0=NA")

CHARLS_wealth$gc005_a_1_ <- car::recode(CHARLS_wealth$gc005_a_1_, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$gc005_b_1_ <- car::recode(CHARLS_wealth$gc005_b_1_, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$gc005_1_ <- car::recode(CHARLS_wealth$gc005_1_, "-30000=30000; -2=2")
CHARLS_wealth$activity1 <- CHARLS_wealth$gc005_1_
CHARLS_wealth$activity1[is.na(CHARLS_wealth$activity1)] <- apply(select(CHARLS_wealth, gc005_a_1_, gc005_b_1_)[is.na(CHARLS_wealth$activity1),], MARGIN = 1, FUN = function(x) x[1]+((x[2]-x[1])/2) )
CHARLS_wealth$activity1 <- car::recode(CHARLS_wealth$activity1, "0=NA")

CHARLS_wealth$gc005_a_2_ <- car::recode(CHARLS_wealth$gc005_a_2_, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$gc005_b_2_ <- car::recode(CHARLS_wealth$gc005_b_2_, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$activity2 <- CHARLS_wealth$gc005_2_
CHARLS_wealth$activity2[is.na(CHARLS_wealth$activity2)] <- apply(select(CHARLS_wealth, gc005_a_2_, gc005_b_2_)[is.na(CHARLS_wealth$activity2),], MARGIN = 1, FUN = function(x) x[1]+((x[2]-x[1])/2) )
CHARLS_wealth$activity2 <- car::recode(CHARLS_wealth$activity2, "0=NA")

CHARLS_wealth$activity <- apply(select(CHARLS_wealth, activity1, activity2, gc005_3_), MARGIN = 1, FUN = function(x) sum(x, na.rm = TRUE))
CHARLS_wealth$activity <- car::recode(CHARLS_wealth$activity, "0=NA")

CHARLS_wealth$gd002_2 <- car::recode(CHARLS_wealth$gd002_2, "-9999=NA")
CHARLS_wealth$govern_subs <- apply(select(CHARLS_wealth, gd002_1, gd002_2, gd002_3, gd002_4, gd002_5, gd002_6, gd002_7), MARGIN = 1, FUN = function(x) sum(x, na.rm = TRUE))
CHARLS_wealth$govern_subs <- car::recode(CHARLS_wealth$govern_subs, "0=NA")

CHARLS_wealth$ha052_1 <- CHARLS_wealth$ha052_1*12
CHARLS_wealth$ha053_1 <- CHARLS_wealth$ha053_1*12
CHARLS_wealth$rental_lent <- apply(select(CHARLS_wealth, ha052_1, ha053_1, ha060_1_, ha060_2_, ha060_3_, ha060_4_, ha064_1, ha071), MARGIN = 1, FUN = function(x) sum(x, na.rm = TRUE))
CHARLS_wealth$rental_lent <- car::recode(CHARLS_wealth$rental_lent, "0=NA")

CHARLS_wealth$ind_inc1 <- CHARLS_wealth$ga004_1_1_
CHARLS_wealth$ind_inc1[is.na(CHARLS_wealth$ind_inc1)] <- CHARLS_wealth$ga004_2_1_[is.na(CHARLS_wealth$ind_inc1)]*12

CHARLS_wealth$ind_inc2 <- CHARLS_wealth$ga004_1_2_
CHARLS_wealth$ind_inc2[is.na(CHARLS_wealth$ind_inc2)] <- CHARLS_wealth$ga004_2_2_[is.na(CHARLS_wealth$ind_inc2)]*12

CHARLS_wealth$ind_inc3 <- CHARLS_wealth$ga004_1_3_
CHARLS_wealth$ind_inc3[is.na(CHARLS_wealth$ind_inc3)] <- CHARLS_wealth$ga004_2_3_[is.na(CHARLS_wealth$ind_inc3)]*12

CHARLS_wealth$ind_inc4 <- CHARLS_wealth$ga004_1_4_
CHARLS_wealth$ind_inc4[is.na(CHARLS_wealth$ind_inc4)] <- CHARLS_wealth$ga004_2_4_[is.na(CHARLS_wealth$ind_inc4)]*12

CHARLS_wealth$ind_inc5 <- CHARLS_wealth$ga004_1_5_
CHARLS_wealth$ind_inc5[is.na(CHARLS_wealth$ind_inc5)] <- CHARLS_wealth$ga004_2_5_[is.na(CHARLS_wealth$ind_inc5)]*12

CHARLS_wealth$ind_inc6 <- CHARLS_wealth$ga004_1_6_
CHARLS_wealth$ind_inc6[is.na(CHARLS_wealth$ind_inc6)] <- CHARLS_wealth$ga004_2_6_[is.na(CHARLS_wealth$ind_inc6)]*12

CHARLS_wealth$ind_inc7 <- CHARLS_wealth$ga004_1_7_
CHARLS_wealth$ind_inc7[is.na(CHARLS_wealth$ind_inc7)] <- CHARLS_wealth$ga004_2_7_[is.na(CHARLS_wealth$ind_inc7)]*12

CHARLS_wealth$ind_inc8 <- CHARLS_wealth$ga004_1_8_
CHARLS_wealth$ind_inc8[is.na(CHARLS_wealth$ind_inc8)] <- CHARLS_wealth$ga004_2_8_[is.na(CHARLS_wealth$ind_inc8)]*12

CHARLS_wealth$ind_inc9 <- CHARLS_wealth$ga004_1_9_
CHARLS_wealth$ind_inc9[is.na(CHARLS_wealth$ind_inc9)] <- CHARLS_wealth$ga004_2_9_[is.na(CHARLS_wealth$ind_inc9)]*12

CHARLS_wealth$ind_inc10 <- CHARLS_wealth$ga004_1_10_
CHARLS_wealth$ind_inc10[is.na(CHARLS_wealth$ind_inc10)] <- CHARLS_wealth$ga004_2_10_[is.na(CHARLS_wealth$ind_inc10)]*12

CHARLS_wealth$ind_inc11 <- CHARLS_wealth$ga004_1_11_
CHARLS_wealth$ind_inc11[is.na(CHARLS_wealth$ind_inc11)] <- CHARLS_wealth$ga004_2_11_[is.na(CHARLS_wealth$ind_inc11)]*12

CHARLS_wealth$ind_inc <- apply(select(CHARLS_wealth, ind_inc1, ind_inc2, ind_inc3, ind_inc4, ind_inc5, ind_inc6, ind_inc7, ind_inc8, ind_inc9, ind_inc10, ind_inc11), MARGIN = 1, FUN = function(x) sum(x, na.rm = TRUE))
CHARLS_wealth$ind_inc <- car::recode(CHARLS_wealth$ind_inc, "0=NA")


CHARLS_wealth$ga006_a_1_ <- car::recode(CHARLS_wealth$ga006_a_1_, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$ga006_b_1_ <- car::recode(CHARLS_wealth$ga006_b_1_, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$salary1 <- CHARLS_wealth$ga006_1_1_
CHARLS_wealth$salary1[is.na(CHARLS_wealth$salary1)] <- CHARLS_wealth$ga006_2_1_[is.na(CHARLS_wealth$salary1)]*12
CHARLS_wealth$salary1[is.na(CHARLS_wealth$salary1)] <- apply(select(CHARLS_wealth, ga006_a_1_, ga006_b_1_)[is.na(CHARLS_wealth$salary1),], MARGIN = 1, FUN = function(x) x[1]+((x[2]-x[1])/2) )
CHARLS_wealth$salary1 <- car::recode(CHARLS_wealth$salary1, "0=NA")

CHARLS_wealth$ga006_a_2_ <- car::recode(CHARLS_wealth$ga006_a_2_, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$ga006_b_2_ <- car::recode(CHARLS_wealth$ga006_b_2_, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$salary2 <- CHARLS_wealth$ga006_1_2_
CHARLS_wealth$salary2[is.na(CHARLS_wealth$salary2)] <- CHARLS_wealth$ga006_2_2_[is.na(CHARLS_wealth$salary2)]*12
CHARLS_wealth$salary2[is.na(CHARLS_wealth$salary2)] <- apply(select(CHARLS_wealth, ga006_a_2_, ga006_b_2_)[is.na(CHARLS_wealth$salary2),], MARGIN = 1, FUN = function(x) x[1]+((x[2]-x[1])/2) )
CHARLS_wealth$salary2 <- car::recode(CHARLS_wealth$salary2, "0=NA")

CHARLS_wealth$ga006_a_3_ <- car::recode(CHARLS_wealth$ga006_a_3_, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$ga006_b_3_ <- car::recode(CHARLS_wealth$ga006_b_3_, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$salary3 <- CHARLS_wealth$ga006_1_3_
CHARLS_wealth$salary3[is.na(CHARLS_wealth$salary3)] <- CHARLS_wealth$ga006_2_3_[is.na(CHARLS_wealth$salary3)]*12
CHARLS_wealth$salary3[is.na(CHARLS_wealth$salary3)] <- apply(select(CHARLS_wealth, ga006_a_3_, ga006_b_3_)[is.na(CHARLS_wealth$salary3),], MARGIN = 1, FUN = function(x) x[1]+((x[2]-x[1])/2) )
CHARLS_wealth$salary3 <- car::recode(CHARLS_wealth$salary3, "0=NA")

CHARLS_wealth$ga006_a_4_ <- car::recode(CHARLS_wealth$ga006_a_4_, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$ga006_b_4_ <- car::recode(CHARLS_wealth$ga006_b_4_, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$salary4 <- CHARLS_wealth$ga006_1_4_
CHARLS_wealth$salary4[is.na(CHARLS_wealth$salary4)] <- CHARLS_wealth$ga006_2_4_[is.na(CHARLS_wealth$salary4)]*12
CHARLS_wealth$salary4[is.na(CHARLS_wealth$salary4)] <- apply(select(CHARLS_wealth, ga006_a_4_, ga006_b_4_)[is.na(CHARLS_wealth$salary4),], MARGIN = 1, FUN = function(x) x[1]+((x[2]-x[1])/2) )
CHARLS_wealth$salary4 <- car::recode(CHARLS_wealth$salary4, "0=NA")

CHARLS_wealth$ga006_a_5_ <- car::recode(CHARLS_wealth$ga006_a_5_, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$ga006_b_5_ <- car::recode(CHARLS_wealth$ga006_b_5_, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$salary5 <- CHARLS_wealth$ga006_1_5_
CHARLS_wealth$salary5[is.na(CHARLS_wealth$salary5)] <- CHARLS_wealth$ga006_2_5_[is.na(CHARLS_wealth$salary5)]*12
CHARLS_wealth$salary5[is.na(CHARLS_wealth$salary5)] <- apply(select(CHARLS_wealth, ga006_a_5_, ga006_b_5_)[is.na(CHARLS_wealth$salary5),], MARGIN = 1, FUN = function(x) x[1]+((x[2]-x[1])/2) )
CHARLS_wealth$salary5 <- car::recode(CHARLS_wealth$salary5, "0=NA")

CHARLS_wealth$ga006_a_6_ <- car::recode(CHARLS_wealth$ga006_a_6_, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$ga006_b_6_ <- car::recode(CHARLS_wealth$ga006_b_6_, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$salary6 <- CHARLS_wealth$ga006_1_6_
CHARLS_wealth$salary6[is.na(CHARLS_wealth$salary6)] <- CHARLS_wealth$ga006_2_6_[is.na(CHARLS_wealth$salary6)]*12
CHARLS_wealth$salary6[is.na(CHARLS_wealth$salary6)] <- apply(select(CHARLS_wealth, ga006_a_6_, ga006_b_6_)[is.na(CHARLS_wealth$salary6),], MARGIN = 1, FUN = function(x) x[1]+((x[2]-x[1])/2) )
CHARLS_wealth$salary6 <- car::recode(CHARLS_wealth$salary6, "0=NA")

CHARLS_wealth$ga006_a_1_ <- car::recode(CHARLS_wealth$ga006_a_1_, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$ga006_b_1_ <- car::recode(CHARLS_wealth$ga006_b_1_, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$salary7 <- CHARLS_wealth$ga006_1_7_
CHARLS_wealth$salary7[is.na(CHARLS_wealth$salary7)] <- CHARLS_wealth$ga006_2_7_[is.na(CHARLS_wealth$salary7)]*12
CHARLS_wealth$salary7[is.na(CHARLS_wealth$salary7)] <- apply(select(CHARLS_wealth, ga006_a_1_, ga006_b_1_)[is.na(CHARLS_wealth$salary7),], MARGIN = 1, FUN = function(x) x[1]+((x[2]-x[1])/2) )
CHARLS_wealth$salary7 <- car::recode(CHARLS_wealth$salary7, "0=NA")

CHARLS_wealth$ga006_a_8_ <- car::recode(CHARLS_wealth$ga006_a_8_, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$ga006_b_8_ <- car::recode(CHARLS_wealth$ga006_b_8_, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$salary8 <- CHARLS_wealth$ga006_1_8_
CHARLS_wealth$salary8[is.na(CHARLS_wealth$salary8)] <- CHARLS_wealth$ga006_2_8_[is.na(CHARLS_wealth$salary8)]*12
CHARLS_wealth$salary8[is.na(CHARLS_wealth$salary8)] <- apply(select(CHARLS_wealth, ga006_a_8_, ga006_b_8_)[is.na(CHARLS_wealth$salary8),], MARGIN = 1, FUN = function(x) x[1]+((x[2]-x[1])/2) )
CHARLS_wealth$salary8 <- car::recode(CHARLS_wealth$salary8, "0=NA")

CHARLS_wealth$ga006_a_9_ <- car::recode(CHARLS_wealth$ga006_a_9_, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$ga006_b_9_ <- car::recode(CHARLS_wealth$ga006_b_9_, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$salary9 <- CHARLS_wealth$ga006_1_9_
CHARLS_wealth$salary9[is.na(CHARLS_wealth$salary9)] <- CHARLS_wealth$ga006_2_9_[is.na(CHARLS_wealth$salary9)]*12
CHARLS_wealth$salary9[is.na(CHARLS_wealth$salary9)] <- apply(select(CHARLS_wealth, ga006_a_9_, ga006_b_9_)[is.na(CHARLS_wealth$salary9),], MARGIN = 1, FUN = function(x) x[1]+((x[2]-x[1])/2) )
CHARLS_wealth$salary9 <- car::recode(CHARLS_wealth$salary9, "0=NA")

CHARLS_wealth$salary10 <- CHARLS_wealth$ga006_1_10_
CHARLS_wealth$salary10[is.na(CHARLS_wealth$salary10)] <- CHARLS_wealth$ga006_2_10_[is.na(CHARLS_wealth$salary10)]*12
CHARLS_wealth$salary10 <- car::recode(CHARLS_wealth$salary10, "0=NA")

CHARLS_wealth$salary11 <- CHARLS_wealth$ga006_1_11_
CHARLS_wealth$salary11[is.na(CHARLS_wealth$salary11)] <- CHARLS_wealth$ga006_2_11_[is.na(CHARLS_wealth$salary11)]*12
CHARLS_wealth$salary11 <- car::recode(CHARLS_wealth$salary11, "0=NA")

CHARLS_wealth$ga006_a_12_ <- car::recode(CHARLS_wealth$ga006_a_12_, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$ga006_b_12_ <- car::recode(CHARLS_wealth$ga006_b_12_, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$salary12 <- CHARLS_wealth$ga006_1_12_
CHARLS_wealth$salary12[is.na(CHARLS_wealth$salary12)] <- CHARLS_wealth$ga006_2_12_[is.na(CHARLS_wealth$salary12)]*12
CHARLS_wealth$salary12[is.na(CHARLS_wealth$salary12)] <- apply(select(CHARLS_wealth, ga006_a_12_, ga006_b_12_)[is.na(CHARLS_wealth$salary12),], MARGIN = 1, FUN = function(x) x[1]+((x[2]-x[1])/2) )
CHARLS_wealth$salary12 <- car::recode(CHARLS_wealth$salary12, "0=NA")

CHARLS_wealth$salary13 <- CHARLS_wealth$ga006_1_13_
CHARLS_wealth$salary13[is.na(CHARLS_wealth$salary13)] <- CHARLS_wealth$ga006_2_13_[is.na(CHARLS_wealth$salary13)]*12
CHARLS_wealth$salary13 <- car::recode(CHARLS_wealth$salary13, "0=NA")

CHARLS_wealth$salary14 <- CHARLS_wealth$ga006_1_14_
CHARLS_wealth$salary14[is.na(CHARLS_wealth$salary14)] <- CHARLS_wealth$ga006_2_14_[is.na(CHARLS_wealth$salary14)]*12
CHARLS_wealth$salary14 <- car::recode(CHARLS_wealth$salary14, "0=NA")

CHARLS_wealth$salary15 <- CHARLS_wealth$ga006_1_15_
CHARLS_wealth$salary15[is.na(CHARLS_wealth$salary15)] <- CHARLS_wealth$ga006_2_15_[is.na(CHARLS_wealth$salary15)]*12
CHARLS_wealth$salary15 <- car::recode(CHARLS_wealth$salary15, "0=NA")

CHARLS_wealth$salary <- apply(select(CHARLS_wealth, salary1, salary2, salary3, salary4, salary5, salary6, salary7, salary8, salary9, salary10, salary11, salary12, salary13, salary14, salary15), MARGIN = 1, FUN = function(x) sum(x, na.rm = TRUE))
CHARLS_wealth$salary <- car::recode(CHARLS_wealth$salary, "0=NA")


CHARLS_wealth$pension1 <- CHARLS_wealth$ga008_1_a_1_
CHARLS_wealth$pension1[is.na(CHARLS_wealth$pension1)] <- CHARLS_wealth$ga008_1_b_1_[is.na(CHARLS_wealth$pension1)]*12
CHARLS_wealth$pension1 <- car::recode(CHARLS_wealth$pension1, "0=NA")

CHARLS_wealth$pension2 <- CHARLS_wealth$ga008_1_a_2_
CHARLS_wealth$pension2[is.na(CHARLS_wealth$pension2)] <- CHARLS_wealth$ga008_1_b_2_[is.na(CHARLS_wealth$pension2)]*12
CHARLS_wealth$pension2 <- car::recode(CHARLS_wealth$pension2, "0=NA")

CHARLS_wealth$pension3 <- CHARLS_wealth$ga008_1_a_3_
CHARLS_wealth$pension3[is.na(CHARLS_wealth$pension3)] <- CHARLS_wealth$ga008_1_b_3_[is.na(CHARLS_wealth$pension3)]*12
CHARLS_wealth$pension3 <- car::recode(CHARLS_wealth$pension3, "0=NA")

CHARLS_wealth$pension4 <- CHARLS_wealth$ga008_1_a_4_
CHARLS_wealth$pension4[is.na(CHARLS_wealth$pension4)] <- CHARLS_wealth$ga008_1_b_4_[is.na(CHARLS_wealth$pension4)]*12
CHARLS_wealth$pension4 <- car::recode(CHARLS_wealth$pension4, "0=NA")

CHARLS_wealth$pension5 <- CHARLS_wealth$ga008_1_a_5_
CHARLS_wealth$pension5[is.na(CHARLS_wealth$pension5)] <- CHARLS_wealth$ga008_1_b_5_[is.na(CHARLS_wealth$pension5)]*12
CHARLS_wealth$pension5 <- car::recode(CHARLS_wealth$pension5, "0=NA")

CHARLS_wealth$pension6 <- CHARLS_wealth$ga008_1_a_6_
CHARLS_wealth$pension6[is.na(CHARLS_wealth$pension6)] <- CHARLS_wealth$ga008_1_b_6_[is.na(CHARLS_wealth$pension6)]*12
CHARLS_wealth$pension6 <- car::recode(CHARLS_wealth$pension6, "0=NA")

CHARLS_wealth$pension7 <- CHARLS_wealth$ga008_1_a_7_
CHARLS_wealth$pension7[is.na(CHARLS_wealth$pension7)] <- CHARLS_wealth$ga008_1_b_7_[is.na(CHARLS_wealth$pension7)]*12
CHARLS_wealth$pension7 <- car::recode(CHARLS_wealth$pension7, "0=NA")

CHARLS_wealth$pension8 <- CHARLS_wealth$ga008_1_a_8_
CHARLS_wealth$pension8[is.na(CHARLS_wealth$pension8)] <- CHARLS_wealth$ga008_1_b_8_[is.na(CHARLS_wealth$pension8)]*12
CHARLS_wealth$pension8 <- car::recode(CHARLS_wealth$pension8, "0=NA")

CHARLS_wealth$pension9 <- CHARLS_wealth$ga008_1_a_9_
CHARLS_wealth$pension9[is.na(CHARLS_wealth$pension9)] <- CHARLS_wealth$ga008_1_b_9_[is.na(CHARLS_wealth$pension9)]*12
CHARLS_wealth$pension9 <- car::recode(CHARLS_wealth$pension9, "0=NA")

CHARLS_wealth$pension10 <- CHARLS_wealth$ga008_1_a_26_
CHARLS_wealth$pension10[is.na(CHARLS_wealth$pension10)] <- CHARLS_wealth$ga008_1_b_26_[is.na(CHARLS_wealth$pension10)]*12
CHARLS_wealth$pension10 <- car::recode(CHARLS_wealth$pension10, "0=NA")

CHARLS_wealth$pension <- apply(select(CHARLS_wealth, pension1, pension2, pension3, pension4, pension5, pension6, pension7, pension8, pension9, pension10), MARGIN = 1, FUN = function(x) sum(x, na.rm = TRUE))
CHARLS_wealth$pension <- car::recode(CHARLS_wealth$pension, "0=NA")

CHARLS_wealth$unemploy1 <- CHARLS_wealth$ga008_2_a_4_
CHARLS_wealth$unemploy1[is.na(CHARLS_wealth$unemploy1)] <- CHARLS_wealth$ga008_2_b_4_[is.na(CHARLS_wealth$unemploy1)]*12
CHARLS_wealth$unemploy1 <- car::recode(CHARLS_wealth$unemploy1, "0=NA")

CHARLS_wealth$unemploy2 <- CHARLS_wealth$ga008_2_a_3_
CHARLS_wealth$unemploy2[is.na(CHARLS_wealth$unemploy2)] <- CHARLS_wealth$ga008_2_b_3_[is.na(CHARLS_wealth$unemploy2)]*12
CHARLS_wealth$unemploy2 <- car::recode(CHARLS_wealth$unemploy2, "0=NA")

CHARLS_wealth$unemploy <- apply(select(CHARLS_wealth, unemploy1, unemploy2), MARGIN = 1, FUN = function(x) sum(x, na.rm = TRUE))
CHARLS_wealth$unemploy <- car::recode(CHARLS_wealth$unemploy, "0=NA")

CHARLS_wealth$pension_sub1 <- CHARLS_wealth$ga008_3_a_1_
CHARLS_wealth$pension_sub1[is.na(CHARLS_wealth$pension_sub1)] <- CHARLS_wealth$ga008_3_b_1_[is.na(CHARLS_wealth$pension_sub1)]*12
CHARLS_wealth$pension_sub1 <- car::recode(CHARLS_wealth$pension_sub1, "0=NA")

CHARLS_wealth$pension_sub2 <- CHARLS_wealth$ga008_3_a_2_
CHARLS_wealth$pension_sub2[is.na(CHARLS_wealth$pension_sub2)] <- CHARLS_wealth$ga008_3_b_2_[is.na(CHARLS_wealth$pension_sub2)]*12
CHARLS_wealth$pension_sub2 <- car::recode(CHARLS_wealth$pension_sub2, "0=NA")

CHARLS_wealth$pension_sub3 <- CHARLS_wealth$ga008_3_a_3_
CHARLS_wealth$pension_sub3[is.na(CHARLS_wealth$pension_sub3)] <- CHARLS_wealth$ga008_3_b_3_[is.na(CHARLS_wealth$pension_sub3)]*12
CHARLS_wealth$pension_sub3 <- car::recode(CHARLS_wealth$pension_sub3, "0=NA")

CHARLS_wealth$pension_sub4 <- CHARLS_wealth$ga008_3_a_4_
CHARLS_wealth$pension_sub4[is.na(CHARLS_wealth$pension_sub4)] <- CHARLS_wealth$ga008_3_b_4_[is.na(CHARLS_wealth$pension_sub4)]*12
CHARLS_wealth$pension_sub4 <- car::recode(CHARLS_wealth$pension_sub4, "0=NA")

CHARLS_wealth$pension_sub5 <- CHARLS_wealth$ga008_3_a_6_
CHARLS_wealth$pension_sub5[is.na(CHARLS_wealth$pension_sub5)] <- CHARLS_wealth$ga008_3_b_6_[is.na(CHARLS_wealth$pension_sub5)]*12
CHARLS_wealth$pension_sub5 <- car::recode(CHARLS_wealth$pension_sub5, "0=NA")

CHARLS_wealth$pension_sub6 <- CHARLS_wealth$ga008_3_a_7_
CHARLS_wealth$pension_sub6[is.na(CHARLS_wealth$pension_sub6)] <- CHARLS_wealth$ga008_3_b_7_[is.na(CHARLS_wealth$pension_sub6)]*12
CHARLS_wealth$pension_sub6 <- car::recode(CHARLS_wealth$pension_sub6, "0=NA")

CHARLS_wealth$pension_sub7 <- CHARLS_wealth$ga008_3_a_9_
CHARLS_wealth$pension_sub7[is.na(CHARLS_wealth$pension_sub7)] <- CHARLS_wealth$ga008_3_b_9_[is.na(CHARLS_wealth$pension_sub7)]*12
CHARLS_wealth$pension_sub7 <- car::recode(CHARLS_wealth$pension_sub7, "0=NA")

CHARLS_wealth$pension_sub8 <- CHARLS_wealth$ga008_3_a_11_
CHARLS_wealth$pension_sub8[is.na(CHARLS_wealth$pension_sub8)] <- CHARLS_wealth$ga008_3_b_11_[is.na(CHARLS_wealth$pension_sub8)]*12
CHARLS_wealth$pension_sub8 <- car::recode(CHARLS_wealth$pension_sub8, "0=NA")

CHARLS_wealth$pension_sub <- apply(select(CHARLS_wealth, pension_sub1, pension_sub2, pension_sub3, pension_sub4, pension_sub5, pension_sub6, pension_sub7, pension_sub8), MARGIN = 1, FUN = function(x) sum(x, na.rm = TRUE))
CHARLS_wealth$pension_sub <- car::recode(CHARLS_wealth$pension_sub, "0=NA")

CHARLS_wealth$accid_compe1 <- CHARLS_wealth$ga008_4_a_1_
CHARLS_wealth$accid_compe1[is.na(CHARLS_wealth$accid_compe1)] <- CHARLS_wealth$ga008_4_b_1_[is.na(CHARLS_wealth$accid_compe1)]*12
CHARLS_wealth$accid_compe1 <- car::recode(CHARLS_wealth$accid_compe1, "0=NA")

CHARLS_wealth$accid_compe2 <- CHARLS_wealth$ga008_4_a_2_
CHARLS_wealth$accid_compe2[is.na(CHARLS_wealth$accid_compe2)] <- CHARLS_wealth$ga008_4_b_2_[is.na(CHARLS_wealth$accid_compe2)]*12
CHARLS_wealth$accid_compe2 <- car::recode(CHARLS_wealth$accid_compe2, "0=NA")

CHARLS_wealth$accid_compe3 <- CHARLS_wealth$ga008_4_a_3_
CHARLS_wealth$accid_compe3[is.na(CHARLS_wealth$accid_compe3)] <- CHARLS_wealth$ga008_4_b_3_[is.na(CHARLS_wealth$accid_compe3)]*12
CHARLS_wealth$accid_compe3 <- car::recode(CHARLS_wealth$accid_compe3, "0=NA")

CHARLS_wealth$accid_compe4 <- CHARLS_wealth$ga008_4_a_4_
CHARLS_wealth$accid_compe4[is.na(CHARLS_wealth$accid_compe4)] <- CHARLS_wealth$ga008_4_b_4_[is.na(CHARLS_wealth$accid_compe4)]*12
CHARLS_wealth$accid_compe4 <- car::recode(CHARLS_wealth$accid_compe4, "0=NA")

CHARLS_wealth$accid_compe5 <- CHARLS_wealth$ga008_4_a_6_
CHARLS_wealth$accid_compe5[is.na(CHARLS_wealth$accid_compe5)] <- CHARLS_wealth$ga008_4_b_6_[is.na(CHARLS_wealth$accid_compe5)]*12
CHARLS_wealth$accid_compe5 <- car::recode(CHARLS_wealth$accid_compe5, "0=NA")

CHARLS_wealth$accid_compe <- apply(select(CHARLS_wealth, accid_compe1, accid_compe2, accid_compe3, accid_compe4, accid_compe5), MARGIN = 1, FUN = function(x) sum(x, na.rm = TRUE))
CHARLS_wealth$accid_compe <- car::recode(CHARLS_wealth$accid_compe, "0=NA")

CHARLS_wealth$elderly_subs1 <- CHARLS_wealth$ga008_5_a_1_
CHARLS_wealth$elderly_subs1[is.na(CHARLS_wealth$elderly_subs1)] <- CHARLS_wealth$ga008_5_b_1_[is.na(CHARLS_wealth$elderly_subs1)]*12
CHARLS_wealth$elderly_subs1 <- car::recode(CHARLS_wealth$elderly_subs1, "0=NA")

CHARLS_wealth$elderly_subs2 <- CHARLS_wealth$ga008_5_a_2_
CHARLS_wealth$elderly_subs2[is.na(CHARLS_wealth$elderly_subs2)] <- CHARLS_wealth$ga008_5_b_2_[is.na(CHARLS_wealth$elderly_subs2)]*12
CHARLS_wealth$elderly_subs2 <- car::recode(CHARLS_wealth$elderly_subs2, "0=NA")

CHARLS_wealth$elderly_subs3 <- CHARLS_wealth$ga008_5_a_3_
CHARLS_wealth$elderly_subs3[is.na(CHARLS_wealth$elderly_subs3)] <- CHARLS_wealth$ga008_5_b_3_[is.na(CHARLS_wealth$elderly_subs3)]*12
CHARLS_wealth$elderly_subs3 <- car::recode(CHARLS_wealth$elderly_subs3, "0=NA")

CHARLS_wealth$elderly_subs4 <- CHARLS_wealth$ga008_5_a_4_
CHARLS_wealth$elderly_subs4[is.na(CHARLS_wealth$elderly_subs4)] <- CHARLS_wealth$ga008_5_b_4_[is.na(CHARLS_wealth$elderly_subs4)]*12
CHARLS_wealth$elderly_subs4 <- car::recode(CHARLS_wealth$elderly_subs4, "0=NA")

CHARLS_wealth$elderly_subs5 <- CHARLS_wealth$ga008_5_a_5_
CHARLS_wealth$elderly_subs5[is.na(CHARLS_wealth$elderly_subs5)] <- CHARLS_wealth$ga008_5_b_5_[is.na(CHARLS_wealth$elderly_subs5)]*12
CHARLS_wealth$elderly_subs5 <- car::recode(CHARLS_wealth$elderly_subs5, "0=NA")

CHARLS_wealth$elderly_subs6 <- CHARLS_wealth$ga008_5_a_6_
CHARLS_wealth$elderly_subs6[is.na(CHARLS_wealth$elderly_subs6)] <- CHARLS_wealth$ga008_5_b_6_[is.na(CHARLS_wealth$elderly_subs6)]*12
CHARLS_wealth$elderly_subs6 <- car::recode(CHARLS_wealth$elderly_subs6, "0=NA")

CHARLS_wealth$elderly_subs7 <- CHARLS_wealth$ga008_5_a_7_
CHARLS_wealth$elderly_subs7[is.na(CHARLS_wealth$elderly_subs7)] <- CHARLS_wealth$ga008_5_b_7_[is.na(CHARLS_wealth$elderly_subs7)]*12
CHARLS_wealth$elderly_subs7 <- car::recode(CHARLS_wealth$elderly_subs7, "0=NA")

CHARLS_wealth$elderly_subs <- apply(select(CHARLS_wealth, elderly_subs1, elderly_subs2, elderly_subs3, elderly_subs4, elderly_subs5, elderly_subs6, elderly_subs7), MARGIN = 1, FUN = function(x) sum(x, na.rm = TRUE))
CHARLS_wealth$elderly_subs <- car::recode(CHARLS_wealth$elderly_subs, "0=NA")

CHARLS_wealth$medical_aid1 <- CHARLS_wealth$ga008_6_a_1_
CHARLS_wealth$medical_aid1[is.na(CHARLS_wealth$medical_aid1)] <- CHARLS_wealth$ga008_6_b_1_[is.na(CHARLS_wealth$medical_aid1)]*12
CHARLS_wealth$medical_aid1 <- car::recode(CHARLS_wealth$medical_aid1, "0=NA")

CHARLS_wealth$medical_aid2 <- CHARLS_wealth$ga008_6_a_2_
CHARLS_wealth$medical_aid2[is.na(CHARLS_wealth$medical_aid2)] <- CHARLS_wealth$ga008_6_b_2_[is.na(CHARLS_wealth$medical_aid2)]*12
CHARLS_wealth$medical_aid2 <- car::recode(CHARLS_wealth$medical_aid2, "0=NA")

CHARLS_wealth$medical_aid3 <- CHARLS_wealth$ga008_6_a_3_
CHARLS_wealth$medical_aid3[is.na(CHARLS_wealth$medical_aid3)] <- CHARLS_wealth$ga008_6_b_3_[is.na(CHARLS_wealth$medical_aid3)]*12
CHARLS_wealth$medical_aid3 <- car::recode(CHARLS_wealth$medical_aid3, "0=NA")

CHARLS_wealth$medical_aid4 <- CHARLS_wealth$ga008_6_a_4_
CHARLS_wealth$medical_aid4[is.na(CHARLS_wealth$medical_aid4)] <- CHARLS_wealth$ga008_6_b_4_[is.na(CHARLS_wealth$medical_aid4)]*12
CHARLS_wealth$medical_aid4 <- car::recode(CHARLS_wealth$medical_aid4, "0=NA")

CHARLS_wealth$medical_aid5 <- CHARLS_wealth$ga008_6_a_5_
CHARLS_wealth$medical_aid5[is.na(CHARLS_wealth$medical_aid5)] <- CHARLS_wealth$ga008_6_b_5_[is.na(CHARLS_wealth$medical_aid5)]*12
CHARLS_wealth$medical_aid5 <- car::recode(CHARLS_wealth$medical_aid5, "0=NA")

CHARLS_wealth$medical_aid6 <- CHARLS_wealth$ga008_6_a_6_
CHARLS_wealth$medical_aid6[is.na(CHARLS_wealth$medical_aid6)] <- CHARLS_wealth$ga008_6_b_6_[is.na(CHARLS_wealth$medical_aid6)]*12
CHARLS_wealth$medical_aid6 <- car::recode(CHARLS_wealth$medical_aid6, "0=NA")

CHARLS_wealth$medical_aid7 <- CHARLS_wealth$ga008_6_a_7_
CHARLS_wealth$medical_aid7[is.na(CHARLS_wealth$medical_aid7)] <- CHARLS_wealth$ga008_6_b_7_[is.na(CHARLS_wealth$medical_aid7)]*12
CHARLS_wealth$medical_aid7 <- car::recode(CHARLS_wealth$medical_aid7, "0=NA")

CHARLS_wealth$medical_aid8 <- CHARLS_wealth$ga008_6_a_26_
CHARLS_wealth$medical_aid8[is.na(CHARLS_wealth$medical_aid8)] <- CHARLS_wealth$ga008_6_b_26_[is.na(CHARLS_wealth$medical_aid8)]*12
CHARLS_wealth$medical_aid8 <- car::recode(CHARLS_wealth$medical_aid8, "0=NA")

CHARLS_wealth$medical_aid <- apply(select(CHARLS_wealth, medical_aid1, medical_aid2, medical_aid3, medical_aid4, medical_aid5, medical_aid6, medical_aid7, medical_aid8), MARGIN = 1, FUN = function(x) sum(x, na.rm = TRUE))
CHARLS_wealth$medical_aid <- car::recode(CHARLS_wealth$medical_aid, "0=NA")

CHARLS_wealth$gov_sub1 <- CHARLS_wealth$ga008_7_a_1_
CHARLS_wealth$gov_sub1[is.na(CHARLS_wealth$gov_sub1)] <- CHARLS_wealth$ga008_7_b_1_[is.na(CHARLS_wealth$gov_sub1)]*12
CHARLS_wealth$gov_sub1 <- car::recode(CHARLS_wealth$gov_sub1, "0=NA")

CHARLS_wealth$gov_sub2 <- CHARLS_wealth$ga008_7_a_2_
CHARLS_wealth$gov_sub2[is.na(CHARLS_wealth$gov_sub2)] <- CHARLS_wealth$ga008_7_b_2_[is.na(CHARLS_wealth$gov_sub2)]*12
CHARLS_wealth$gov_sub2 <- car::recode(CHARLS_wealth$gov_sub2, "0=NA")

CHARLS_wealth$gov_sub3 <- CHARLS_wealth$ga008_7_a_3_
CHARLS_wealth$gov_sub3[is.na(CHARLS_wealth$gov_sub3)] <- CHARLS_wealth$ga008_7_b_3_[is.na(CHARLS_wealth$gov_sub3)]*12
CHARLS_wealth$gov_sub3 <- car::recode(CHARLS_wealth$gov_sub3, "0=NA")

CHARLS_wealth$gov_sub4 <- CHARLS_wealth$ga008_7_a_4_
CHARLS_wealth$gov_sub4[is.na(CHARLS_wealth$gov_sub4)] <- CHARLS_wealth$ga008_7_b_4_[is.na(CHARLS_wealth$gov_sub4)]*12
CHARLS_wealth$gov_sub4 <- car::recode(CHARLS_wealth$gov_sub4, "0=NA")

CHARLS_wealth$gov_sub5 <- CHARLS_wealth$ga008_7_a_5_
CHARLS_wealth$gov_sub5[is.na(CHARLS_wealth$gov_sub5)] <- CHARLS_wealth$ga008_7_b_5_[is.na(CHARLS_wealth$gov_sub5)]*12
CHARLS_wealth$gov_sub5 <- car::recode(CHARLS_wealth$gov_sub5, "0=NA")

CHARLS_wealth$gov_sub6 <- CHARLS_wealth$ga008_7_a_6_
CHARLS_wealth$gov_sub6[is.na(CHARLS_wealth$gov_sub6)] <- CHARLS_wealth$ga008_7_b_6_[is.na(CHARLS_wealth$gov_sub6)]*12
CHARLS_wealth$gov_sub6 <- car::recode(CHARLS_wealth$gov_sub6, "0=NA")

CHARLS_wealth$gov_sub7 <- CHARLS_wealth$ga008_7_a_7_
CHARLS_wealth$gov_sub7[is.na(CHARLS_wealth$gov_sub7)] <- CHARLS_wealth$ga008_7_b_7_[is.na(CHARLS_wealth$gov_sub7)]*12
CHARLS_wealth$gov_sub7 <- car::recode(CHARLS_wealth$gov_sub7, "0=NA")

CHARLS_wealth$gov_sub <- apply(select(CHARLS_wealth, gov_sub1, gov_sub2, gov_sub3, gov_sub4, gov_sub5, gov_sub6, gov_sub7), MARGIN = 1, FUN = function(x) sum(x, na.rm = TRUE))
CHARLS_wealth$gov_sub <- car::recode(CHARLS_wealth$gov_sub, "0=NA")

CHARLS_wealth$social_assis1 <- CHARLS_wealth$ga008_8_a_1_
CHARLS_wealth$social_assis1[is.na(CHARLS_wealth$social_assis1)] <- CHARLS_wealth$ga008_8_b_1_[is.na(CHARLS_wealth$social_assis1)]*12
CHARLS_wealth$social_assis1 <- car::recode(CHARLS_wealth$social_assis1, "0=NA")

CHARLS_wealth$social_assis2 <- CHARLS_wealth$ga008_8_a_2_
CHARLS_wealth$social_assis2[is.na(CHARLS_wealth$social_assis2)] <- CHARLS_wealth$ga008_8_b_2_[is.na(CHARLS_wealth$social_assis2)]*12
CHARLS_wealth$social_assis2 <- car::recode(CHARLS_wealth$social_assis2, "0=NA")

CHARLS_wealth$social_assis3 <- CHARLS_wealth$ga008_8_a_3_
CHARLS_wealth$social_assis3[is.na(CHARLS_wealth$social_assis3)] <- CHARLS_wealth$ga008_8_b_3_[is.na(CHARLS_wealth$social_assis3)]*12
CHARLS_wealth$social_assis3 <- car::recode(CHARLS_wealth$social_assis3, "0=NA")

CHARLS_wealth$social_assis4 <- CHARLS_wealth$ga008_8_a_4_
CHARLS_wealth$social_assis4[is.na(CHARLS_wealth$social_assis4)] <- CHARLS_wealth$ga008_8_b_4_[is.na(CHARLS_wealth$social_assis4)]*12
CHARLS_wealth$social_assis4 <- car::recode(CHARLS_wealth$social_assis4, "0=NA")

CHARLS_wealth$social_assis5 <- CHARLS_wealth$ga008_8_a_5_
CHARLS_wealth$social_assis5[is.na(CHARLS_wealth$social_assis5)] <- CHARLS_wealth$ga008_8_b_5_[is.na(CHARLS_wealth$social_assis5)]*12
CHARLS_wealth$social_assis5 <- car::recode(CHARLS_wealth$social_assis5, "0=NA")

CHARLS_wealth$social_assis6 <- CHARLS_wealth$ga008_8_a_6_
CHARLS_wealth$social_assis6[is.na(CHARLS_wealth$social_assis6)] <- CHARLS_wealth$ga008_8_b_6_[is.na(CHARLS_wealth$social_assis6)]*12
CHARLS_wealth$social_assis6 <- car::recode(CHARLS_wealth$social_assis6, "0=NA")

CHARLS_wealth$social_assis7 <- CHARLS_wealth$ga008_8_a_8_
CHARLS_wealth$social_assis7[is.na(CHARLS_wealth$social_assis7)] <- CHARLS_wealth$ga008_8_b_8_[is.na(CHARLS_wealth$social_assis7)]*12
CHARLS_wealth$social_assis7 <- car::recode(CHARLS_wealth$social_assis7, "0=NA")

CHARLS_wealth$social_assis <- apply(select(CHARLS_wealth, social_assis1, social_assis2, social_assis3, social_assis4, social_assis5, social_assis6, social_assis7), MARGIN = 1, FUN = function(x) sum(x, na.rm = TRUE))
CHARLS_wealth$social_assis <- car::recode(CHARLS_wealth$social_assis, "0=NA")

CHARLS_wealth$other1 <- CHARLS_wealth$ga008_9_a_1_
CHARLS_wealth$other1[is.na(CHARLS_wealth$other1)] <- CHARLS_wealth$ga008_9_b_1_[is.na(CHARLS_wealth$other1)]*12
CHARLS_wealth$other1 <- car::recode(CHARLS_wealth$other1, "0=NA")

CHARLS_wealth$other2 <- CHARLS_wealth$ga008_9_a_2_
CHARLS_wealth$other2[is.na(CHARLS_wealth$other2)] <- CHARLS_wealth$ga008_9_b_2_[is.na(CHARLS_wealth$other2)]*12
CHARLS_wealth$other2 <- car::recode(CHARLS_wealth$other2, "0=NA")

CHARLS_wealth$other3 <- CHARLS_wealth$ga008_9_a_3_
CHARLS_wealth$other3[is.na(CHARLS_wealth$other3)] <- CHARLS_wealth$ga008_9_b_3_[is.na(CHARLS_wealth$other3)]*12
CHARLS_wealth$other3 <- car::recode(CHARLS_wealth$other3, "0=NA")

CHARLS_wealth$other4 <- CHARLS_wealth$ga008_9_a_4_
CHARLS_wealth$other4[is.na(CHARLS_wealth$other4)] <- CHARLS_wealth$ga008_9_b_4_[is.na(CHARLS_wealth$other4)]*12
CHARLS_wealth$other4 <- car::recode(CHARLS_wealth$other4, "0=NA")

CHARLS_wealth$other5 <- CHARLS_wealth$ga008_9_a_5_
CHARLS_wealth$other5[is.na(CHARLS_wealth$other5)] <- CHARLS_wealth$ga008_9_b_5_[is.na(CHARLS_wealth$other5)]*12
CHARLS_wealth$other5 <- car::recode(CHARLS_wealth$other5, "0=NA")

CHARLS_wealth$other6 <- CHARLS_wealth$ga008_9_a_6_
CHARLS_wealth$other6[is.na(CHARLS_wealth$other6)] <- CHARLS_wealth$ga008_9_b_6_[is.na(CHARLS_wealth$other6)]*12
CHARLS_wealth$other6 <- car::recode(CHARLS_wealth$other6, "0=NA")

CHARLS_wealth$other7 <- CHARLS_wealth$ga008_9_a_7_
CHARLS_wealth$other7[is.na(CHARLS_wealth$other7)] <- CHARLS_wealth$ga008_9_b_7_[is.na(CHARLS_wealth$other7)]*12
CHARLS_wealth$other7 <- car::recode(CHARLS_wealth$other7, "0=NA")

CHARLS_wealth$other <- apply(select(CHARLS_wealth, other1, other2, other3, other4, other5, other6, other7), MARGIN = 1, FUN = function(x) sum(x, na.rm = TRUE))
CHARLS_wealth$other <- car::recode(CHARLS_wealth$other, "0=NA")
```


```{r local1, echo=F}
vari <- CHARLS_wealth$recive
kable(Continuous_summary(vari, missing_values = NA)[3], caption = "recive") 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- CHARLS_wealth$crops_forestry
kable(Continuous_summary(vari, missing_values = NA)[3], caption = "crops_forestry") 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- CHARLS_wealth$livestock
kable(Continuous_summary(vari, missing_values = NA)[3], caption = "livestock") 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- CHARLS_wealth$activity
kable(Continuous_summary(vari, missing_values = NA)[3], caption = "activity") 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- CHARLS_wealth$gd001_c
kable(Continuous_summary(vari, missing_values = NA)[3], caption = "gd001_c") 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- CHARLS_wealth$govern_subs
kable(Continuous_summary(vari, missing_values = NA)[3], caption = "govern_subs") 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- CHARLS_wealth$rental_lent
kable(Continuous_summary(vari, missing_values = NA)[3], caption = "rental_lent") 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- CHARLS_wealth$hc024
kable(Continuous_summary(vari, missing_values = NA)[3], caption = "hc024") 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- CHARLS_wealth$ind_inc
kable(Continuous_summary(vari, missing_values = NA)[3], caption = "ind_inc") 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- CHARLS_wealth$salary
kable(Continuous_summary(vari, missing_values = NA)[3], caption = "salary") 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- CHARLS_wealth$pension
kable(Continuous_summary(vari, missing_values = NA)[3], caption = "pension") 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- CHARLS_wealth$unemploy
kable(Continuous_summary(vari, missing_values = NA)[3], caption = "unemploy") 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- CHARLS_wealth$pension_sub
kable(Continuous_summary(vari, missing_values = NA)[3], caption = "pension_sub") 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- CHARLS_wealth$accid_compe
kable(Continuous_summary(vari, missing_values = NA)[3], caption = "accid_compe") 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- CHARLS_wealth$elderly_subs
kable(Continuous_summary(vari, missing_values = NA)[3], caption = "elderly_subs") 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- CHARLS_wealth$medical_aid
kable(Continuous_summary(vari, missing_values = NA)[3], caption = "medical_aid") 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- CHARLS_wealth$gov_sub
kable(Continuous_summary(vari, missing_values = NA)[3], caption = "gov_sub") 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- CHARLS_wealth$social_assis
kable(Continuous_summary(vari, missing_values = NA)[3], caption = "social_assis") 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- CHARLS_wealth$other
kable(Continuous_summary(vari, missing_values = NA)[3], caption = "other") 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
```

#### Harmonisation algorithm
To compute the harmonized variable from the study specific varibale sum up all the variables and divide the population into 5 groups each containing 20$\%$ of the corresponding N and the missing values have to be recoded as follows: 

* `NA into 999`

**R script:**

```{r harmo1}
CHARLS_wealth$sum <- apply(X = select(CHARLS_wealth, recive, crops_forestry, livestock, activity, gd001_c, govern_subs, rental_lent, hc024, ind_inc, salary, pension, unemploy, pension_sub, accid_compe, elderly_subs, medical_aid, gov_sub, social_assis, other ), MARGIN = 1, FUN = function(x) sum(as.numeric(x), na.rm = TRUE))
CHARLS_wealth$sum <- car::recode(CHARLS_wealth$sum, "0=NA")

qq <- quantile(CHARLS_wealth$sum, probs = seq(0, 1, .2), na.rm = TRUE)

CHARLS_ds_w1 <- tibble(id=CHARLS_wealth$id)
CHARLS_ds_w1$wealth <- car::recode(CHARLS_wealth$sum, "0:qq[2]=1; (qq[2]+1):qq[3]=2; (qq[3]+1):qq[4]=3; (qq[4]+1):qq[5]=4; (qq[5]+1):hi=5")
CHARLS_ds_w1$wealth <- car::recode(CHARLS_ds_w1$wealth, "NA=999")
CHARLS_ds_w1$wealth <- as.integer(CHARLS_ds_w1$wealth)
CHARLS_ds_w1$wealth <- labelled(CHARLS_ds_w1$wealth, labels = c("Missing"=999, "Do not know"=998, "Refuse"=997, "Not applicable"=996, "Does not answer"=995,  "Not attempt not done"=994, "Disable to measure"=993, "Impute"=992, "CAPI interviewer error"=991))
```

#### Statistics of the new harmonised variable
```{r descript1, echo=F}
vari <- CHARLS_ds_w1$wealth
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[3], caption = ds_label) 
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[2], caption = "Type of missing")
ggplot(CHARLS_ds_w1, aes(x=factor(wealth))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab(ds_label) + ylab("Frequency")
```

#### Validation
```{r crosstabulation1, echo=F}
```







### Wave 2 

#### Study-specific variable description

| **Name** | `ga002_1`, `ga002_2`, `ga002_bracket_min`, `ga002_bracket_max`, `ga004_1_1_`, `ga004_2_1_`, `ga004_1_2_`, `ga004_2_2_`, `ga004_1_3_`, `ga004_2_3_`, `ga004_1_4_`, `ga004_2_4_`, `ga004_1_5_`, `ga004_2_5_`, `ga004_1_6_`, `ga004_2_6_`, `ga004_1_7_`, `ga004_2_7_`, `ga004_1_8_`, `ga004_2_8_`, `ga004_1_9_`, `ga004_2_9_`, `hc024`,  `ga006_1_1_`, `ga006_2_1_`, `ga006_bracket_1_min`, `ga006_bracket_1_max`, `ga006_1_2_`, `ga006_2_2_`, `ga006_bracket_2_min`, `ga006_bracket_2_max`, `ga006_1_3_`, `ga006_2_3_`, `ga006_bracket_3_min`, `ga006_bracket_3_max`, `ga006_1_4_`, `ga006_2_4_`, `ga006_bracket_4_min`, `ga006_bracket_4_max`, `ga006_1_5_`, `ga006_2_5_`, `ga006_bracket_5_min`, `ga006_bracket_5_max`, `ga006_1_6_`, `ga006_2_6_`, `ga006_bracket_6_min`, `ga006_bracket_6_max`, `ga006_1_7_`, `ga006_2_7_`, `ga006_bracket_7_min`, `ga006_bracket_7_max`, `ga006_1_8_`, `ga006_2_8_`, `ga006_bracket_8_min`, `ga006_bracket_8_max`, `ga006_1_9_`, `ga006_2_9_`, `ga006_bracket_9_min`, `ga006_bracket_9_max`, `ga006_1_10_`, `ga006_2_10_`, `ga006_1_11_`, `ga006_2_11_`, `ga006_1_12_`, `ga006_2_12_`, `ga008_1b_1_`, `ga008_1c_1_`, `ga008_1b_2_`, `ga008_1c_2_`, `ga008_1b_3_`, `ga008_1c_3_`, `ga008_1b_4_`, `ga008_1c_4_`, `ga008_1b_5_`, `ga008_1c_5_`, `ga008_1b_6_`, `ga008_1c_6_`, `ga008_1b_7_`, `ga008_1c_7_`, `ga008_1b_8_`, `ga008_1c_8_`, `ga008_1b_9_`, `ga008_1c_9_`, `ga008_1b_10_`, `ga008_1c_10_`, `ga008_1b_11_`, `ga008_1c_11_`, `ga008_1b_12_`, `ga008_1c_12_`, `ga008_2b_1_`, `ga008_2c_1_`, `ga008_2b_2_`, `ga008_2c_2_`, `ga008_2b_3_`, `ga008_2c_3_`, `ga008_2b_4_`, `ga008_2c_4_`, `ga008_2b_5_`, `ga008_2c_5_`, `ga008_2b_6_`, `ga008_2c_6_`, `ga008_2b_7_`, `ga008_2c_7_`, `ga008_2b_8_`, `ga008_2c_8_`, `ga008_2b_9_`, `ga008_2c_9_`, `ga008_2b_10_`, `ga008_2c_10_`, `ga008_2b_11_`, `ga008_2c_11_`, `ga008_2b_12_`, `ga008_2c_12_`, `ga008_3b_1_`, `ga008_3c_1_`, `ga008_3b_2_`, `ga008_3c_2_`, `ga008_3b_3_`, `ga008_3c_3_`, `ga008_3b_4_`, `ga008_3c_4_`, `ga008_3b_5_`, `ga008_3c_5_`, `ga008_3b_6_`, `ga008_3c_6_`, `ga008_3b_7_`, `ga008_3c_7_`, `ga008_3b_8_`, `ga008_3c_8_`, `ga008_3b_9_`, `ga008_3c_9_`, `ga008_3b_10_`, `ga008_3c_10_`, `ga008_3b_11_`, `ga008_3c_11_`, `ga008_3b_12_`, `ga008_3c_12_`, `ga008_4b_1_`, `ga008_4c_1_`, `ga008_4b_2_`, `ga008_4c_2_`, `ga008_4b_3_`, `ga008_4c_3_`, `ga008_4b_4_`, `ga008_4c_4_`, `ga008_4b_5_`, `ga008_4c_5_`, `ga008_4b_6_`, `ga008_4c_6_`, `ga008_4b_7_`, `ga008_4c_7_`, `ga008_4b_8_`, `ga008_4c_8_`, `ga008_4b_9_`, `ga008_4c_9_`, `ga008_4b_10_`, `ga008_4c_10_`, `ga008_4b_11_`, `ga008_4c_11_`, `ga008_4b_12_`, `ga008_4c_12_`, `ga008_5b_1_`, `ga008_5c_1_`, `ga008_5b_2_`, `ga008_5c_2_`, `ga008_5b_3_`, `ga008_5c_3_`, `ga008_5b_4_`, `ga008_5c_4_`, `ga008_5b_5_`, `ga008_5c_5_`, `ga008_5b_6_`, `ga008_5c_6_`, `ga008_5b_7_`, `ga008_5c_7_`|  
|----------|------------|
<!-- | **Label** | `Birth Year` | -->
| **Table name** | `Individual_Income_wave2`, `Household_Income_wave2` |
| **Description** |  |  



```{r assign2, echo=F}
opal.assign.table.tibble(o, 'CHARLS_wealth1','CHARLS.Individual_Income_wave2',
                         variables=list('householdID', 'ga002_1', 'ga002_2', 'ga002_bracket_min', 'ga002_bracket_max', 'ga004_1_1_', 'ga004_2_1_', 'ga004_1_2_', 'ga004_2_2_', 'ga004_1_3_', 'ga004_2_3_', 'ga004_1_4_', 'ga004_2_4_', 'ga004_1_5_', 'ga004_2_5_', 'ga004_1_6_', 'ga004_2_6_', 'ga004_1_7_', 'ga004_2_7_', 'ga004_1_8_', 'ga004_2_8_', 'ga004_1_9_', 'ga004_2_9_', 'hc024'), missings = TRUE)
CHARLS_wealth1 <- opal.execute(o,'CHARLS_wealth1')


opal.assign.table.tibble(o, 'CHARLS_wealth2','CHARLS.Household_Income_wave2',
                         variables=list('ga006_1_1_', 'ga006_2_1_', 'ga006_bracket_1_min', 'ga006_bracket_1_max', 'ga006_1_2_', 'ga006_2_2_', 'ga006_bracket_2_min', 'ga006_bracket_2_max', 'ga006_1_3_', 'ga006_2_3_', 'ga006_bracket_3_min', 'ga006_bracket_3_max', 'ga006_1_4_', 'ga006_2_4_', 'ga006_bracket_4_min', 'ga006_bracket_4_max', 'ga006_1_5_', 'ga006_2_5_', 'ga006_bracket_5_min', 'ga006_bracket_5_max', 'ga006_1_6_', 'ga006_2_6_', 'ga006_bracket_6_min', 'ga006_bracket_6_max', 'ga006_1_7_', 'ga006_2_7_', 'ga006_bracket_7_min', 'ga006_bracket_7_max', 'ga006_1_8_', 'ga006_2_8_', 'ga006_bracket_8_min', 'ga006_bracket_8_max', 'ga006_1_9_', 'ga006_2_9_', 'ga006_bracket_9_min', 'ga006_bracket_9_max', 'ga006_1_10_', 'ga006_2_10_', 'ga006_1_11_', 'ga006_2_11_', 'ga006_1_12_', 'ga006_2_12_', 'ga008_1b_1_', 'ga008_1c_1_', 'ga008_1b_2_', 'ga008_1c_2_', 'ga008_1b_3_', 'ga008_1c_3_', 'ga008_1b_4_', 'ga008_1c_4_', 'ga008_1b_5_', 'ga008_1c_5_', 'ga008_1b_6_', 'ga008_1c_6_', 'ga008_1b_7_', 'ga008_1c_7_', 'ga008_1b_8_', 'ga008_1c_8_', 'ga008_1b_9_', 'ga008_1c_9_', 'ga008_1b_10_', 'ga008_1c_10_', 'ga008_1b_11_', 'ga008_1c_11_', 'ga008_1b_12_', 'ga008_1c_12_', 'ga008_2b_1_', 'ga008_2c_1_', 'ga008_2b_2_', 'ga008_2c_2_', 'ga008_2b_3_', 'ga008_2c_3_', 'ga008_2b_4_', 'ga008_2c_4_', 'ga008_2b_5_', 'ga008_2c_5_', 'ga008_2b_6_', 'ga008_2c_6_', 'ga008_2b_7_', 'ga008_2c_7_', 'ga008_2b_8_', 'ga008_2c_8_', 'ga008_2b_9_', 'ga008_2c_9_', 'ga008_2b_10_', 'ga008_2c_10_', 'ga008_2b_11_', 'ga008_2c_11_', 'ga008_2b_12_', 'ga008_2c_12_', 'ga008_3b_1_', 'ga008_3c_1_', 'ga008_3b_2_', 'ga008_3c_2_', 'ga008_3b_3_', 'ga008_3c_3_', 'ga008_3b_4_', 'ga008_3c_4_', 'ga008_3b_5_', 'ga008_3c_5_', 'ga008_3b_6_', 'ga008_3c_6_', 'ga008_3b_7_', 'ga008_3c_7_', 'ga008_3b_8_', 'ga008_3c_8_', 'ga008_3b_9_', 'ga008_3c_9_', 'ga008_3b_10_', 'ga008_3c_10_', 'ga008_3b_11_', 'ga008_3c_11_', 'ga008_3b_12_', 'ga008_3c_12_', 'ga008_4b_1_', 'ga008_4c_1_', 'ga008_4b_2_', 'ga008_4c_2_', 'ga008_4b_3_', 'ga008_4c_3_', 'ga008_4b_4_', 'ga008_4c_4_', 'ga008_4b_5_', 'ga008_4c_5_', 'ga008_4b_6_', 'ga008_4c_6_', 'ga008_4b_7_', 'ga008_4c_7_', 'ga008_4b_8_', 'ga008_4c_8_', 'ga008_4b_9_', 'ga008_4c_9_', 'ga008_4b_10_', 'ga008_4c_10_', 'ga008_4b_11_', 'ga008_4c_11_', 'ga008_4b_12_', 'ga008_4c_12_', 'ga008_5b_1_', 'ga008_5c_1_', 'ga008_5b_2_', 'ga008_5c_2_', 'ga008_5b_3_', 'ga008_5c_3_', 'ga008_5b_4_', 'ga008_5c_4_', 'ga008_5b_5_', 'ga008_5c_5_', 'ga008_5b_6_', 'ga008_5c_6_', 'ga008_5b_7_', 'ga008_5c_7_'), missings = TRUE)
CHARLS_wealth2 <- opal.execute(o,'CHARLS_wealth2')

opal.assign.table.tibble(o, 'CHARLS_wealth3','CHARLS.Household_Income_wave2',
                         variables=list('ga008_5b_8_', 'ga008_5c_8_', 'ga008_5b_9_', 'ga008_5c_9_', 'ga008_5b_10_', 'ga008_5c_10_', 'ga008_5b_11_', 'ga008_5c_11_', 'ga008_5b_12_', 'ga008_5c_12_', 'ga008_6b_1_', 'ga008_6c_1_', 'ga008_6b_2_', 'ga008_6c_2_', 'ga008_6b_3_', 'ga008_6c_3_', 'ga008_6b_4_', 'ga008_6c_4_', 'ga008_6b_5_', 'ga008_6c_5_', 'ga008_6b_6_', 'ga008_6c_6_', 'ga008_6b_7_', 'ga008_6c_7_', 'ga008_6b_8_', 'ga008_6c_8_', 'ga008_6b_9_', 'ga008_6c_9_', 'ga008_6b_10_', 'ga008_6c_10_', 'ga008_6b_11_', 'ga008_6c_11_', 'ga008_6b_12_', 'ga008_6c_12_', 'ga008_7b_1_', 'ga008_7c_1_', 'ga008_7b_2_', 'ga008_7c_2_', 'ga008_7b_3_', 'ga008_7c_3_', 'ga008_7b_4_', 'ga008_7c_4_', 'ga008_7b_5_', 'ga008_7c_5_', 'ga008_7b_6_', 'ga008_7c_6_', 'ga008_7b_7_', 'ga008_7c_7_', 'ga008_7b_8_', 'ga008_7c_8_', 'ga008_7b_9_', 'ga008_7c_9_', 'ga008_7b_10_', 'ga008_7c_10_', 'ga008_7b_11_', 'ga008_7c_11_', 'ga008_7b_12_', 'ga008_7c_12_', 'ga008_8b_1_', 'ga008_8c_1_', 'ga008_8b_2_', 'ga008_8c_2_', 'ga008_8b_3_', 'ga008_8c_3_', 'ga008_8b_4_', 'ga008_8c_4_', 'ga008_8b_5_', 'ga008_8c_5_', 'ga008_8b_6_', 'ga008_8c_6_', 'ga008_8b_7_', 'ga008_8c_7_', 'ga008_8b_8_', 'ga008_8c_8_', 'ga008_8b_9_', 'ga008_8c_9_', 'ga008_8b_10_', 'ga008_8c_10_', 'ga008_8b_11_', 'ga008_8c_11_', 'ga008_8b_12_', 'ga008_8c_12_', 'ga008_9b_1_', 'ga008_9c_1_', 'ga008_9b_2_', 'ga008_9c_2_', 'ga008_9b_3_', 'ga008_9c_3_', 'ga008_9b_4_', 'ga008_9c_4_', 'ga008_9b_5_', 'ga008_9c_5_', 'ga008_9b_6_', 'ga008_9c_6_', 'ga008_9b_7_', 'ga008_9c_7_', 'ga008_9b_8_', 'ga008_9c_8_', 'ga008_9b_9_', 'ga008_9c_9_', 'ga008_9b_10_', 'ga008_9c_10_', 'ga008_9b_11_', 'ga008_9c_11_', 'ga008_9b_12_', 'ga008_9c_12_', 'gb005_1', 'gb005_bracket_min', 'gb005_bracket_max', 'gb009', 'gb009_bracket_min', 'gb009_bracket_max', 'gb011_1', 'gb011_bracket_min', 'gb011_bracket_max', 'gb012_1', 'gb012_bracket_min', 'gb012_bracket_max', 'gc005_1_', 'gc005_bracket_1_min', 'gc005_bracket_1_max', 'gc005_2_', 'gc005_bracket_2_min', 'gc005_bracket_2_max', 'gc005_3_', 'gc005_4_', 'gd001', 'gd002_1', 'gd002_2', 'gd002_3', 'gd002_4', 'gd002_5', 'gd002_6', 'gd002_7', 'ha052_1', 'ha053_1', 'ha060_1_', 'ha060_2_', 'ha060_3_', 'ha060_4_', 'ha064_1', 'ha071'), missings = TRUE)
CHARLS_wealth3 <- opal.execute(o,'CHARLS_wealth3')

CHARLS_wealth23 <- full_join(CHARLS_wealth2, CHARLS_wealth3, by='id')

opal.assign.table.tibble(o, 'CHARLS_w2_id','CHARLS.CHARLS_w2_ids',
                         variables=list('var'), missings = TRUE)
CHARLS_w2_id <- opal.execute(o,'CHARLS_w2_id')

CHARLS_wealth12 <- left_join(CHARLS_w2_id, CHARLS_wealth1, by='id')
CHARLS_wealth12 <- CHARLS_wealth12[,-2]

names(CHARLS_wealth23) <- c("householdID", names(CHARLS_wealth23)[2:length(CHARLS_wealth23)])
CHARLS_wealth <- left_join(CHARLS_wealth12, CHARLS_wealth23, by='householdID')
```


##### Data management

All the incomes and assets are asked per year, if the individual prefers per month and otherwise a intervals. This information is going to join in one variable per kind of income / asset using the amount per year, therefore the amounts per month are going to be multiplied by 12 and the individuals that provide an interval is computed the midpoint of this interval.

```{r dm2, echo=TRUE}
CHARLS_wealth$ga002_bracket_min <- car::recode(CHARLS_wealth$ga002_bracket_min, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$ga002_bracket_max <- car::recode(CHARLS_wealth$ga002_bracket_max, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$recive <- CHARLS_wealth$ga002_1
CHARLS_wealth$recive[is.na(CHARLS_wealth$recive)] <- CHARLS_wealth$ga002_2[is.na(CHARLS_wealth$recive)]*12
CHARLS_wealth$recive[is.na(CHARLS_wealth$recive)] <- apply(select(CHARLS_wealth, ga002_bracket_min, ga002_bracket_max)[is.na(CHARLS_wealth$recive),], MARGIN = 1, FUN = function(x) x[1]+((x[2]-x[1])/2) )
CHARLS_wealth$recive <- car::recode(CHARLS_wealth$recive, "0=NA")

CHARLS_wealth$ind_inc1 <- CHARLS_wealth$ga004_1_1_
CHARLS_wealth$ind_inc1[is.na(CHARLS_wealth$ind_inc1)] <- CHARLS_wealth$ga004_2_1_[is.na(CHARLS_wealth$ind_inc1)]*12

CHARLS_wealth$ind_inc2 <- CHARLS_wealth$ga004_1_2_
CHARLS_wealth$ind_inc2[is.na(CHARLS_wealth$ind_inc2)] <- CHARLS_wealth$ga004_2_2_[is.na(CHARLS_wealth$ind_inc2)]*12

CHARLS_wealth$ind_inc3 <- CHARLS_wealth$ga004_1_3_
CHARLS_wealth$ind_inc3[is.na(CHARLS_wealth$ind_inc3)] <- CHARLS_wealth$ga004_2_3_[is.na(CHARLS_wealth$ind_inc3)]*12

CHARLS_wealth$ind_inc4 <- CHARLS_wealth$ga004_1_4_
CHARLS_wealth$ind_inc4[is.na(CHARLS_wealth$ind_inc4)] <- CHARLS_wealth$ga004_2_4_[is.na(CHARLS_wealth$ind_inc4)]*12

CHARLS_wealth$ind_inc5 <- CHARLS_wealth$ga004_1_5_
CHARLS_wealth$ind_inc5[is.na(CHARLS_wealth$ind_inc5)] <- CHARLS_wealth$ga004_2_5_[is.na(CHARLS_wealth$ind_inc5)]*12

CHARLS_wealth$ind_inc6 <- CHARLS_wealth$ga004_1_6_
CHARLS_wealth$ind_inc6[is.na(CHARLS_wealth$ind_inc6)] <- CHARLS_wealth$ga004_2_6_[is.na(CHARLS_wealth$ind_inc6)]*12

CHARLS_wealth$ind_inc7 <- CHARLS_wealth$ga004_1_7_
CHARLS_wealth$ind_inc7[is.na(CHARLS_wealth$ind_inc7)] <- CHARLS_wealth$ga004_2_7_[is.na(CHARLS_wealth$ind_inc7)]*12

CHARLS_wealth$ind_inc8 <- CHARLS_wealth$ga004_1_8_
CHARLS_wealth$ind_inc8[is.na(CHARLS_wealth$ind_inc8)] <- CHARLS_wealth$ga004_2_8_[is.na(CHARLS_wealth$ind_inc8)]*12

CHARLS_wealth$ind_inc9 <- CHARLS_wealth$ga004_1_9_
CHARLS_wealth$ind_inc9[is.na(CHARLS_wealth$ind_inc9)] <- CHARLS_wealth$ga004_2_9_[is.na(CHARLS_wealth$ind_inc9)]*12

CHARLS_wealth$ind_inc <- apply(select(CHARLS_wealth, ind_inc1, ind_inc2, ind_inc3, ind_inc4, ind_inc5, ind_inc6, ind_inc7, ind_inc8, ind_inc9), MARGIN = 1, FUN = function(x) sum(x, na.rm = TRUE))
CHARLS_wealth$ind_inc <- car::recode(CHARLS_wealth$ind_inc, "0=NA")


CHARLS_wealth$ga006_bracket_1_min <- car::recode(CHARLS_wealth$ga006_bracket_1_min, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$ga006_bracket_1_max <- car::recode(CHARLS_wealth$ga006_bracket_1_max, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$salary1 <- CHARLS_wealth$ga006_1_1_
CHARLS_wealth$salary1[is.na(CHARLS_wealth$salary1)] <- CHARLS_wealth$ga006_2_1_[is.na(CHARLS_wealth$salary1)]*12
CHARLS_wealth$salary1[is.na(CHARLS_wealth$salary1)] <- apply(select(CHARLS_wealth, ga006_bracket_1_min, ga006_bracket_1_max)[is.na(CHARLS_wealth$salary1),], MARGIN = 1, FUN = function(x) x[1]+((x[2]-x[1])/2) )
CHARLS_wealth$salary1 <- car::recode(CHARLS_wealth$salary1, "0=NA")

CHARLS_wealth$ga006_bracket_2_min <- car::recode(CHARLS_wealth$ga006_bracket_2_min, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$ga006_bracket_2_max <- car::recode(CHARLS_wealth$ga006_bracket_2_max, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$salary2 <- CHARLS_wealth$ga006_1_2_
CHARLS_wealth$salary2[is.na(CHARLS_wealth$salary2)] <- CHARLS_wealth$ga006_2_2_[is.na(CHARLS_wealth$salary2)]*12
CHARLS_wealth$salary2[is.na(CHARLS_wealth$salary2)] <- apply(select(CHARLS_wealth, ga006_bracket_2_min, ga006_bracket_2_max)[is.na(CHARLS_wealth$salary2),], MARGIN = 1, FUN = function(x) x[1]+((x[2]-x[1])/2) )
CHARLS_wealth$salary2 <- car::recode(CHARLS_wealth$salary2, "0=NA")

CHARLS_wealth$ga006_bracket_3_min <- car::recode(CHARLS_wealth$ga006_bracket_3_min, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$ga006_bracket_3_max <- car::recode(CHARLS_wealth$ga006_bracket_3_max, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$salary3 <- CHARLS_wealth$ga006_1_3_
CHARLS_wealth$salary3[is.na(CHARLS_wealth$salary3)] <- CHARLS_wealth$ga006_2_3_[is.na(CHARLS_wealth$salary3)]*12
CHARLS_wealth$salary3[is.na(CHARLS_wealth$salary3)] <- apply(select(CHARLS_wealth, ga006_bracket_3_min, ga006_bracket_3_max)[is.na(CHARLS_wealth$salary3),], MARGIN = 1, FUN = function(x) x[1]+((x[2]-x[1])/2) )
CHARLS_wealth$salary3 <- car::recode(CHARLS_wealth$salary3, "0=NA")

CHARLS_wealth$ga006_bracket_4_min <- car::recode(CHARLS_wealth$ga006_bracket_4_min, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$ga006_bracket_4_max <- car::recode(CHARLS_wealth$ga006_bracket_4_max, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$salary4 <- CHARLS_wealth$ga006_1_4_
CHARLS_wealth$salary4[is.na(CHARLS_wealth$salary4)] <- CHARLS_wealth$ga006_2_4_[is.na(CHARLS_wealth$salary4)]*12
CHARLS_wealth$salary4[is.na(CHARLS_wealth$salary4)] <- apply(select(CHARLS_wealth, ga006_bracket_4_min, ga006_bracket_4_max)[is.na(CHARLS_wealth$salary4),], MARGIN = 1, FUN = function(x) x[1]+((x[2]-x[1])/2) )
CHARLS_wealth$salary4 <- car::recode(CHARLS_wealth$salary4, "0=NA")

CHARLS_wealth$ga006_bracket_5_min <- car::recode(CHARLS_wealth$ga006_bracket_5_min, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$ga006_bracket_5_max <- car::recode(CHARLS_wealth$ga006_bracket_5_max, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$salary5 <- CHARLS_wealth$ga006_1_5_
CHARLS_wealth$salary5[is.na(CHARLS_wealth$salary5)] <- CHARLS_wealth$ga006_2_5_[is.na(CHARLS_wealth$salary5)]*12
CHARLS_wealth$salary5[is.na(CHARLS_wealth$salary5)] <- apply(select(CHARLS_wealth, ga006_bracket_5_min, ga006_bracket_5_max)[is.na(CHARLS_wealth$salary5),], MARGIN = 1, FUN = function(x) x[1]+((x[2]-x[1])/2) )
CHARLS_wealth$salary5 <- car::recode(CHARLS_wealth$salary5, "0=NA")

CHARLS_wealth$ga006_bracket_6_min <- car::recode(CHARLS_wealth$ga006_bracket_6_min, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$ga006_bracket_6_max <- car::recode(CHARLS_wealth$ga006_bracket_6_max, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$salary6 <- CHARLS_wealth$ga006_1_6_
CHARLS_wealth$salary6[is.na(CHARLS_wealth$salary6)] <- CHARLS_wealth$ga006_2_6_[is.na(CHARLS_wealth$salary6)]*12
CHARLS_wealth$salary6[is.na(CHARLS_wealth$salary6)] <- apply(select(CHARLS_wealth, ga006_bracket_6_min, ga006_bracket_6_max)[is.na(CHARLS_wealth$salary6),], MARGIN = 1, FUN = function(x) x[1]+((x[2]-x[1])/2) )
CHARLS_wealth$salary6 <- car::recode(CHARLS_wealth$salary6, "0=NA")

CHARLS_wealth$ga006_bracket_7_min <- car::recode(CHARLS_wealth$ga006_bracket_7_min, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$ga006_bracket_7_max <- car::recode(CHARLS_wealth$ga006_bracket_7_max, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$salary7 <- CHARLS_wealth$ga006_1_7_
CHARLS_wealth$salary7[is.na(CHARLS_wealth$salary7)] <- CHARLS_wealth$ga006_2_7_[is.na(CHARLS_wealth$salary7)]*12
CHARLS_wealth$salary7[is.na(CHARLS_wealth$salary7)] <- apply(select(CHARLS_wealth, ga006_bracket_7_min, ga006_bracket_7_max)[is.na(CHARLS_wealth$salary7),], MARGIN = 1, FUN = function(x) x[1]+((x[2]-x[1])/2) )
CHARLS_wealth$salary7 <- car::recode(CHARLS_wealth$salary7, "0=NA")

CHARLS_wealth$ga006_bracket_8_min <- car::recode(CHARLS_wealth$ga006_bracket_8_min, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$ga006_bracket_8_max <- car::recode(CHARLS_wealth$ga006_bracket_8_max, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$salary8 <- CHARLS_wealth$ga006_1_8_
CHARLS_wealth$salary8[is.na(CHARLS_wealth$salary8)] <- CHARLS_wealth$ga006_2_8_[is.na(CHARLS_wealth$salary8)]*12
CHARLS_wealth$salary8[is.na(CHARLS_wealth$salary8)] <- apply(select(CHARLS_wealth, ga006_bracket_8_min, ga006_bracket_8_max)[is.na(CHARLS_wealth$salary8),], MARGIN = 1, FUN = function(x) x[1]+((x[2]-x[1])/2) )
CHARLS_wealth$salary8 <- car::recode(CHARLS_wealth$salary8, "0=NA")

CHARLS_wealth$ga006_bracket_9_min <- car::recode(CHARLS_wealth$ga006_bracket_9_min, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$ga006_bracket_9_max <- car::recode(CHARLS_wealth$ga006_bracket_9_max, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$salary9 <- CHARLS_wealth$ga006_1_9_
CHARLS_wealth$salary9[is.na(CHARLS_wealth$salary9)] <- CHARLS_wealth$ga006_2_9_[is.na(CHARLS_wealth$salary9)]*12
CHARLS_wealth$salary9[is.na(CHARLS_wealth$salary9)] <- apply(select(CHARLS_wealth, ga006_bracket_9_min, ga006_bracket_9_max)[is.na(CHARLS_wealth$salary9),], MARGIN = 1, FUN = function(x) x[1]+((x[2]-x[1])/2) )
CHARLS_wealth$salary9 <- car::recode(CHARLS_wealth$salary9, "0=NA")

CHARLS_wealth$salary10 <- CHARLS_wealth$ga006_1_10_
CHARLS_wealth$salary10[is.na(CHARLS_wealth$salary10)] <- CHARLS_wealth$ga006_2_10_[is.na(CHARLS_wealth$salary10)]*12
CHARLS_wealth$salary10 <- car::recode(CHARLS_wealth$salary10, "0=NA")

CHARLS_wealth$salary11 <- CHARLS_wealth$ga006_1_11_
CHARLS_wealth$salary11[is.na(CHARLS_wealth$salary11)] <- CHARLS_wealth$ga006_2_11_[is.na(CHARLS_wealth$salary11)]*12
CHARLS_wealth$salary11 <- car::recode(CHARLS_wealth$salary11, "0=NA")

CHARLS_wealth$salary12 <- CHARLS_wealth$ga006_1_12_
CHARLS_wealth$salary12[is.na(CHARLS_wealth$salary12)] <- CHARLS_wealth$ga006_2_12_[is.na(CHARLS_wealth$salary12)]*12
CHARLS_wealth$salary12 <- car::recode(CHARLS_wealth$salary12, "0=NA")


CHARLS_wealth$salary <- apply(select(CHARLS_wealth, salary1, salary2, salary3, salary4, salary5, salary6, salary7, salary8, salary9, salary10, salary11, salary12), MARGIN = 1, FUN = function(x) sum(x, na.rm = TRUE))
CHARLS_wealth$salary <- car::recode(CHARLS_wealth$salary, "0=NA")


CHARLS_wealth$pension1 <- CHARLS_wealth$ga008_1b_1_
CHARLS_wealth$pension1[is.na(CHARLS_wealth$pension1)] <- CHARLS_wealth$ga008_1c_1_[is.na(CHARLS_wealth$pension1)]*12
CHARLS_wealth$pension1 <- car::recode(CHARLS_wealth$pension1, "0=NA")

CHARLS_wealth$pension2 <- CHARLS_wealth$ga008_1b_2_
CHARLS_wealth$pension2[is.na(CHARLS_wealth$pension2)] <- CHARLS_wealth$ga008_1c_2_[is.na(CHARLS_wealth$pension2)]*12
CHARLS_wealth$pension2 <- car::recode(CHARLS_wealth$pension2, "0=NA")

CHARLS_wealth$pension3 <- CHARLS_wealth$ga008_1b_3_
CHARLS_wealth$pension3[is.na(CHARLS_wealth$pension3)] <- CHARLS_wealth$ga008_1c_3_[is.na(CHARLS_wealth$pension3)]*12
CHARLS_wealth$pension3 <- car::recode(CHARLS_wealth$pension3, "0=NA")

CHARLS_wealth$pension4 <- CHARLS_wealth$ga008_1b_4_
CHARLS_wealth$pension4[is.na(CHARLS_wealth$pension4)] <- CHARLS_wealth$ga008_1c_4_[is.na(CHARLS_wealth$pension4)]*12
CHARLS_wealth$pension4 <- car::recode(CHARLS_wealth$pension4, "0=NA")

CHARLS_wealth$pension5 <- CHARLS_wealth$ga008_1b_5_
CHARLS_wealth$pension5[is.na(CHARLS_wealth$pension5)] <- CHARLS_wealth$ga008_1c_5_[is.na(CHARLS_wealth$pension5)]*12
CHARLS_wealth$pension5 <- car::recode(CHARLS_wealth$pension5, "0=NA")

CHARLS_wealth$pension6 <- CHARLS_wealth$ga008_1b_6_
CHARLS_wealth$pension6[is.na(CHARLS_wealth$pension6)] <- CHARLS_wealth$ga008_1c_6_[is.na(CHARLS_wealth$pension6)]*12
CHARLS_wealth$pension6 <- car::recode(CHARLS_wealth$pension6, "0=NA")

CHARLS_wealth$pension7 <- CHARLS_wealth$ga008_1b_7_
CHARLS_wealth$pension7[is.na(CHARLS_wealth$pension7)] <- CHARLS_wealth$ga008_1c_7_[is.na(CHARLS_wealth$pension7)]*12
CHARLS_wealth$pension7 <- car::recode(CHARLS_wealth$pension7, "0=NA")

CHARLS_wealth$pension8 <- CHARLS_wealth$ga008_1b_8_
CHARLS_wealth$pension8[is.na(CHARLS_wealth$pension8)] <- CHARLS_wealth$ga008_1c_8_[is.na(CHARLS_wealth$pension8)]*12
CHARLS_wealth$pension8 <- car::recode(CHARLS_wealth$pension8, "0=NA")

CHARLS_wealth$pension9 <- CHARLS_wealth$ga008_1b_9_
CHARLS_wealth$pension9[is.na(CHARLS_wealth$pension9)] <- CHARLS_wealth$ga008_1c_9_[is.na(CHARLS_wealth$pension9)]*12
CHARLS_wealth$pension9 <- car::recode(CHARLS_wealth$pension9, "0=NA")

CHARLS_wealth$pension10 <- CHARLS_wealth$ga008_1b_10_
CHARLS_wealth$pension10[is.na(CHARLS_wealth$pension10)] <- CHARLS_wealth$ga008_1c_10_[is.na(CHARLS_wealth$pension10)]*12
CHARLS_wealth$pension10 <- car::recode(CHARLS_wealth$pension10, "0=NA")

CHARLS_wealth$pension11 <- CHARLS_wealth$ga008_1b_11_
CHARLS_wealth$pension11[is.na(CHARLS_wealth$pension11)] <- CHARLS_wealth$ga008_1c_11_[is.na(CHARLS_wealth$pension11)]*12
CHARLS_wealth$pension11 <- car::recode(CHARLS_wealth$pension11, "0=NA")

CHARLS_wealth$pension12 <- CHARLS_wealth$ga008_1b_12_
CHARLS_wealth$pension12[is.na(CHARLS_wealth$pension12)] <- CHARLS_wealth$ga008_1c_1_[is.na(CHARLS_wealth$pension12)]*12
CHARLS_wealth$ga008_1c_12_ <- car::recode(CHARLS_wealth$pension12, "0=NA")

CHARLS_wealth$pension <- apply(select(CHARLS_wealth, pension1, pension2, pension3, pension4, pension5, pension6, pension7, pension8, pension9, pension10, pension11, pension12), MARGIN = 1, FUN = function(x) sum(x, na.rm = TRUE))
CHARLS_wealth$pension <- car::recode(CHARLS_wealth$pension, "0=NA")

CHARLS_wealth$unemploy1 <- CHARLS_wealth$ga008_2b_1_
CHARLS_wealth$unemploy1[is.na(CHARLS_wealth$unemploy1)] <- CHARLS_wealth$ga008_2c_1_[is.na(CHARLS_wealth$unemploy1)]*12
CHARLS_wealth$unemploy1 <- car::recode(CHARLS_wealth$unemploy1, "0=NA")

CHARLS_wealth$unemploy2 <- CHARLS_wealth$ga008_2b_2_
CHARLS_wealth$unemploy2[is.na(CHARLS_wealth$unemploy2)] <- CHARLS_wealth$ga008_2c_2_[is.na(CHARLS_wealth$unemploy2)]*12
CHARLS_wealth$unemploy2 <- car::recode(CHARLS_wealth$unemploy2, "0=NA")

CHARLS_wealth$unemploy3 <- CHARLS_wealth$ga008_2b_3_
CHARLS_wealth$unemploy3[is.na(CHARLS_wealth$unemploy3)] <- CHARLS_wealth$ga008_2c_3_[is.na(CHARLS_wealth$unemploy3)]*12
CHARLS_wealth$unemploy3 <- car::recode(CHARLS_wealth$unemploy3, "0=NA")

CHARLS_wealth$unemploy4 <- CHARLS_wealth$ga008_2b_4_
CHARLS_wealth$unemploy4[is.na(CHARLS_wealth$unemploy4)] <- CHARLS_wealth$ga008_2c_4_[is.na(CHARLS_wealth$unemploy4)]*12
CHARLS_wealth$unemploy4 <- car::recode(CHARLS_wealth$unemploy4, "0=NA")

CHARLS_wealth$unemploy5 <- CHARLS_wealth$ga008_2b_5_
CHARLS_wealth$unemploy5[is.na(CHARLS_wealth$unemploy5)] <- CHARLS_wealth$ga008_2c_5_[is.na(CHARLS_wealth$unemploy5)]*12
CHARLS_wealth$unemploy5 <- car::recode(CHARLS_wealth$unemploy5, "0=NA")

CHARLS_wealth$unemploy6 <- CHARLS_wealth$ga008_2b_6_
CHARLS_wealth$unemploy6[is.na(CHARLS_wealth$unemploy6)] <- CHARLS_wealth$ga008_2c_6_[is.na(CHARLS_wealth$unemploy6)]*12
CHARLS_wealth$unemploy6 <- car::recode(CHARLS_wealth$unemploy6, "0=NA")

CHARLS_wealth$unemploy7 <- CHARLS_wealth$ga008_2b_7_
CHARLS_wealth$unemploy7[is.na(CHARLS_wealth$unemploy7)] <- CHARLS_wealth$ga008_2c_7_[is.na(CHARLS_wealth$unemploy7)]*12
CHARLS_wealth$unemploy7 <- car::recode(CHARLS_wealth$unemploy7, "0=NA")

CHARLS_wealth$unemploy8 <- CHARLS_wealth$ga008_2b_8_
CHARLS_wealth$unemploy8[is.na(CHARLS_wealth$unemploy8)] <- CHARLS_wealth$ga008_2c_8_[is.na(CHARLS_wealth$unemploy8)]*12
CHARLS_wealth$unemploy8 <- car::recode(CHARLS_wealth$unemploy8, "0=NA")

CHARLS_wealth$unemploy9 <- CHARLS_wealth$ga008_2b_9_
CHARLS_wealth$unemploy9[is.na(CHARLS_wealth$unemploy9)] <- CHARLS_wealth$ga008_2c_9_[is.na(CHARLS_wealth$unemploy9)]*12
CHARLS_wealth$unemploy9 <- car::recode(CHARLS_wealth$unemploy9, "0=NA")

CHARLS_wealth$unemploy10 <- CHARLS_wealth$ga008_2b_10_
CHARLS_wealth$unemploy10[is.na(CHARLS_wealth$unemploy10)] <- CHARLS_wealth$ga008_2c_10_[is.na(CHARLS_wealth$unemploy10)]*12
CHARLS_wealth$unemploy10 <- car::recode(CHARLS_wealth$unemploy10, "0=NA")

CHARLS_wealth$unemploy11 <- CHARLS_wealth$ga008_2b_11_
CHARLS_wealth$unemploy11[is.na(CHARLS_wealth$unemploy11)] <- CHARLS_wealth$ga008_2c_11_[is.na(CHARLS_wealth$unemploy11)]*12
CHARLS_wealth$unemploy11 <- car::recode(CHARLS_wealth$unemploy11, "0=NA")

CHARLS_wealth$unemploy12 <- CHARLS_wealth$ga008_2b_12_
CHARLS_wealth$unemploy12[is.na(CHARLS_wealth$unemploy12)] <- CHARLS_wealth$ga008_2c_1_[is.na(CHARLS_wealth$unemploy12)]*12
CHARLS_wealth$ga008_2c_12_ <- car::recode(CHARLS_wealth$unemploy12, "0=NA")

CHARLS_wealth$unemploy <- apply(select(CHARLS_wealth, unemploy1, unemploy2, unemploy3, unemploy4, unemploy5, unemploy6, unemploy7, unemploy8, unemploy9, unemploy10, unemploy11, unemploy12), MARGIN = 1, FUN = function(x) sum(x, na.rm = TRUE))
CHARLS_wealth$unemploy <- car::recode(CHARLS_wealth$unemploy, "0=NA")

CHARLS_wealth$pension_sub1 <- CHARLS_wealth$ga008_3b_1_
CHARLS_wealth$pension_sub1[is.na(CHARLS_wealth$pension_sub1)] <- CHARLS_wealth$ga008_3c_1_[is.na(CHARLS_wealth$pension_sub1)]*12
CHARLS_wealth$pension_sub1 <- car::recode(CHARLS_wealth$pension_sub1, "0=NA")

CHARLS_wealth$pension_sub2 <- CHARLS_wealth$ga008_3b_2_
CHARLS_wealth$pension_sub2[is.na(CHARLS_wealth$pension_sub2)] <- CHARLS_wealth$ga008_3c_2_[is.na(CHARLS_wealth$pension_sub2)]*12
CHARLS_wealth$pension_sub2 <- car::recode(CHARLS_wealth$pension_sub2, "0=NA")

CHARLS_wealth$pension_sub3 <- CHARLS_wealth$ga008_3b_3_
CHARLS_wealth$pension_sub3[is.na(CHARLS_wealth$pension_sub3)] <- CHARLS_wealth$ga008_3c_3_[is.na(CHARLS_wealth$pension_sub3)]*12
CHARLS_wealth$pension_sub3 <- car::recode(CHARLS_wealth$pension_sub3, "0=NA")

CHARLS_wealth$pension_sub4 <- CHARLS_wealth$ga008_3b_4_
CHARLS_wealth$pension_sub4[is.na(CHARLS_wealth$pension_sub4)] <- CHARLS_wealth$ga008_3c_4_[is.na(CHARLS_wealth$pension_sub4)]*12
CHARLS_wealth$pension_sub4 <- car::recode(CHARLS_wealth$pension_sub4, "0=NA")

CHARLS_wealth$pension_sub5 <- CHARLS_wealth$ga008_3b_5_
CHARLS_wealth$pension_sub5[is.na(CHARLS_wealth$pension_sub5)] <- CHARLS_wealth$ga008_3c_5_[is.na(CHARLS_wealth$pension_sub5)]*12
CHARLS_wealth$pension_sub5 <- car::recode(CHARLS_wealth$pension_sub5, "0=NA")

CHARLS_wealth$pension_sub6 <- CHARLS_wealth$ga008_3b_6_
CHARLS_wealth$pension_sub6[is.na(CHARLS_wealth$pension_sub6)] <- CHARLS_wealth$ga008_3c_6_[is.na(CHARLS_wealth$pension_sub6)]*12
CHARLS_wealth$pension_sub6 <- car::recode(CHARLS_wealth$pension_sub6, "0=NA")

CHARLS_wealth$pension_sub7 <- CHARLS_wealth$ga008_3b_7_
CHARLS_wealth$pension_sub7[is.na(CHARLS_wealth$pension_sub7)] <- CHARLS_wealth$ga008_3c_7_[is.na(CHARLS_wealth$pension_sub7)]*12
CHARLS_wealth$pension_sub7 <- car::recode(CHARLS_wealth$pension_sub7, "0=NA")

CHARLS_wealth$pension_sub8 <- CHARLS_wealth$ga008_3b_8_
CHARLS_wealth$pension_sub8[is.na(CHARLS_wealth$pension_sub8)] <- CHARLS_wealth$ga008_3c_8_[is.na(CHARLS_wealth$pension_sub8)]*12
CHARLS_wealth$pension_sub8 <- car::recode(CHARLS_wealth$pension_sub8, "0=NA")

CHARLS_wealth$pension_sub9 <- CHARLS_wealth$ga008_3b_9_
CHARLS_wealth$pension_sub9[is.na(CHARLS_wealth$pension_sub9)] <- CHARLS_wealth$ga008_3c_9_[is.na(CHARLS_wealth$pension_sub9)]*12
CHARLS_wealth$pension_sub9 <- car::recode(CHARLS_wealth$pension_sub9, "0=NA")

CHARLS_wealth$pension_sub10 <- CHARLS_wealth$ga008_3b_10_
CHARLS_wealth$pension_sub10[is.na(CHARLS_wealth$pension_sub10)] <- CHARLS_wealth$ga008_3c_10_[is.na(CHARLS_wealth$pension_sub10)]*12
CHARLS_wealth$pension_sub10 <- car::recode(CHARLS_wealth$pension_sub10, "0=NA")

CHARLS_wealth$pension_sub11 <- CHARLS_wealth$ga008_3b_11_
CHARLS_wealth$pension_sub11[is.na(CHARLS_wealth$pension_sub11)] <- CHARLS_wealth$ga008_3c_11_[is.na(CHARLS_wealth$pension_sub11)]*12
CHARLS_wealth$pension_sub11 <- car::recode(CHARLS_wealth$pension_sub11, "0=NA")

CHARLS_wealth$pension_sub12 <- CHARLS_wealth$ga008_3b_12_
CHARLS_wealth$pension_sub12[is.na(CHARLS_wealth$pension_sub12)] <- CHARLS_wealth$ga008_3c_1_[is.na(CHARLS_wealth$pension_sub12)]*12
CHARLS_wealth$ga008_3c_12_ <- car::recode(CHARLS_wealth$pension_sub12, "0=NA")

CHARLS_wealth$pension_sub <- apply(select(CHARLS_wealth, pension_sub1, pension_sub2, pension_sub3, pension_sub4, pension_sub5, pension_sub6, pension_sub7, pension_sub8, pension_sub9, pension_sub10, pension_sub11, pension_sub12), MARGIN = 1, FUN = function(x) sum(x, na.rm = TRUE))
CHARLS_wealth$pension_sub <- car::recode(CHARLS_wealth$pension_sub, "0=NA")

CHARLS_wealth$accid_compe1 <- CHARLS_wealth$ga008_4b_1_
CHARLS_wealth$accid_compe1[is.na(CHARLS_wealth$accid_compe1)] <- CHARLS_wealth$ga008_4c_1_[is.na(CHARLS_wealth$accid_compe1)]*12
CHARLS_wealth$accid_compe1 <- car::recode(CHARLS_wealth$accid_compe1, "0=NA")

CHARLS_wealth$accid_compe2 <- CHARLS_wealth$ga008_4b_2_
CHARLS_wealth$accid_compe2[is.na(CHARLS_wealth$accid_compe2)] <- CHARLS_wealth$ga008_4c_2_[is.na(CHARLS_wealth$accid_compe2)]*12
CHARLS_wealth$accid_compe2 <- car::recode(CHARLS_wealth$accid_compe2, "0=NA")

CHARLS_wealth$accid_compe3 <- CHARLS_wealth$ga008_4b_3_
CHARLS_wealth$accid_compe3[is.na(CHARLS_wealth$accid_compe3)] <- CHARLS_wealth$ga008_4c_3_[is.na(CHARLS_wealth$accid_compe3)]*12
CHARLS_wealth$accid_compe3 <- car::recode(CHARLS_wealth$accid_compe3, "0=NA")

CHARLS_wealth$accid_compe4 <- CHARLS_wealth$ga008_4b_4_
CHARLS_wealth$accid_compe4[is.na(CHARLS_wealth$accid_compe4)] <- CHARLS_wealth$ga008_4c_4_[is.na(CHARLS_wealth$accid_compe4)]*12
CHARLS_wealth$accid_compe4 <- car::recode(CHARLS_wealth$accid_compe4, "0=NA")

CHARLS_wealth$accid_compe5 <- CHARLS_wealth$ga008_4b_5_
CHARLS_wealth$accid_compe5[is.na(CHARLS_wealth$accid_compe5)] <- CHARLS_wealth$ga008_4c_5_[is.na(CHARLS_wealth$accid_compe5)]*12
CHARLS_wealth$accid_compe5 <- car::recode(CHARLS_wealth$accid_compe5, "0=NA")

CHARLS_wealth$accid_compe6 <- CHARLS_wealth$ga008_4b_6_
CHARLS_wealth$accid_compe6[is.na(CHARLS_wealth$accid_compe6)] <- CHARLS_wealth$ga008_4c_6_[is.na(CHARLS_wealth$accid_compe6)]*12
CHARLS_wealth$accid_compe6 <- car::recode(CHARLS_wealth$accid_compe6, "0=NA")

CHARLS_wealth$accid_compe7 <- CHARLS_wealth$ga008_4b_7_
CHARLS_wealth$accid_compe7[is.na(CHARLS_wealth$accid_compe7)] <- CHARLS_wealth$ga008_4c_7_[is.na(CHARLS_wealth$accid_compe7)]*12
CHARLS_wealth$accid_compe7 <- car::recode(CHARLS_wealth$accid_compe7, "0=NA")

CHARLS_wealth$accid_compe8 <- CHARLS_wealth$ga008_4b_8_
CHARLS_wealth$accid_compe8[is.na(CHARLS_wealth$accid_compe8)] <- CHARLS_wealth$ga008_4c_8_[is.na(CHARLS_wealth$accid_compe8)]*12
CHARLS_wealth$accid_compe8 <- car::recode(CHARLS_wealth$accid_compe8, "0=NA")

CHARLS_wealth$accid_compe9 <- CHARLS_wealth$ga008_4b_9_
CHARLS_wealth$accid_compe9[is.na(CHARLS_wealth$accid_compe9)] <- CHARLS_wealth$ga008_4c_9_[is.na(CHARLS_wealth$accid_compe9)]*12
CHARLS_wealth$accid_compe9 <- car::recode(CHARLS_wealth$accid_compe9, "0=NA")

CHARLS_wealth$accid_compe10 <- CHARLS_wealth$ga008_4b_10_
CHARLS_wealth$accid_compe10[is.na(CHARLS_wealth$accid_compe10)] <- CHARLS_wealth$ga008_4c_10_[is.na(CHARLS_wealth$accid_compe10)]*12
CHARLS_wealth$accid_compe10 <- car::recode(CHARLS_wealth$accid_compe10, "0=NA")

CHARLS_wealth$accid_compe11 <- CHARLS_wealth$ga008_4b_11_
CHARLS_wealth$accid_compe11[is.na(CHARLS_wealth$accid_compe11)] <- CHARLS_wealth$ga008_4c_11_[is.na(CHARLS_wealth$accid_compe11)]*12
CHARLS_wealth$accid_compe11 <- car::recode(CHARLS_wealth$accid_compe11, "0=NA")

CHARLS_wealth$accid_compe12 <- CHARLS_wealth$ga008_4b_12_
CHARLS_wealth$accid_compe12[is.na(CHARLS_wealth$accid_compe12)] <- CHARLS_wealth$ga008_4c_1_[is.na(CHARLS_wealth$accid_compe12)]*12
CHARLS_wealth$ga008_4c_12_ <- car::recode(CHARLS_wealth$accid_compe12, "0=NA")

CHARLS_wealth$accid_compe <- apply(select(CHARLS_wealth, accid_compe1, accid_compe2, accid_compe3, accid_compe4, accid_compe5, accid_compe6, accid_compe7, accid_compe8, accid_compe9, accid_compe10, accid_compe11, accid_compe12), MARGIN = 1, FUN = function(x) sum(x, na.rm = TRUE))
CHARLS_wealth$accid_compe <- car::recode(CHARLS_wealth$accid_compe, "0=NA")

CHARLS_wealth$elderly_subs1 <- CHARLS_wealth$ga008_5b_1_
CHARLS_wealth$elderly_subs1[is.na(CHARLS_wealth$elderly_subs1)] <- CHARLS_wealth$ga008_5c_1_[is.na(CHARLS_wealth$elderly_subs1)]*12
CHARLS_wealth$elderly_subs1 <- car::recode(CHARLS_wealth$elderly_subs1, "0=NA")

CHARLS_wealth$elderly_subs2 <- CHARLS_wealth$ga008_5b_2_
CHARLS_wealth$elderly_subs2[is.na(CHARLS_wealth$elderly_subs2)] <- CHARLS_wealth$ga008_5c_2_[is.na(CHARLS_wealth$elderly_subs2)]*12
CHARLS_wealth$elderly_subs2 <- car::recode(CHARLS_wealth$elderly_subs2, "0=NA")

CHARLS_wealth$elderly_subs3 <- CHARLS_wealth$ga008_5b_3_
CHARLS_wealth$elderly_subs3[is.na(CHARLS_wealth$elderly_subs3)] <- CHARLS_wealth$ga008_5c_3_[is.na(CHARLS_wealth$elderly_subs3)]*12
CHARLS_wealth$elderly_subs3 <- car::recode(CHARLS_wealth$elderly_subs3, "0=NA")

CHARLS_wealth$elderly_subs4 <- CHARLS_wealth$ga008_5b_4_
CHARLS_wealth$elderly_subs4[is.na(CHARLS_wealth$elderly_subs4)] <- CHARLS_wealth$ga008_5c_4_[is.na(CHARLS_wealth$elderly_subs4)]*12
CHARLS_wealth$elderly_subs4 <- car::recode(CHARLS_wealth$elderly_subs4, "0=NA")

CHARLS_wealth$elderly_subs5 <- CHARLS_wealth$ga008_5b_5_
CHARLS_wealth$elderly_subs5[is.na(CHARLS_wealth$elderly_subs5)] <- CHARLS_wealth$ga008_5c_5_[is.na(CHARLS_wealth$elderly_subs5)]*12
CHARLS_wealth$elderly_subs5 <- car::recode(CHARLS_wealth$elderly_subs5, "0=NA")

CHARLS_wealth$elderly_subs6 <- CHARLS_wealth$ga008_5b_6_
CHARLS_wealth$elderly_subs6[is.na(CHARLS_wealth$elderly_subs6)] <- CHARLS_wealth$ga008_5c_6_[is.na(CHARLS_wealth$elderly_subs6)]*12
CHARLS_wealth$elderly_subs6 <- car::recode(CHARLS_wealth$elderly_subs6, "0=NA")

CHARLS_wealth$elderly_subs7 <- CHARLS_wealth$ga008_5b_7_
CHARLS_wealth$elderly_subs7[is.na(CHARLS_wealth$elderly_subs7)] <- CHARLS_wealth$ga008_5c_7_[is.na(CHARLS_wealth$elderly_subs7)]*12
CHARLS_wealth$elderly_subs7 <- car::recode(CHARLS_wealth$elderly_subs7, "0=NA")

CHARLS_wealth$elderly_subs8 <- CHARLS_wealth$ga008_5b_8_
CHARLS_wealth$elderly_subs8[is.na(CHARLS_wealth$elderly_subs8)] <- CHARLS_wealth$ga008_5c_8_[is.na(CHARLS_wealth$elderly_subs8)]*12
CHARLS_wealth$elderly_subs8 <- car::recode(CHARLS_wealth$elderly_subs8, "0=NA")

CHARLS_wealth$elderly_subs9 <- CHARLS_wealth$ga008_5b_9_
CHARLS_wealth$elderly_subs9[is.na(CHARLS_wealth$elderly_subs9)] <- CHARLS_wealth$ga008_5c_9_[is.na(CHARLS_wealth$elderly_subs9)]*12
CHARLS_wealth$elderly_subs9 <- car::recode(CHARLS_wealth$elderly_subs9, "0=NA")

CHARLS_wealth$elderly_subs10 <- CHARLS_wealth$ga008_5b_10_
CHARLS_wealth$elderly_subs10[is.na(CHARLS_wealth$elderly_subs10)] <- CHARLS_wealth$ga008_5c_10_[is.na(CHARLS_wealth$elderly_subs10)]*12
CHARLS_wealth$elderly_subs10 <- car::recode(CHARLS_wealth$elderly_subs10, "0=NA")

CHARLS_wealth$elderly_subs11 <- CHARLS_wealth$ga008_5b_11_
CHARLS_wealth$elderly_subs11[is.na(CHARLS_wealth$elderly_subs11)] <- CHARLS_wealth$ga008_5c_11_[is.na(CHARLS_wealth$elderly_subs11)]*12
CHARLS_wealth$elderly_subs11 <- car::recode(CHARLS_wealth$elderly_subs11, "0=NA")

CHARLS_wealth$elderly_subs12 <- CHARLS_wealth$ga008_5b_12_
CHARLS_wealth$elderly_subs12[is.na(CHARLS_wealth$elderly_subs12)] <- CHARLS_wealth$ga008_5c_1_[is.na(CHARLS_wealth$elderly_subs12)]*12
CHARLS_wealth$ga008_5c_12_ <- car::recode(CHARLS_wealth$elderly_subs12, "0=NA")

CHARLS_wealth$elderly_subs <- apply(select(CHARLS_wealth, elderly_subs1, elderly_subs2, elderly_subs3, elderly_subs4, elderly_subs5, elderly_subs6, elderly_subs7, elderly_subs8, elderly_subs9, elderly_subs10, elderly_subs11, elderly_subs12), MARGIN = 1, FUN = function(x) sum(x, na.rm = TRUE))
CHARLS_wealth$elderly_subs <- car::recode(CHARLS_wealth$elderly_subs, "0=NA")

CHARLS_wealth$medical_aid1 <- CHARLS_wealth$ga008_6b_1_
CHARLS_wealth$medical_aid1[is.na(CHARLS_wealth$medical_aid1)] <- CHARLS_wealth$ga008_6c_1_[is.na(CHARLS_wealth$medical_aid1)]*12
CHARLS_wealth$medical_aid1 <- car::recode(CHARLS_wealth$medical_aid1, "0=NA")

CHARLS_wealth$medical_aid2 <- CHARLS_wealth$ga008_6b_2_
CHARLS_wealth$medical_aid2[is.na(CHARLS_wealth$medical_aid2)] <- CHARLS_wealth$ga008_6c_2_[is.na(CHARLS_wealth$medical_aid2)]*12
CHARLS_wealth$medical_aid2 <- car::recode(CHARLS_wealth$medical_aid2, "0=NA")

CHARLS_wealth$medical_aid3 <- CHARLS_wealth$ga008_6b_3_
CHARLS_wealth$medical_aid3[is.na(CHARLS_wealth$medical_aid3)] <- CHARLS_wealth$ga008_6c_3_[is.na(CHARLS_wealth$medical_aid3)]*12
CHARLS_wealth$medical_aid3 <- car::recode(CHARLS_wealth$medical_aid3, "0=NA")

CHARLS_wealth$medical_aid4 <- CHARLS_wealth$ga008_6b_4_
CHARLS_wealth$medical_aid4[is.na(CHARLS_wealth$medical_aid4)] <- CHARLS_wealth$ga008_6c_4_[is.na(CHARLS_wealth$medical_aid4)]*12
CHARLS_wealth$medical_aid4 <- car::recode(CHARLS_wealth$medical_aid4, "0=NA")

CHARLS_wealth$medical_aid5 <- CHARLS_wealth$ga008_6b_5_
CHARLS_wealth$medical_aid5[is.na(CHARLS_wealth$medical_aid5)] <- CHARLS_wealth$ga008_6c_5_[is.na(CHARLS_wealth$medical_aid5)]*12
CHARLS_wealth$medical_aid5 <- car::recode(CHARLS_wealth$medical_aid5, "0=NA")

CHARLS_wealth$medical_aid6 <- CHARLS_wealth$ga008_6b_6_
CHARLS_wealth$medical_aid6[is.na(CHARLS_wealth$medical_aid6)] <- CHARLS_wealth$ga008_6c_6_[is.na(CHARLS_wealth$medical_aid6)]*12
CHARLS_wealth$medical_aid6 <- car::recode(CHARLS_wealth$medical_aid6, "0=NA")

CHARLS_wealth$medical_aid7 <- CHARLS_wealth$ga008_6b_7_
CHARLS_wealth$medical_aid7[is.na(CHARLS_wealth$medical_aid7)] <- CHARLS_wealth$ga008_6c_7_[is.na(CHARLS_wealth$medical_aid7)]*12
CHARLS_wealth$medical_aid7 <- car::recode(CHARLS_wealth$medical_aid7, "0=NA")

CHARLS_wealth$medical_aid8 <- CHARLS_wealth$ga008_6b_8_
CHARLS_wealth$medical_aid8[is.na(CHARLS_wealth$medical_aid8)] <- CHARLS_wealth$ga008_6c_8_[is.na(CHARLS_wealth$medical_aid8)]*12
CHARLS_wealth$medical_aid8 <- car::recode(CHARLS_wealth$medical_aid8, "0=NA")

CHARLS_wealth$medical_aid9 <- CHARLS_wealth$ga008_6b_9_
CHARLS_wealth$medical_aid9[is.na(CHARLS_wealth$medical_aid9)] <- CHARLS_wealth$ga008_6c_9_[is.na(CHARLS_wealth$medical_aid9)]*12
CHARLS_wealth$medical_aid9 <- car::recode(CHARLS_wealth$medical_aid9, "0=NA")

CHARLS_wealth$medical_aid10 <- CHARLS_wealth$ga008_6b_10_
CHARLS_wealth$medical_aid10[is.na(CHARLS_wealth$medical_aid10)] <- CHARLS_wealth$ga008_6c_10_[is.na(CHARLS_wealth$medical_aid10)]*12
CHARLS_wealth$medical_aid10 <- car::recode(CHARLS_wealth$medical_aid10, "0=NA")

CHARLS_wealth$medical_aid11 <- CHARLS_wealth$ga008_6b_11_
CHARLS_wealth$medical_aid11[is.na(CHARLS_wealth$medical_aid11)] <- CHARLS_wealth$ga008_6c_11_[is.na(CHARLS_wealth$medical_aid11)]*12
CHARLS_wealth$medical_aid11 <- car::recode(CHARLS_wealth$medical_aid11, "0=NA")

CHARLS_wealth$medical_aid12 <- CHARLS_wealth$ga008_6b_12_
CHARLS_wealth$medical_aid12[is.na(CHARLS_wealth$medical_aid12)] <- CHARLS_wealth$ga008_6c_1_[is.na(CHARLS_wealth$medical_aid12)]*12
CHARLS_wealth$ga008_6c_12_ <- car::recode(CHARLS_wealth$medical_aid12, "0=NA")

CHARLS_wealth$medical_aid <- apply(select(CHARLS_wealth, medical_aid1, medical_aid2, medical_aid3, medical_aid4, medical_aid5, medical_aid6, medical_aid7, medical_aid8, medical_aid9, medical_aid10, medical_aid11, medical_aid12), MARGIN = 1, FUN = function(x) sum(x, na.rm = TRUE))
CHARLS_wealth$medical_aid <- car::recode(CHARLS_wealth$medical_aid, "0=NA")

CHARLS_wealth$gov_sub1 <- CHARLS_wealth$ga008_7b_1_
CHARLS_wealth$gov_sub1[is.na(CHARLS_wealth$gov_sub1)] <- CHARLS_wealth$ga008_7c_1_[is.na(CHARLS_wealth$gov_sub1)]*12
CHARLS_wealth$gov_sub1 <- car::recode(CHARLS_wealth$gov_sub1, "0=NA")

CHARLS_wealth$gov_sub2 <- CHARLS_wealth$ga008_7b_2_
CHARLS_wealth$gov_sub2[is.na(CHARLS_wealth$gov_sub2)] <- CHARLS_wealth$ga008_7c_2_[is.na(CHARLS_wealth$gov_sub2)]*12
CHARLS_wealth$gov_sub2 <- car::recode(CHARLS_wealth$gov_sub2, "0=NA")

CHARLS_wealth$gov_sub3 <- CHARLS_wealth$ga008_7b_3_
CHARLS_wealth$gov_sub3[is.na(CHARLS_wealth$gov_sub3)] <- CHARLS_wealth$ga008_7c_3_[is.na(CHARLS_wealth$gov_sub3)]*12
CHARLS_wealth$gov_sub3 <- car::recode(CHARLS_wealth$gov_sub3, "0=NA")

CHARLS_wealth$gov_sub4 <- CHARLS_wealth$ga008_7b_4_
CHARLS_wealth$gov_sub4[is.na(CHARLS_wealth$gov_sub4)] <- CHARLS_wealth$ga008_7c_4_[is.na(CHARLS_wealth$gov_sub4)]*12
CHARLS_wealth$gov_sub4 <- car::recode(CHARLS_wealth$gov_sub4, "0=NA")

CHARLS_wealth$gov_sub5 <- CHARLS_wealth$ga008_7b_5_
CHARLS_wealth$gov_sub5[is.na(CHARLS_wealth$gov_sub5)] <- CHARLS_wealth$ga008_7c_5_[is.na(CHARLS_wealth$gov_sub5)]*12
CHARLS_wealth$gov_sub5 <- car::recode(CHARLS_wealth$gov_sub5, "0=NA")

CHARLS_wealth$gov_sub6 <- CHARLS_wealth$ga008_7b_6_
CHARLS_wealth$gov_sub6[is.na(CHARLS_wealth$gov_sub6)] <- CHARLS_wealth$ga008_7c_6_[is.na(CHARLS_wealth$gov_sub6)]*12
CHARLS_wealth$gov_sub6 <- car::recode(CHARLS_wealth$gov_sub6, "0=NA")

CHARLS_wealth$gov_sub7 <- CHARLS_wealth$ga008_7b_7_
CHARLS_wealth$gov_sub7[is.na(CHARLS_wealth$gov_sub7)] <- CHARLS_wealth$ga008_7c_7_[is.na(CHARLS_wealth$gov_sub7)]*12
CHARLS_wealth$gov_sub7 <- car::recode(CHARLS_wealth$gov_sub7, "0=NA")

CHARLS_wealth$gov_sub8 <- CHARLS_wealth$ga008_7b_8_
CHARLS_wealth$gov_sub8[is.na(CHARLS_wealth$gov_sub8)] <- CHARLS_wealth$ga008_7c_8_[is.na(CHARLS_wealth$gov_sub8)]*12
CHARLS_wealth$gov_sub8 <- car::recode(CHARLS_wealth$gov_sub8, "0=NA")

CHARLS_wealth$gov_sub9 <- CHARLS_wealth$ga008_7b_9_
CHARLS_wealth$gov_sub9[is.na(CHARLS_wealth$gov_sub9)] <- CHARLS_wealth$ga008_7c_9_[is.na(CHARLS_wealth$gov_sub9)]*12
CHARLS_wealth$gov_sub9 <- car::recode(CHARLS_wealth$gov_sub9, "0=NA")

CHARLS_wealth$gov_sub10 <- CHARLS_wealth$ga008_7b_10_
CHARLS_wealth$gov_sub10[is.na(CHARLS_wealth$gov_sub10)] <- CHARLS_wealth$ga008_7c_10_[is.na(CHARLS_wealth$gov_sub10)]*12
CHARLS_wealth$gov_sub10 <- car::recode(CHARLS_wealth$gov_sub10, "0=NA")

CHARLS_wealth$gov_sub11 <- CHARLS_wealth$ga008_7b_11_
CHARLS_wealth$gov_sub11[is.na(CHARLS_wealth$gov_sub11)] <- CHARLS_wealth$ga008_7c_11_[is.na(CHARLS_wealth$gov_sub11)]*12
CHARLS_wealth$gov_sub11 <- car::recode(CHARLS_wealth$gov_sub11, "0=NA")

CHARLS_wealth$gov_sub12 <- CHARLS_wealth$ga008_7b_12_
CHARLS_wealth$gov_sub12[is.na(CHARLS_wealth$gov_sub12)] <- CHARLS_wealth$ga008_7c_1_[is.na(CHARLS_wealth$gov_sub12)]*12
CHARLS_wealth$ga008_7c_12_ <- car::recode(CHARLS_wealth$gov_sub12, "0=NA")

CHARLS_wealth$gov_sub <- apply(select(CHARLS_wealth, gov_sub1, gov_sub2, gov_sub3, gov_sub4, gov_sub5, gov_sub6, gov_sub7, gov_sub8, gov_sub9, gov_sub10, gov_sub11, gov_sub12), MARGIN = 1, FUN = function(x) sum(x, na.rm = TRUE))
CHARLS_wealth$gov_sub <- car::recode(CHARLS_wealth$gov_sub, "0=NA")

CHARLS_wealth$social_assis1 <- CHARLS_wealth$ga008_8b_1_
CHARLS_wealth$social_assis1[is.na(CHARLS_wealth$social_assis1)] <- CHARLS_wealth$ga008_8c_1_[is.na(CHARLS_wealth$social_assis1)]*12
CHARLS_wealth$social_assis1 <- car::recode(CHARLS_wealth$social_assis1, "0=NA")

CHARLS_wealth$social_assis2 <- CHARLS_wealth$ga008_8b_2_
CHARLS_wealth$social_assis2[is.na(CHARLS_wealth$social_assis2)] <- CHARLS_wealth$ga008_8c_2_[is.na(CHARLS_wealth$social_assis2)]*12
CHARLS_wealth$social_assis2 <- car::recode(CHARLS_wealth$social_assis2, "0=NA")

CHARLS_wealth$social_assis3 <- CHARLS_wealth$ga008_8b_3_
CHARLS_wealth$social_assis3[is.na(CHARLS_wealth$social_assis3)] <- CHARLS_wealth$ga008_8c_3_[is.na(CHARLS_wealth$social_assis3)]*12
CHARLS_wealth$social_assis3 <- car::recode(CHARLS_wealth$social_assis3, "0=NA")

CHARLS_wealth$social_assis4 <- CHARLS_wealth$ga008_8b_4_
CHARLS_wealth$social_assis4[is.na(CHARLS_wealth$social_assis4)] <- CHARLS_wealth$ga008_8c_4_[is.na(CHARLS_wealth$social_assis4)]*12
CHARLS_wealth$social_assis4 <- car::recode(CHARLS_wealth$social_assis4, "0=NA")

CHARLS_wealth$social_assis5 <- CHARLS_wealth$ga008_8b_5_
CHARLS_wealth$social_assis5[is.na(CHARLS_wealth$social_assis5)] <- CHARLS_wealth$ga008_8c_5_[is.na(CHARLS_wealth$social_assis5)]*12
CHARLS_wealth$social_assis5 <- car::recode(CHARLS_wealth$social_assis5, "0=NA")

CHARLS_wealth$social_assis6 <- CHARLS_wealth$ga008_8b_6_
CHARLS_wealth$social_assis6[is.na(CHARLS_wealth$social_assis6)] <- CHARLS_wealth$ga008_8c_6_[is.na(CHARLS_wealth$social_assis6)]*12
CHARLS_wealth$social_assis6 <- car::recode(CHARLS_wealth$social_assis6, "0=NA")

CHARLS_wealth$social_assis7 <- CHARLS_wealth$ga008_8b_7_
CHARLS_wealth$social_assis7[is.na(CHARLS_wealth$social_assis7)] <- CHARLS_wealth$ga008_8c_7_[is.na(CHARLS_wealth$social_assis7)]*12
CHARLS_wealth$social_assis7 <- car::recode(CHARLS_wealth$social_assis7, "0=NA")

CHARLS_wealth$social_assis8 <- CHARLS_wealth$ga008_8b_8_
CHARLS_wealth$social_assis8[is.na(CHARLS_wealth$social_assis8)] <- CHARLS_wealth$ga008_8c_8_[is.na(CHARLS_wealth$social_assis8)]*12
CHARLS_wealth$social_assis8 <- car::recode(CHARLS_wealth$social_assis8, "0=NA")

CHARLS_wealth$social_assis9 <- CHARLS_wealth$ga008_8b_9_
CHARLS_wealth$social_assis9[is.na(CHARLS_wealth$social_assis9)] <- CHARLS_wealth$ga008_8c_9_[is.na(CHARLS_wealth$social_assis9)]*12
CHARLS_wealth$social_assis9 <- car::recode(CHARLS_wealth$social_assis9, "0=NA")

CHARLS_wealth$social_assis10 <- CHARLS_wealth$ga008_8b_10_
CHARLS_wealth$social_assis10[is.na(CHARLS_wealth$social_assis10)] <- CHARLS_wealth$ga008_8c_10_[is.na(CHARLS_wealth$social_assis10)]*12
CHARLS_wealth$social_assis10 <- car::recode(CHARLS_wealth$social_assis10, "0=NA")

CHARLS_wealth$social_assis11 <- CHARLS_wealth$ga008_8b_11_
CHARLS_wealth$social_assis11[is.na(CHARLS_wealth$social_assis11)] <- CHARLS_wealth$ga008_8c_11_[is.na(CHARLS_wealth$social_assis11)]*12
CHARLS_wealth$social_assis11 <- car::recode(CHARLS_wealth$social_assis11, "0=NA")

CHARLS_wealth$social_assis12 <- CHARLS_wealth$ga008_8b_12_
CHARLS_wealth$social_assis12[is.na(CHARLS_wealth$social_assis12)] <- CHARLS_wealth$ga008_8c_1_[is.na(CHARLS_wealth$social_assis12)]*12
CHARLS_wealth$ga008_8c_12_ <- car::recode(CHARLS_wealth$social_assis12, "0=NA")

CHARLS_wealth$social_assis <- apply(select(CHARLS_wealth, social_assis1, social_assis2, social_assis3, social_assis4, social_assis5, social_assis6, social_assis7, social_assis8, social_assis9, social_assis10, social_assis11, social_assis12), MARGIN = 1, FUN = function(x) sum(x, na.rm = TRUE))
CHARLS_wealth$social_assis <- car::recode(CHARLS_wealth$social_assis, "0=NA")

CHARLS_wealth$other1 <- CHARLS_wealth$ga008_9b_1_
CHARLS_wealth$other1[is.na(CHARLS_wealth$other1)] <- CHARLS_wealth$ga008_9c_1_[is.na(CHARLS_wealth$other1)]*12
CHARLS_wealth$other1 <- car::recode(CHARLS_wealth$other1, "0=NA")

CHARLS_wealth$other2 <- CHARLS_wealth$ga008_9b_2_
CHARLS_wealth$other2[is.na(CHARLS_wealth$other2)] <- CHARLS_wealth$ga008_9c_2_[is.na(CHARLS_wealth$other2)]*12
CHARLS_wealth$other2 <- car::recode(CHARLS_wealth$other2, "0=NA")

CHARLS_wealth$other3 <- CHARLS_wealth$ga008_9b_3_
CHARLS_wealth$other3[is.na(CHARLS_wealth$other3)] <- CHARLS_wealth$ga008_9c_3_[is.na(CHARLS_wealth$other3)]*12
CHARLS_wealth$other3 <- car::recode(CHARLS_wealth$other3, "0=NA")

CHARLS_wealth$other4 <- CHARLS_wealth$ga008_9b_4_
CHARLS_wealth$other4[is.na(CHARLS_wealth$other4)] <- CHARLS_wealth$ga008_9c_4_[is.na(CHARLS_wealth$other4)]*12
CHARLS_wealth$other4 <- car::recode(CHARLS_wealth$other4, "0=NA")

CHARLS_wealth$other5 <- CHARLS_wealth$ga008_9b_5_
CHARLS_wealth$other5[is.na(CHARLS_wealth$other5)] <- CHARLS_wealth$ga008_9c_5_[is.na(CHARLS_wealth$other5)]*12
CHARLS_wealth$other5 <- car::recode(CHARLS_wealth$other5, "0=NA")

CHARLS_wealth$other6 <- CHARLS_wealth$ga008_9b_6_
CHARLS_wealth$other6[is.na(CHARLS_wealth$other6)] <- CHARLS_wealth$ga008_9c_6_[is.na(CHARLS_wealth$other6)]*12
CHARLS_wealth$other6 <- car::recode(CHARLS_wealth$other6, "0=NA")

CHARLS_wealth$other7 <- CHARLS_wealth$ga008_9b_7_
CHARLS_wealth$other7[is.na(CHARLS_wealth$other7)] <- CHARLS_wealth$ga008_9c_7_[is.na(CHARLS_wealth$other7)]*12
CHARLS_wealth$other7 <- car::recode(CHARLS_wealth$other7, "0=NA")

CHARLS_wealth$other8 <- CHARLS_wealth$ga008_9b_8_
CHARLS_wealth$other8[is.na(CHARLS_wealth$other8)] <- CHARLS_wealth$ga008_9c_8_[is.na(CHARLS_wealth$other8)]*12
CHARLS_wealth$other8 <- car::recode(CHARLS_wealth$other8, "0=NA")

CHARLS_wealth$other9 <- CHARLS_wealth$ga008_9b_9_
CHARLS_wealth$other9[is.na(CHARLS_wealth$other9)] <- CHARLS_wealth$ga008_9c_9_[is.na(CHARLS_wealth$other9)]*12
CHARLS_wealth$other9 <- car::recode(CHARLS_wealth$other9, "0=NA")

CHARLS_wealth$other10 <- CHARLS_wealth$ga008_9b_10_
CHARLS_wealth$other10[is.na(CHARLS_wealth$other10)] <- CHARLS_wealth$ga008_9c_10_[is.na(CHARLS_wealth$other10)]*12
CHARLS_wealth$other10 <- car::recode(CHARLS_wealth$other10, "0=NA")

CHARLS_wealth$other11 <- CHARLS_wealth$ga008_9b_11_
CHARLS_wealth$other11[is.na(CHARLS_wealth$other11)] <- CHARLS_wealth$ga008_9c_11_[is.na(CHARLS_wealth$other11)]*12
CHARLS_wealth$other11 <- car::recode(CHARLS_wealth$other11, "0=NA")

CHARLS_wealth$other12 <- CHARLS_wealth$ga008_9b_12_
CHARLS_wealth$other12[is.na(CHARLS_wealth$other12)] <- CHARLS_wealth$ga008_9c_1_[is.na(CHARLS_wealth$other12)]*12
CHARLS_wealth$ga008_9c_12_ <- car::recode(CHARLS_wealth$other12, "0=NA")

CHARLS_wealth$other <- apply(select(CHARLS_wealth, other1, other2, other3, other4, other5, other6, other7, other8, other9, other10, other11, other12), MARGIN = 1, FUN = function(x) sum(x, na.rm = TRUE))
CHARLS_wealth$other <- car::recode(CHARLS_wealth$other, "0=NA")

CHARLS_wealth$gb005_bracket_min <- car::recode(CHARLS_wealth$gb005_bracket_min, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$gb005_bracket_max <- car::recode(CHARLS_wealth$gb005_bracket_max, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$crops_forestry <- CHARLS_wealth$gb005_1
CHARLS_wealth$crops_forestry[is.na(CHARLS_wealth$crops_forestry)] <- apply(select(CHARLS_wealth, gb005_bracket_min, gb005_bracket_max)[is.na(CHARLS_wealth$crops_forestry),], MARGIN = 1, FUN = function(x) x[1]+((x[2]-x[1])/2) )
CHARLS_wealth$crops_forestry <- car::recode(CHARLS_wealth$crops_forestry, "0=NA")

CHARLS_wealth$gb009_bracket_min <- car::recode(CHARLS_wealth$gb009_bracket_min, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$gb009_bracket_max <- car::recode(CHARLS_wealth$gb009_bracket_max, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$livestock1 <- CHARLS_wealth$gb009
CHARLS_wealth$livestock1[is.na(CHARLS_wealth$livestock1)] <- apply(select(CHARLS_wealth, gb009_bracket_min, gb009_bracket_max)[is.na(CHARLS_wealth$livestock1),], MARGIN = 1, FUN = function(x) x[1]+((x[2]-x[1])/2) )
CHARLS_wealth$livestock1 <- car::recode(CHARLS_wealth$livestock1, "0=NA")

CHARLS_wealth$gb011_bracket_min <- car::recode(CHARLS_wealth$gb011_bracket_min, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$gb011_bracket_max <- car::recode(CHARLS_wealth$gb011_bracket_max, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$livestock2 <- CHARLS_wealth$gb011_1
CHARLS_wealth$livestock2[is.na(CHARLS_wealth$livestock2)] <- apply(select(CHARLS_wealth, gb011_bracket_min, gb011_bracket_max)[is.na(CHARLS_wealth$livestock2),], MARGIN = 1, FUN = function(x) x[1]+((x[2]-x[1])/2) )
CHARLS_wealth$livestock2 <- car::recode(CHARLS_wealth$livestock2, "0=NA")

CHARLS_wealth$gb012_bracket_min <- car::recode(CHARLS_wealth$gb012_bracket_min, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$gb012_bracket_max <- car::recode(CHARLS_wealth$gb012_bracket_max, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$livestock3 <- CHARLS_wealth$gb012_1
CHARLS_wealth$livestock3[is.na(CHARLS_wealth$livestock3)] <- apply(select(CHARLS_wealth, gb012_bracket_min, gb012_bracket_max)[is.na(CHARLS_wealth$livestock3),], MARGIN = 1, FUN = function(x) x[1]+((x[2]-x[1])/2) )
CHARLS_wealth$livestock3 <- car::recode(CHARLS_wealth$livestock3, "0=NA")

CHARLS_wealth$livestock <- apply(select(CHARLS_wealth, livestock1, livestock2, livestock3), MARGIN = 1, FUN = function(x) sum(x, na.rm = TRUE))
CHARLS_wealth$livestock <- car::recode(CHARLS_wealth$livestock, "0=NA")


CHARLS_wealth$gc005_bracket_1_min <- car::recode(CHARLS_wealth$gc005_bracket_1_min, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$gc005_bracket_1_max <- car::recode(CHARLS_wealth$gc005_bracket_1_max, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$activity1 <- CHARLS_wealth$gc005_1_
CHARLS_wealth$activity1[is.na(CHARLS_wealth$activity1)] <- apply(select(CHARLS_wealth, gc005_bracket_1_min, gc005_bracket_1_max)[is.na(CHARLS_wealth$activity1),], MARGIN = 1, FUN = function(x) x[1]+((x[2]-x[1])/2) )
CHARLS_wealth$activity1 <- car::recode(CHARLS_wealth$activity1, "0=NA")

CHARLS_wealth$gc005_bracket_2_min <- car::recode(CHARLS_wealth$gc005_bracket_2_min, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$gc005_bracket_2_max <- car::recode(CHARLS_wealth$gc005_bracket_2_max, "0 = NA; 9999=NA; 99999996=NA")
CHARLS_wealth$activity2 <- CHARLS_wealth$gc005_2_
CHARLS_wealth$activity2[is.na(CHARLS_wealth$activity2)] <- apply(select(CHARLS_wealth, gc005_bracket_2_min, gc005_bracket_2_max)[is.na(CHARLS_wealth$activity2),], MARGIN = 1, FUN = function(x) x[1]+((x[2]-x[1])/2) )
CHARLS_wealth$activity2 <- car::recode(CHARLS_wealth$activity2, "0=NA")

CHARLS_wealth$activity <- apply(select(CHARLS_wealth, activity1, activity2, gc005_3_, gc005_4_), MARGIN = 1, FUN = function(x) sum(x, na.rm = TRUE))
CHARLS_wealth$activity <- car::recode(CHARLS_wealth$activity, "0=NA")

CHARLS_wealth$govern_subs <- apply(select(CHARLS_wealth, gd002_1, gd002_2, gd002_3, gd002_4, gd002_5, gd002_6, gd002_7), MARGIN = 1, FUN = function(x) sum(x, na.rm = TRUE))
CHARLS_wealth$govern_subs <- car::recode(CHARLS_wealth$govern_subs, "0=NA")

CHARLS_wealth$ha052_1 <- CHARLS_wealth$ha052_1*12
CHARLS_wealth$ha053_1 <- CHARLS_wealth$ha053_1*12
CHARLS_wealth$rental_lent <- apply(select(CHARLS_wealth, ha052_1, ha053_1, ha060_1_, ha060_2_, ha060_3_, ha060_4_, ha064_1, ha071), MARGIN = 1, FUN = function(x) sum(x, na.rm = TRUE))
CHARLS_wealth$rental_lent <- car::recode(CHARLS_wealth$rental_lent, "0=NA")
```

```{r local2, echo=F}
vari <- CHARLS_wealth$recive
kable(Continuous_summary(vari, missing_values = NA)[3], caption = "recive") 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- CHARLS_wealth$ind_inc
kable(Continuous_summary(vari, missing_values = NA)[3], caption = "ind_inc") 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- CHARLS_wealth$salary
kable(Continuous_summary(vari, missing_values = NA)[3], caption = "ind_inc") 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- CHARLS_wealth$pension
kable(Continuous_summary(vari, missing_values = NA)[3], caption = "pension") 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- CHARLS_wealth$unemploy
kable(Continuous_summary(vari, missing_values = NA)[3], caption = "unemploy") 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- CHARLS_wealth$pension_sub
kable(Continuous_summary(vari, missing_values = NA)[3], caption = "pension_sub") 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- CHARLS_wealth$accid_compe
kable(Continuous_summary(vari, missing_values = NA)[3], caption = "accid_compe") 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- CHARLS_wealth$elderly_subs
kable(Continuous_summary(vari, missing_values = NA)[3], caption = "elderly_subs") 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- CHARLS_wealth$medical_aid
kable(Continuous_summary(vari, missing_values = NA)[3], caption = "medical_aid") 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- CHARLS_wealth$gov_sub
kable(Continuous_summary(vari, missing_values = NA)[3], caption = "gov_sub") 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- CHARLS_wealth$social_assis
kable(Continuous_summary(vari, missing_values = NA)[3], caption = "social_assis") 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- CHARLS_wealth$other
kable(Continuous_summary(vari, missing_values = NA)[3], caption = "other") 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- CHARLS_wealth$crops_forestry
kable(Continuous_summary(vari, missing_values = NA)[3], caption = "crops_forestry") 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- CHARLS_wealth$livestock
kable(Continuous_summary(vari, missing_values = NA)[3], caption = "livestock") 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- CHARLS_wealth$activity
kable(Continuous_summary(vari, missing_values = NA)[3], caption = "activity") 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- CHARLS_wealth$gd001
kable(Continuous_summary(vari, missing_values = NA)[3], caption = "gd001") 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- CHARLS_wealth$govern_subs
kable(Continuous_summary(vari, missing_values = NA)[3], caption = "govern_subs") 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- CHARLS_wealth$rental_lent
kable(Continuous_summary(vari, missing_values = NA)[3], caption = "rental_lent") 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- CHARLS_wealth$hc024
kable(Continuous_summary(vari, missing_values = NA)[3], caption = "hc024") 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
```



#### Harmonisation algorithm
To compute the harmonized variable from the study specific varibale sum up all the variables and divide the population into 5 groups each containing 20$\%$ of the corresponding N and the missing values have to be recoded as follows: 

* `NA into 999`


**R script:**

```{r harmo2}
CHARLS_wealth$sum <- apply(X = select(CHARLS_wealth, recive, ind_inc, salary, pension, unemploy, pension_sub, accid_compe, elderly_subs, medical_aid, gov_sub, social_assis, other, crops_forestry, livestock, activity, gd001, govern_subs, rental_lent, hc024), MARGIN = 1, FUN = function(x) sum(as.numeric(x), na.rm = TRUE))
CHARLS_wealth$sum <- car::recode(CHARLS_wealth$sum, "0=NA")

qq <- quantile(CHARLS_wealth$sum, probs = seq(0, 1, .2), na.rm = TRUE)

CHARLS_ds_w2 <- tibble(id=CHARLS_wealth$id)
CHARLS_ds_w2$wealth <- car::recode(CHARLS_wealth$sum, "0:qq[2]=1; (qq[2]+1):qq[3]=2; (qq[3]+1):qq[4]=3; (qq[4]+1):qq[5]=4; (qq[5]+1):hi=5")
CHARLS_ds_w2$wealth <- car::recode(CHARLS_ds_w2$wealth, "NA=999")
CHARLS_ds_w2$wealth <- as.integer(CHARLS_ds_w2$wealth)
CHARLS_ds_w2$wealth <- labelled(CHARLS_ds_w2$wealth, labels = c("Missing"=999, "Do not know"=998, "Refuse"=997, "Not applicable"=996, "Does not answer"=995,  "Not attempt not done"=994, "Disable to measure"=993, "Impute"=992, "CAPI interviewer error"=991))
```

#### Statistics of the new harmonised variable
```{r descript2, echo=F}
vari <- CHARLS_ds_w2$wealth
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[3], caption = ds_label) 
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[2], caption = "Type of missing")
ggplot(CHARLS_ds_w2, aes(x=factor(wealth))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab(ds_label) + ylab("Frequency")
```

#### Validation
```{r crosstabulation2, echo=F}
```





# Quality estimation
This study includes income sources that other studies did not take into account, however, 
we didn't consider to leave these out because for cultural reasons, these might be important for the household total income while the usual 
sources might not be as important in the chinese society. 
In any case, because of the section complexity in this study, and the cultural understanding of the questions,
we would recommend to wait for the derived variable that the CHARLS study responsables will provide in order 
to have a less biased computation of the final variable.
The variable we calculated was based in the respondent's + spouse's incom from the following sources: Paid Work 
+ Self-Employment + Livestock  and aquatic life + Crops and forestry + Private pension + Public pension and government subsidies 
+ Assets + Investments and rental income.



```{r save, echo=FALSE}
wealth <- CHARLS_ds_w1
save(wealth, file = "../RData/w1/wealth.RData")
rm(wealth)

wealth <- CHARLS_ds_w2
save(wealth, file = "../RData/w2/wealth.RData")
rm(wealth)
```

```{r closeRsession, echo=FALSE}
opal.logout(o)
```
