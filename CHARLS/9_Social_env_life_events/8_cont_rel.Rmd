---
title: "Are any form of contact ( face-to-face/phone/mail/Internet communicators) with family members/relatives frequent (i.e. contact once a week or more often)?"
output:
  html_document:
    highlight: tango
    number_sections: yes
    theme: united
    toc: yes
    toc_depth: 6
    toc_float:
      collapsed: yes
      smooth_scroll: yes
---

<!-- ########################################################## --> 

<!-- # Installation, loading packages -->
<!-- **R script:** -->

```{r setup, include=FALSE}
source("M:/WPs/WP1/Maelstrom/data_process/athlos-project.github.io/setup_ania.r")
source("M:/WPs/WP1/Maelstrom/data_process/athlos-project.github.io/CHARLS/9_Social_env_life_events/CHARLS_ids.r")

```

<!-- ########################################################## --> 



# Description of DataSchema variable

The description of harmonised variables is the following:

* Short name: `cont_rel`
* Variable label: `Are any form of contact ( face-to-face/phone/mail/Internet communicators) with family members/relatives frequent (i.e. contact once a week or more often)?`
* Domain: `Social environment`
* Value type: `cathegorical`
* Categories:

**Code** | **Category Label**
-------- | ------------------
0        | No
1        | Yes


* Category missings: 

**Code** | **Category Label**
----| ------------------
991 | CAPI/interviewer error
992 | Impute
993 | Disable to measure
994 | Not attempt/not done
995 | Does not answer
996 | Not applicable
997 | Refuse
998 | Do not know
999 | Missing


<!-- ########################################################## --> 

# Data process

## China (All counties with the exception of Tibet)
### Wave 1 

#### Study-specific variables

The study-specific variables elected to be harmonised are:

* Name: `cd002_1_` till `cd002_9_`
* Label: `How Often do You/Your Spouse See Your Parent`
* Categories:
    + `1 = Almost every day`
    + `2 = 2-3 times a week`
    + `3 = Once a week`
    + `4 = Every two weeks`
    + `5 = Once a month`
    + `6 = Once every three months`
    + `7 = Once every six months`
    + `8 = Once a year`
    + `9 = Almost never`
    + `10 = Other`
    
* Name: `cd003_1_` till `cd003_14_`
* Label: `How Often do See Child`
* Categories:
    + `1 = Almost every day`
    + `2 = 2-3 times a week`
    + `3 = Once a week`
    + `4 = Every two weeks`
    + `5 = Once a month`
    + `6 = Once every three months`
    + `7 = Once every six months`
    + `8 = Once a year`
    + `9 = Almost never`
    + `10 = Other`

* Name: `a006_1_` UP TO `a006_16_` *from the table "household_roster_wave1"*
* Label: `Relationship to FamilyR`
* Categories:
    * `1 = Mother`
    * `2 = Father`
    * `3 = Mother-in-law`
    * `4 = Father-in-law`
    * `5 = Sibling`
    * `6 = Brother-in-law, sister-in-law`
    * `7 = Child`
    * `8 = Spouse of child`
    * `9 = Grandchild`
    * `10 = Other relative specify`


* Description: 
```{r assign1}
opal.assign.table.tibble(o, 'CHARLS_w1_cont_rel1','CHARLS.family_information_wave1', 
                        variables=list('cd002_1_', 'cd002_2_', 'cd002_3_', 'cd002_4_', 'cd002_5_', 'cd002_6_', 'cd002_7_', 'cd002_8_', 'cd002_9_', 'cd003_1_', 'cd003_2_', 'cd003_3_', 'cd003_4_', 'cd003_5_', 'cd003_6_', 'cd003_7_', 'cd003_8_', 'cd003_9_', 'cd003_10_', 'cd003_11_', 'cd003_12_', 'cd003_13_', 'cd003_14_'), missings = TRUE)

opal.assign.table.tibble(o, 'CHARLS_w1_cont_rel2','CHARLS.household_roster_wave1', 
                        variables=list('a006_1_', 'a006_2_', 'a006_3_', 'a006_4_', 'a006_5_', 'a006_6_', 'a006_7_', 'a006_8_', 'a006_9_', 'a006_10_', 'a006_11_', 'a006_12_', 'a006_13_', 'a006_14_', 'a006_15_', 'a006_16_'), missings = TRUE)

opal.assign.table.tibble(o, 'CHARLS_w1_id','CHARLS.CHARLS_w1_ids',
                         variables=list('var'), missings = TRUE)
```

```{r local1}
CHARLS_w1_cont_rel1 <- opal.execute(o,'CHARLS_w1_cont_rel1')
CHARLS_w1_cont_rel2 <- opal.execute(o,'CHARLS_w1_cont_rel2')
CHARLS_w1_id <- opal.execute(o,'CHARLS_w1_id')

CHARLS_w1_cont_rel1$oldid <- CHARLS_w1_cont_rel1$id
CHARLS_w1_cont_rel1$id <- CHARLS_ids(ids = CHARLS_w1_cont_rel1$oldid)
CHARLS_w1_cont_rel1 <- left_join(CHARLS_w1_id, CHARLS_w1_cont_rel1, by="id")[,-2]

CHARLS_w1_cont_rel2$oldid <- CHARLS_w1_cont_rel2$id
CHARLS_w1_cont_rel2$id <- CHARLS_ids(ids = CHARLS_w1_cont_rel2$oldid)
CHARLS_w1_cont_rel2 <- left_join(CHARLS_w1_id, CHARLS_w1_cont_rel2, by="id")[,-2]

vari <- CHARLS_w1_cont_rel1$cd002_1_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w1_cont_rel1$cd002_1_, missing_values = NA)
ggplot(CHARLS_w1_cont_rel1, aes(x=factor(cd002_1_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("How Often do You/Your Spouse See Your Parent") + ylab("Frequency")


vari <- CHARLS_w1_cont_rel1$cd002_2_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w1_cont_rel1$cd002_1_, missing_values = NA)
ggplot(CHARLS_w1_cont_rel1, aes(x=factor(cd002_2_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("How Often do You/Your Spouse See Your Parent") + ylab("Frequency")


vari <- CHARLS_w1_cont_rel1$cd002_3_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w1_cont_rel1$cd002_1_, missing_values = NA)
ggplot(CHARLS_w1_cont_rel1, aes(x=factor(cd002_3_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("How Often do You/Your Spouse See Your Parent") + ylab("Frequency")


vari <- CHARLS_w1_cont_rel1$cd002_4_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w1_cont_rel1$cd002_1_, missing_values = NA)
ggplot(CHARLS_w1_cont_rel1, aes(x=factor(cd002_4_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("How Often do You/Your Spouse See Your Parent") + ylab("Frequency")


vari <- CHARLS_w1_cont_rel1$cd002_5_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w1_cont_rel1$cd002_1_, missing_values = NA)
ggplot(CHARLS_w1_cont_rel1, aes(x=factor(cd002_5_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("How Often do You/Your Spouse See Your Parent") + ylab("Frequency")


vari <- CHARLS_w1_cont_rel1$cd002_6_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w1_cont_rel1$cd002_1_, missing_values = NA)
ggplot(CHARLS_w1_cont_rel1, aes(x=factor(cd002_6_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("How Often do You/Your Spouse See Your Parent") + ylab("Frequency")


vari <- CHARLS_w1_cont_rel1$cd002_7_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w1_cont_rel1$cd002_1_, missing_values = NA)
ggplot(CHARLS_w1_cont_rel1, aes(x=factor(cd002_7_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("How Often do You/Your Spouse See Your Parent") + ylab("Frequency")


vari <- CHARLS_w1_cont_rel1$cd002_8_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w1_cont_rel1$cd002_1_, missing_values = NA)
ggplot(CHARLS_w1_cont_rel1, aes(x=factor(cd002_8_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("How Often do You/Your Spouse See Your Parent") + ylab("Frequency")


vari <- CHARLS_w1_cont_rel1$cd002_9_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w1_cont_rel1$cd002_1_, missing_values = NA)
ggplot(CHARLS_w1_cont_rel1, aes(x=factor(cd002_9_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("How Often do You/Your Spouse See Your Parent") + ylab("Frequency")

vari <- CHARLS_w1_cont_rel1$cd003_1_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w1_cont_rel1$cd003_1_, missing_values = NA)
ggplot(CHARLS_w1_cont_rel1, aes(x=factor(cd003_1_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("How Often do See Child") + ylab("Frequency")

vari <- CHARLS_w1_cont_rel1$cd003_2_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w1_cont_rel1$cd003_1_, missing_values = NA)
ggplot(CHARLS_w1_cont_rel1, aes(x=factor(cd003_2_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("How Often do See Child") + ylab("Frequency")

vari <- CHARLS_w1_cont_rel1$cd003_3_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w1_cont_rel1$cd003_1_, missing_values = NA)
ggplot(CHARLS_w1_cont_rel1, aes(x=factor(cd003_3_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("How Often do See Child") + ylab("Frequency")

vari <- CHARLS_w1_cont_rel1$cd003_4_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w1_cont_rel1$cd003_1_, missing_values = NA)
ggplot(CHARLS_w1_cont_rel1, aes(x=factor(cd003_4_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("How Often do See Child") + ylab("Frequency")

vari <- CHARLS_w1_cont_rel1$cd003_5_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w1_cont_rel1$cd003_1_, missing_values = NA)
ggplot(CHARLS_w1_cont_rel1, aes(x=factor(cd003_5_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("How Often do See Child") + ylab("Frequency")

vari <- CHARLS_w1_cont_rel1$cd003_6_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w1_cont_rel1$cd003_1_, missing_values = NA)
ggplot(CHARLS_w1_cont_rel1, aes(x=factor(cd003_6_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("How Often do See Child") + ylab("Frequency")

vari <- CHARLS_w1_cont_rel1$cd003_7_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w1_cont_rel1$cd003_1_, missing_values = NA)
ggplot(CHARLS_w1_cont_rel1, aes(x=factor(cd003_7_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("How Often do See Child") + ylab("Frequency")

vari <- CHARLS_w1_cont_rel1$cd003_8_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w1_cont_rel1$cd003_1_, missing_values = NA)
ggplot(CHARLS_w1_cont_rel1, aes(x=factor(cd003_8_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("How Often do See Child") + ylab("Frequency")

vari <- CHARLS_w1_cont_rel1$cd003_9_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w1_cont_rel1$cd003_1_, missing_values = NA)
ggplot(CHARLS_w1_cont_rel1, aes(x=factor(cd003_9_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("How Often do See Child") + ylab("Frequency")


vari <- CHARLS_w1_cont_rel2$a006_1_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w1_cont_rel2$a006_1_, missing_values = NA)
ggplot(CHARLS_w1_cont_rel2, aes(x=factor(a006_1_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Relationship to FamilyR") + ylab("Frequency")

vari <- CHARLS_w1_cont_rel2$a006_2_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w1_cont_rel2$a006_1_, missing_values = NA)
ggplot(CHARLS_w1_cont_rel2, aes(x=factor(a006_2_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Relationship to FamilyR") + ylab("Frequency")

vari <- CHARLS_w1_cont_rel2$a006_3_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w1_cont_rel2$a006_1_, missing_values = NA)
ggplot(CHARLS_w1_cont_rel2, aes(x=factor(a006_3_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Relationship to FamilyR") + ylab("Frequency")

vari <- CHARLS_w1_cont_rel2$a006_4_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w1_cont_rel2$a006_4_, missing_values = NA)
ggplot(CHARLS_w1_cont_rel2, aes(x=factor(a006_4_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Relationship to FamilyR") + ylab("Frequency")

vari <- CHARLS_w1_cont_rel2$a006_5_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w1_cont_rel2$a006_5_, missing_values = NA)
ggplot(CHARLS_w1_cont_rel2, aes(x=factor(a006_5_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Relationship to FamilyR") + ylab("Frequency")

vari <- CHARLS_w1_cont_rel2$a006_6_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w1_cont_rel2$a006_1_, missing_values = NA)
ggplot(CHARLS_w1_cont_rel2, aes(x=factor(a006_6_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Relationship to FamilyR") + ylab("Frequency")

vari <- CHARLS_w1_cont_rel2$a006_7_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w1_cont_rel2$a006_1_, missing_values = NA)
ggplot(CHARLS_w1_cont_rel2, aes(x=factor(a006_7_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Relationship to FamilyR") + ylab("Frequency")

vari <- CHARLS_w1_cont_rel2$a006_8_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w1_cont_rel2$a006_1_, missing_values = NA)
ggplot(CHARLS_w1_cont_rel2, aes(x=factor(a006_8_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Relationship to FamilyR") + ylab("Frequency")

vari <- CHARLS_w1_cont_rel2$a006_9_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w1_cont_rel2$a006_1_, missing_values = NA)
ggplot(CHARLS_w1_cont_rel2, aes(x=factor(a006_9_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Relationship to FamilyR") + ylab("Frequency")


vari <- CHARLS_w1_cont_rel2$a006_10_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w1_cont_rel2$a006_1_, missing_values = NA)
ggplot(CHARLS_w1_cont_rel2, aes(x=factor(a006_10_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Relationship to FamilyR") + ylab("Frequency")

vari <- CHARLS_w1_cont_rel2$a006_11_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w1_cont_rel2$a006_1_, missing_values = NA)
ggplot(CHARLS_w1_cont_rel2, aes(x=factor(a006_11_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Relationship to FamilyR") + ylab("Frequency")

vari <- CHARLS_w1_cont_rel2$a006_12_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w1_cont_rel2$a006_1_, missing_values = NA)
ggplot(CHARLS_w1_cont_rel2, aes(x=factor(a006_12_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Relationship to FamilyR") + ylab("Frequency")

vari <- CHARLS_w1_cont_rel2$a006_13_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w1_cont_rel2$a006_1_, missing_values = NA)
ggplot(CHARLS_w1_cont_rel2, aes(x=factor(a006_13_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Relationship to FamilyR") + ylab("Frequency")

vari <- CHARLS_w1_cont_rel2$a006_14_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w1_cont_rel2$a006_1_, missing_values = NA)
ggplot(CHARLS_w1_cont_rel2, aes(x=factor(a006_14_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Relationship to FamilyR") + ylab("Frequency")

vari <- CHARLS_w1_cont_rel2$a006_15_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w1_cont_rel2$a006_1_, missing_values = NA)
ggplot(CHARLS_w1_cont_rel2, aes(x=factor(a006_15_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Relationship to FamilyR") + ylab("Frequency")


vari <- CHARLS_w1_cont_rel2$a006_16_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w1_cont_rel2$a006_1_, missing_values = NA)
ggplot(CHARLS_w1_cont_rel2, aes(x=factor(a006_16_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Relationship to FamilyR") + ylab("Frequency")


```

#### Harmonisation algorithm
To compute the harmonize variable from the study-specific variable it has to be recoded as follows:

* `if any of a006_1_,..,a006_16_ in 1:10 then recode into 1`
* `if any of variables cd002_i_, cd003_i_ is in 1:5 then recode into 1`
* `if all variables cd002_i_, cd003_i_ are not in 1:5 then recode into 0`
* `NA into 999`


**R script:**

```{r harmo1, echo=TRUE}
CHARLS_w1_cont_rel <- left_join(CHARLS_w1_cont_rel2, CHARLS_w1_cont_rel1, by='id')

CHARLS_ds_w1 <- tibble(id=CHARLS_w1_cont_rel$id)

CHARLS_w1_cont_rel$cd002_1_ <- car::recode(as.vector(CHARLS_w1_cont_rel$cd002_1_), "NA='-999'")
CHARLS_w1_cont_rel$cd002_2_ <- car::recode(as.vector(CHARLS_w1_cont_rel$cd002_2_), "NA='-999'")
CHARLS_w1_cont_rel$cd002_3_ <- car::recode(as.vector(CHARLS_w1_cont_rel$cd002_3_), "NA='-999'")
CHARLS_w1_cont_rel$cd002_4_ <- car::recode(as.vector(CHARLS_w1_cont_rel$cd002_4_), "NA='-999'")
CHARLS_w1_cont_rel$cd002_5_ <- car::recode(as.vector(CHARLS_w1_cont_rel$cd002_5_), "NA='-999'")
CHARLS_w1_cont_rel$cd002_6_ <- car::recode(as.vector(CHARLS_w1_cont_rel$cd002_6_), "NA='-999'")
CHARLS_w1_cont_rel$cd002_7_ <- car::recode(as.vector(CHARLS_w1_cont_rel$cd002_7_), "NA='-999'")
CHARLS_w1_cont_rel$cd002_8_ <- car::recode(as.vector(CHARLS_w1_cont_rel$cd002_8_), "NA='-999'")
CHARLS_w1_cont_rel$cd002_9_ <- car::recode(as.vector(CHARLS_w1_cont_rel$cd002_9_), "NA='-999'")
CHARLS_w1_cont_rel$cd003_1_ <- car::recode(as.vector(CHARLS_w1_cont_rel$cd003_1_), "NA='-999'")
CHARLS_w1_cont_rel$cd003_2_ <- car::recode(as.vector(CHARLS_w1_cont_rel$cd003_2_), "NA='-999'")
CHARLS_w1_cont_rel$cd003_3_ <- car::recode(as.vector(CHARLS_w1_cont_rel$cd003_3_), "NA='-999'")
CHARLS_w1_cont_rel$cd003_4_ <- car::recode(as.vector(CHARLS_w1_cont_rel$cd003_4_), "NA='-999'")
CHARLS_w1_cont_rel$cd003_5_ <- car::recode(as.vector(CHARLS_w1_cont_rel$cd003_5_), "NA='-999'")
CHARLS_w1_cont_rel$cd003_6_ <- car::recode(as.vector(CHARLS_w1_cont_rel$cd003_6_), "NA='-999'")
CHARLS_w1_cont_rel$cd003_7_ <- car::recode(as.vector(CHARLS_w1_cont_rel$cd003_7_), "NA='-999'")
CHARLS_w1_cont_rel$cd003_8_ <- car::recode(as.vector(CHARLS_w1_cont_rel$cd003_8_), "NA='-999'")
CHARLS_w1_cont_rel$cd003_9_ <- car::recode(as.vector(CHARLS_w1_cont_rel$cd003_9_), "NA='-999'")
CHARLS_w1_cont_rel$cd003_10_ <- car::recode(as.vector(CHARLS_w1_cont_rel$cd003_10_), "NA='-999'")
CHARLS_w1_cont_rel$cd003_11_ <- car::recode(as.vector(CHARLS_w1_cont_rel$cd003_11_), "NA='-999'")
CHARLS_w1_cont_rel$cd003_12_ <- car::recode(as.vector(CHARLS_w1_cont_rel$cd003_12_), "NA='-999'")
CHARLS_w1_cont_rel$cd003_13_ <- car::recode(as.vector(CHARLS_w1_cont_rel$cd003_13_), "NA='-999'")
CHARLS_w1_cont_rel$cd003_14_ <- car::recode(as.vector(CHARLS_w1_cont_rel$cd003_14_), "NA='-999'")
CHARLS_w1_cont_rel$a006_1_ <- car::recode(as.vector(CHARLS_w1_cont_rel$a006_1_), "NA='-999'")
CHARLS_w1_cont_rel$a006_2_ <- car::recode(as.vector(CHARLS_w1_cont_rel$a006_2_), "NA='-999'")
CHARLS_w1_cont_rel$a006_3_ <- car::recode(as.vector(CHARLS_w1_cont_rel$a006_3_), "NA='-999'")
CHARLS_w1_cont_rel$a006_4_ <- car::recode(as.vector(CHARLS_w1_cont_rel$a006_4_), "NA='-999'")
CHARLS_w1_cont_rel$a006_5_ <- car::recode(as.vector(CHARLS_w1_cont_rel$a006_5_), "NA='-999'")
CHARLS_w1_cont_rel$a006_6_ <- car::recode(as.vector(CHARLS_w1_cont_rel$a006_6_), "NA='-999'")
CHARLS_w1_cont_rel$a006_7_ <- car::recode(as.vector(CHARLS_w1_cont_rel$a006_7_), "NA='-999'")
CHARLS_w1_cont_rel$a006_8_ <- car::recode(as.vector(CHARLS_w1_cont_rel$a006_8_), "NA='-999'")
CHARLS_w1_cont_rel$a006_9_ <- car::recode(as.vector(CHARLS_w1_cont_rel$a006_9_), "NA='-999'")
CHARLS_w1_cont_rel$a006_10_ <- car::recode(as.vector(CHARLS_w1_cont_rel$a006_10_), "NA='-999'")
CHARLS_w1_cont_rel$a006_11_ <- car::recode(as.vector(CHARLS_w1_cont_rel$a006_11_), "NA='-999'")
CHARLS_w1_cont_rel$a006_12_ <- car::recode(as.vector(CHARLS_w1_cont_rel$a006_12_), "NA='-999'")
CHARLS_w1_cont_rel$a006_13_ <- car::recode(as.vector(CHARLS_w1_cont_rel$a006_13_), "NA='-999'")
CHARLS_w1_cont_rel$a006_14_ <- car::recode(as.vector(CHARLS_w1_cont_rel$a006_14_), "NA='-999'")
CHARLS_w1_cont_rel$a006_15_ <- car::recode(as.vector(CHARLS_w1_cont_rel$a006_15_), "NA='-999'")
CHARLS_w1_cont_rel$a006_16_ <- car::recode(as.vector(CHARLS_w1_cont_rel$a006_16_), "NA='-999'")


CHARLS_ds_w1$cont_rel <- c(NA) 
for(i in 1:dim(CHARLS_w1_cont_rel)[1]){
 #hosehold
  if( CHARLS_w1_cont_rel$a006_1_[i] %in% c(1:10) | 
      CHARLS_w1_cont_rel$a006_2_[i] %in% c(1:10) | 
      CHARLS_w1_cont_rel$a006_3_[i] %in% c(1:10) | 
      CHARLS_w1_cont_rel$a006_4_[i] %in% c(1:10) |
      CHARLS_w1_cont_rel$a006_5_[i] %in% c(1:10) | 
      CHARLS_w1_cont_rel$a006_6_[i] %in% c(1:10) | 
      CHARLS_w1_cont_rel$a006_7_[i] %in% c(1:10) | 
      CHARLS_w1_cont_rel$a006_8_[i] %in% c(1:10) |  
      CHARLS_w1_cont_rel$a006_9_[i] %in% c(1:10) | 
      CHARLS_w1_cont_rel$a006_10_[i] %in% c(1:10) | 
      CHARLS_w1_cont_rel$a006_11_[i] %in% c(1:10) | 
      CHARLS_w1_cont_rel$a006_12_[i] %in% c(1:10) | 
      CHARLS_w1_cont_rel$a006_13_[i] %in% c(1:10) | 
      CHARLS_w1_cont_rel$a006_14_[i] %in% c(1:10) | 
      CHARLS_w1_cont_rel$a006_15_[i] %in% c(1:10) | 
      CHARLS_w1_cont_rel$a006_16_[i] %in% c(1:10) ){
    CHARLS_ds_w1$cont_rel[i] = 1 }
   #seeing parents and children
  else if( CHARLS_w1_cont_rel$cd002_1_[i] %in% c(1,2,3,4,5) | 
           CHARLS_w1_cont_rel$cd002_2_[i] %in% c(1,2,3,4,5) |
           CHARLS_w1_cont_rel$cd002_3_[i] %in% c(1,2,3,4,5) |
           CHARLS_w1_cont_rel$cd002_4_[i] %in% c(1,2,3,4,5) | 
           CHARLS_w1_cont_rel$cd002_5_[i] %in% c(1,2,3,4,5) | 
           CHARLS_w1_cont_rel$cd002_6_[i] %in% c(1,2,3,4,5) |
           CHARLS_w1_cont_rel$cd002_7_[i] %in% c(1,2,3,4,5) | 
           CHARLS_w1_cont_rel$cd002_8_[i] %in% c(1,2,3,4,5) | 
           CHARLS_w1_cont_rel$cd002_9_[i] %in% c(1,2,3,4,5) |
           CHARLS_w1_cont_rel$cd003_1_[i] %in% c(1,2,3,4,5) | 
           CHARLS_w1_cont_rel$cd003_2_[i] %in% c(1,2,3,4,5) |
           CHARLS_w1_cont_rel$cd003_3_[i] %in% c(1,2,3,4,5) | 
           CHARLS_w1_cont_rel$cd003_4_[i] %in% c(1,2,3,4,5) | 
           CHARLS_w1_cont_rel$cd003_5_[i] %in% c(1,2,3,4,5) |
           CHARLS_w1_cont_rel$cd003_6_[i] %in% c(1,2,3,4,5) | 
           CHARLS_w1_cont_rel$cd003_7_[i] %in% c(1,2,3,4,5) | 
           CHARLS_w1_cont_rel$cd003_8_[i] %in% c(1,2,3,4,5) |
           CHARLS_w1_cont_rel$cd003_9_[i] %in% c(1,2,3,4,5) | 
           CHARLS_w1_cont_rel$cd003_10_[i] %in% c(1,2,3,4,5) | 
           CHARLS_w1_cont_rel$cd003_11_[i] %in% c(1,2,3,4,5) | 
           CHARLS_w1_cont_rel$cd003_12_[i] %in% c(1,2,3,4,5) | 
           CHARLS_w1_cont_rel$cd003_13_[i] %in% c(1,2,3,4,5) | 
           CHARLS_w1_cont_rel$cd003_14_[i] %in% c(1,2,3,4,5) ) {
  CHARLS_ds_w1$cont_rel[i] = 1 }
  #not seeing parents nor children
  else if( !(CHARLS_w1_cont_rel$cd002_1_[i] %in% c(1,2,3,4,5) | 
             CHARLS_w1_cont_rel$cd002_2_[i] %in% c(1,2,3,4,5) | 
             CHARLS_w1_cont_rel$cd002_3_[i] %in% c(1,2,3,4,5) |
             CHARLS_w1_cont_rel$cd002_4_[i] %in% c(1,2,3,4,5) | 
             CHARLS_w1_cont_rel$cd002_5_[i] %in% c(1,2,3,4,5) | 
             CHARLS_w1_cont_rel$cd002_6_[i] %in% c(1,2,3,4,5) |
             CHARLS_w1_cont_rel$cd002_7_[i] %in% c(1,2,3,4,5) | 
             CHARLS_w1_cont_rel$cd002_8_[i] %in% c(1,2,3,4,5) | 
             CHARLS_w1_cont_rel$cd002_9_[i] %in% c(1,2,3,4,5) |
             CHARLS_w1_cont_rel$cd003_1_[i] %in% c(1,2,3,4,5) | 
             CHARLS_w1_cont_rel$cd003_2_[i] %in% c(1,2,3,4,5) | 
             CHARLS_w1_cont_rel$cd003_3_[i] %in% c(1,2,3,4,5) | 
             CHARLS_w1_cont_rel$cd003_4_[i] %in% c(1,2,3,4,5) | 
             CHARLS_w1_cont_rel$cd003_5_[i] %in% c(1,2,3,4,5) | 
             CHARLS_w1_cont_rel$cd003_6_[i] %in% c(1,2,3,4,5) | 
             CHARLS_w1_cont_rel$cd003_7_[i] %in% c(1,2,3,4,5) | 
             CHARLS_w1_cont_rel$cd003_8_[i] %in% c(1,2,3,4,5) | 
             CHARLS_w1_cont_rel$cd003_9_[i] %in% c(1,2,3,4,5) | 
             CHARLS_w1_cont_rel$cd003_10_[i] %in% c(1,2,3,4,5) | 
             CHARLS_w1_cont_rel$cd003_11_[i] %in% c(1,2,3,4,5) | 
             CHARLS_w1_cont_rel$cd003_12_[i] %in% c(1,2,3,4,5) | 
             CHARLS_w1_cont_rel$cd003_13_[i] %in% c(1,2,3,4,5) | 
             CHARLS_w1_cont_rel$cd003_14_[i] %in% c(1,2,3,4,5) ) ) {
  CHARLS_ds_w1$cont_rel[i] = 0 }
  
}

CHARLS_ds_w1$cont_rel <- car::recode(as.vector(CHARLS_ds_w1$cont_rel), "NA='999'")
CHARLS_ds_w1$cont_rel <- labelled(CHARLS_ds_w1$cont_rel, labels = c("No"=0, "Yes"=1, "Missing"=999, "Do not know"=998, "Refuse"=997, "Not applicable"=996, "Don't answer"=995,  "Not attempt/not done/not yet recorded"=994, "Disable to measure"=993, "Impute"=992, "CAPI/interviewer error"=991))
```

#### Statistical description of the new harmonised variable
```{r descript1}
vari <- CHARLS_ds_w1$cont_rel
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[3]) 
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[2], caption = "Type of missing")
#Categorical_summary(var = CHARLS_ds_w1$cont_rel, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))
ggplot(CHARLS_ds_w1, aes(x=factor(cont_rel))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Are face to face contacts with relatives frequent (i.e. contact once a month or more often)") + ylab("Frequency")
```

#### Validation
```{r crosstabulation1}

```



### Wave 2

#### Study-specific variables

The study-specific variable elected to be harmonised is:

** All from the table "Family_Information_wave2": **

* Name: `cd002_1_`
* Label: `See Your Father`
* Categories:
    + `1 = Almost every day`
    + `2 = 2-3 times a week`
    + `3 = Once a week`
    + `4 = Every two weeks`
    + `5 = Once a month`
    + `6 = Once every three months`
    + `7 = Once every six months`
    + `8 = Once a year`
    + `9 = Almost never`
    + `10 = Other`
    
* Name: `cd002_2_`
* Label: `See Your Mother`
* Categories:
    + `1 = Almost every day`
    + `2 = 2-3 times a week`
    + `3 = Once a week`
    + `4 = Every two weeks`
    + `5 = Once a month`
    + `6 = Once every three months`
    + `7 = Once every six months`
    + `8 = Once a year`
    + `9 = Almost never`
    + `10 = Other`

* Name: `cd002_3_`
* Label: `See Your Father-in-law`
* Categories:
    + `1 = Almost every day`
    + `2 = 2-3 times a week`
    + `3 = Once a week`
    + `4 = Every two weeks`
    + `5 = Once a month`
    + `6 = Once every three months`
    + `7 = Once every six months`
    + `8 = Once a year`
    + `9 = Almost never`
    + `10 = Other`
    
* Name: `cd002_4_`
* Label: `See Your Mother-in-law`
* Categories:
    + `1 = Almost every day`
    + `2 = 2-3 times a week`
    + `3 = Once a week`
    + `4 = Every two weeks`
    + `5 = Once a month`
    + `6 = Once every three months`
    + `7 = Once every six months`
    + `8 = Once a year`
    + `9 = Almost never`
    + `10 = Other`    
    

* Name: `cd002_w2_1`
* Label: `See Your Parents`
* Categories:
    + `1 = Almost every day`
    + `2 = 2-3 times a week`
    + `3 = Once a week`
    + `4 = Every two weeks`
    + `5 = Once a month`
    + `6 = Once every three months`
    + `7 = Once every six months`
    + `8 = Once a year`
    + `9 = Almost never`
    + `10 = Other`
    
* Name: `cd002_w2_2`
* Label: `See Your Parents-in-law`
* Categories:
    + `1 = Almost every day`
    + `2 = 2-3 times a week`
    + `3 = Once a week`
    + `4 = Every two weeks`
    + `5 = Once a month`
    + `6 = Once every three months`
    + `7 = Once every six months`
    + `8 = Once a year`
    + `9 = Almost never`
    + `10 = Other`
    
* Name: `cd003_1_` till `cd003_11_`
* Label: `See Child`
* Categories:
    + `1 = Almost every day`
    + `2 = 2-3 times a week`
    + `3 = Once a week`
    + `4 = Every two weeks`
    + `5 = Once a month`
    + `6 = Once every three months`
    + `7 = Once every six months`
    + `8 = Once a year`
    + `9 = Almost never`
    + `10 = Other`


* Name: `cm001_w2_1s1` 
* Label: `Household Member List Confirm`
* Categories:
    * `1 = 1 ZMemberName[1] Yes`
** UP TO: **
* Name: `cm001_w2_1s16`
* Label: `Household Member List Confirm`
* Categories:
    * `16 = 16 ZMemberName[16] Yes`



* Description: 
```{r assign2}
opal.assign.table.tibble(o, 'CHARLS_w2_cont_rel','CHARLS.Family_Information_wave2', 
                        variables=list('cd002_1_','cd002_2_','cd002_3_','cd002_4_',
                                       'cd002_w2_1','cd002_w2_2',
                                       'cd003_1_','cd003_2_','cd003_3_','cd003_4_','cd003_5_','cd003_6_',
                                       'cd003_7_','cd003_8_','cd003_9_','cd003_10_','cd003_11_',
                                       'cm001_w2_1s1','cm001_w2_1s2','cm001_w2_1s3','cm001_w2_1s4','cm001_w2_1s5','cm001_w2_1s6',
                                       'cm001_w2_1s7','cm001_w2_1s8','cm001_w2_1s9','cm001_w2_1s10','cm001_w2_1s11','cm001_w2_1s12',
                                       'cm001_w2_1s13','cm001_w2_1s14','cm001_w2_1s15','cm001_w2_1s16'), missings = TRUE)

opal.assign.table.tibble(o, 'CHARLS_w2_id','CHARLS.CHARLS_w2_ids',
                         variables=list('var'), missings = TRUE)

```

```{r local2}
CHARLS_w2_cont_rel <- opal.execute(o,'CHARLS_w2_cont_rel')
CHARLS_w2_id <- opal.execute(o,'CHARLS_w2_id')
CHARLS_w2_cont_rel <- left_join(CHARLS_w2_id, CHARLS_w2_cont_rel, by="id")[,-2]

vari <- CHARLS_w2_cont_rel$cd002_1_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w2_cont_rel$cd002_1_, missing_values = NA)
ggplot(CHARLS_w2_cont_rel, aes(x=factor(cd002_1_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("How Often do You See Your Father") + ylab("Frequency")

vari <- CHARLS_w2_cont_rel$cd002_2_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w2_cont_rel$cd002_1_, missing_values = NA)
ggplot(CHARLS_w2_cont_rel, aes(x=factor(cd002_2_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("How Often do You See Your Mother") + ylab("Frequency")


vari <- CHARLS_w2_cont_rel$cd002_3_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w2_cont_rel$cd002_1_, missing_values = NA)
ggplot(CHARLS_w2_cont_rel, aes(x=factor(cd002_3_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("How Often do You See Your Father-in-Law") + ylab("Frequency")

vari <- CHARLS_w2_cont_rel$cd002_4_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w2_cont_rel$cd002_1_, missing_values = NA)
ggplot(CHARLS_w2_cont_rel, aes(x=factor(cd002_4_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("How Often do You See Your Mother-in-Law") + ylab("Frequency")

vari <- CHARLS_w2_cont_rel$cd003_1_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w2_cont_rel$cd003_1_, missing_values = NA)
ggplot(CHARLS_w2_cont_rel, aes(x=factor(cd003_1_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("How Often do See Child") + ylab("Frequency")

vari <- CHARLS_w2_cont_rel$cd003_2_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w2_cont_rel$cd003_1_, missing_values = NA)
ggplot(CHARLS_w2_cont_rel, aes(x=factor(cd003_2_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("How Often do See Child") + ylab("Frequency")

vari <- CHARLS_w2_cont_rel$cd003_3_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w2_cont_rel$cd003_1_, missing_values = NA)
ggplot(CHARLS_w2_cont_rel, aes(x=factor(cd003_3_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("How Often do See Child") + ylab("Frequency")


vari <- CHARLS_w2_cont_rel$cd003_4_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w2_cont_rel$cd003_1_, missing_values = NA)
ggplot(CHARLS_w2_cont_rel, aes(x=factor(cd003_4_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("How Often do See Child") + ylab("Frequency")


vari <- CHARLS_w2_cont_rel$cd003_5_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w2_cont_rel$cd003_1_, missing_values = NA)
ggplot(CHARLS_w2_cont_rel, aes(x=factor(cd003_5_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("How Often do See Child") + ylab("Frequency")




vari <- CHARLS_w2_cont_rel$cd003_6_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w2_cont_rel$cd003_1_, missing_values = NA)
ggplot(CHARLS_w2_cont_rel, aes(x=factor(cd003_6_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("How Often do See Child") + ylab("Frequency")


vari <- CHARLS_w2_cont_rel$cd003_7_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w2_cont_rel$cd003_1_, missing_values = NA)
ggplot(CHARLS_w2_cont_rel, aes(x=factor(cd003_7_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("How Often do See Child") + ylab("Frequency")


vari <- CHARLS_w2_cont_rel$cd003_8_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w2_cont_rel$cd003_1_, missing_values = NA)
ggplot(CHARLS_w2_cont_rel, aes(x=factor(cd003_8_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("How Often do See Child") + ylab("Frequency")


vari <- CHARLS_w2_cont_rel$cd003_9_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w2_cont_rel$cd003_1_, missing_values = NA)
ggplot(CHARLS_w2_cont_rel, aes(x=factor(cd003_9_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("How Often do See Child") + ylab("Frequency")


vari <- CHARLS_w2_cont_rel$cd003_10_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w2_cont_rel$cd003_1_, missing_values = NA)
ggplot(CHARLS_w2_cont_rel, aes(x=factor(cd003_10_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("How Often do See Child") + ylab("Frequency")


vari <- CHARLS_w2_cont_rel$cd003_11_
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w2_cont_rel$cd003_1_, missing_values = NA)
ggplot(CHARLS_w2_cont_rel, aes(x=factor(cd003_11_))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("How Often do See Child") + ylab("Frequency")


vari <- CHARLS_w2_cont_rel$cd002_w2_1
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w2_cont_rel$cd002_w2_1, missing_values = NA)
ggplot(CHARLS_w2_cont_rel, aes(x=factor(cd002_w2_1))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("How Often do See Your Parents") + ylab("Frequency")


vari <- CHARLS_w2_cont_rel$cd002_w2_2
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w2_cont_rel$cd002_w2_1, missing_values = NA)
ggplot(CHARLS_w2_cont_rel, aes(x=factor(cd002_w2_2))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("How Often do See Your Parents-in-Law") + ylab("Frequency")

vari <- CHARLS_w2_cont_rel$cm001_w2_1s1
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w2_cont_rel$cm001_w2_1s1, missing_values = NA)
ggplot(CHARLS_w2_cont_rel, aes(x=factor(cm001_w2_1s1))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Household Member List Confirm") + ylab("Frequency")


vari <- CHARLS_w2_cont_rel$cm001_w2_1s2
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w2_cont_rel$cm001_w2_1s1, missing_values = NA)
ggplot(CHARLS_w2_cont_rel, aes(x=factor(cm001_w2_1s2))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Household Member List Confirm") + ylab("Frequency")


vari <- CHARLS_w2_cont_rel$cm001_w2_1s3
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w2_cont_rel$cm001_w2_1s1, missing_values = NA)
ggplot(CHARLS_w2_cont_rel, aes(x=factor(cm001_w2_1s3))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Household Member List Confirm") + ylab("Frequency")

vari <- CHARLS_w2_cont_rel$cm001_w2_1s4
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w2_cont_rel$cm001_w2_1s1, missing_values = NA)
ggplot(CHARLS_w2_cont_rel, aes(x=factor(cm001_w2_1s4))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Household Member List Confirm") + ylab("Frequency")

vari <- CHARLS_w2_cont_rel$cm001_w2_1s5
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w2_cont_rel$cm001_w2_1s1, missing_values = NA)
ggplot(CHARLS_w2_cont_rel, aes(x=factor(cm001_w2_1s5))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Household Member List Confirm") + ylab("Frequency")

vari <- CHARLS_w2_cont_rel$cm001_w2_1s6
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w2_cont_rel$cm001_w2_1s1, missing_values = NA)
ggplot(CHARLS_w2_cont_rel, aes(x=factor(cm001_w2_1s6))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Household Member List Confirm") + ylab("Frequency")

vari <- CHARLS_w2_cont_rel$cm001_w2_1s7
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w2_cont_rel$cm001_w2_1s1, missing_values = NA)
ggplot(CHARLS_w2_cont_rel, aes(x=factor(cm001_w2_1s7))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Household Member List Confirm") + ylab("Frequency")

vari <- CHARLS_w2_cont_rel$cm001_w2_1s8
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w2_cont_rel$cm001_w2_1s1, missing_values = NA)
ggplot(CHARLS_w2_cont_rel, aes(x=factor(cm001_w2_1s8))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Household Member List Confirm") + ylab("Frequency")

vari <- CHARLS_w2_cont_rel$cm001_w2_1s9
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w2_cont_rel$cm001_w2_1s1, missing_values = NA)
ggplot(CHARLS_w2_cont_rel, aes(x=factor(cm001_w2_1s9))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Household Member List Confirm") + ylab("Frequency")

vari <- CHARLS_w2_cont_rel$cm001_w2_1s10
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w2_cont_rel$cm001_w2_1s1, missing_values = NA)
ggplot(CHARLS_w2_cont_rel, aes(x=factor(cm001_w2_1s10))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Household Member List Confirm") + ylab("Frequency")

vari <- CHARLS_w2_cont_rel$cm001_w2_1s11
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w2_cont_rel$cm001_w2_1s1, missing_values = NA)
ggplot(CHARLS_w2_cont_rel, aes(x=factor(cm001_w2_1s11))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Household Member List Confirm") + ylab("Frequency")

vari <- CHARLS_w2_cont_rel$cm001_w2_1s12
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w2_cont_rel$cm001_w2_1s1, missing_values = NA)
ggplot(CHARLS_w2_cont_rel, aes(x=factor(cm001_w2_1s12))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Household Member List Confirm") + ylab("Frequency")

vari <- CHARLS_w2_cont_rel$cm001_w2_1s13
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w2_cont_rel$cm001_w2_1s1, missing_values = NA)
ggplot(CHARLS_w2_cont_rel, aes(x=factor(cm001_w2_1s13))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Household Member List Confirm") + ylab("Frequency")

vari <- CHARLS_w2_cont_rel$cm001_w2_1s14
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w2_cont_rel$cm001_w2_1s1, missing_values = NA)
ggplot(CHARLS_w2_cont_rel, aes(x=factor(cm001_w2_1s14))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Household Member List Confirm") + ylab("Frequency")

vari <- CHARLS_w2_cont_rel$cm001_w2_1s15
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w2_cont_rel$cm001_w2_1s1, missing_values = NA)
ggplot(CHARLS_w2_cont_rel, aes(x=factor(cm001_w2_1s15))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Household Member List Confirm") + ylab("Frequency")

vari <- CHARLS_w2_cont_rel$cm001_w2_1s16
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = CHARLS_w2_cont_rel$cm001_w2_1s1, missing_values = NA)
ggplot(CHARLS_w2_cont_rel, aes(x=factor(cm001_w2_1s16))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Household Member List Confirm") + ylab("Frequency")


```

#### Harmonisation algorithm
To compute the harmonize variable from the study-specific variable it has to be recoded as follows:

* `if any of cm001_w2_1s1 = 1,..., cm001_w2_1s16 = 16 then recode into 1`
* `if any of variables cd002_i_, cd003_i_ is in 1:5 then recode into 1`
* `if all variables cd002_i_, cd003_i_ are not in 1:5 then recode into 0`
* `NA into 999`


**R script:**

```{r harmo2, echo=TRUE}
CHARLS_ds_w2 <- tibble(id=CHARLS_w2_cont_rel$id)

CHARLS_w2_cont_rel$cd002_1_ <- car::recode(as.vector(CHARLS_w2_cont_rel$cd002_1_), "NA='-999'")
CHARLS_w2_cont_rel$cd002_2_ <- car::recode(as.vector(CHARLS_w2_cont_rel$cd002_2_), "NA='-999'")
CHARLS_w2_cont_rel$cd002_3_ <- car::recode(as.vector(CHARLS_w2_cont_rel$cd002_3_), "NA='-999'")
CHARLS_w2_cont_rel$cd002_4_ <- car::recode(as.vector(CHARLS_w2_cont_rel$cd002_4_), "NA='-999'")
CHARLS_w2_cont_rel$cd002_w2_1 <- car::recode(as.vector(CHARLS_w2_cont_rel$cd002_w2_1), "NA='-999'")
CHARLS_w2_cont_rel$cd002_w2_2 <- car::recode(as.vector(CHARLS_w2_cont_rel$cd002_w2_2), "NA='-999'")

CHARLS_w2_cont_rel$cd003_1_ <- car::recode(as.vector(CHARLS_w2_cont_rel$cd003_1_), "NA='-999'")
CHARLS_w2_cont_rel$cd003_2_ <- car::recode(as.vector(CHARLS_w2_cont_rel$cd003_2_), "NA='-999'")
CHARLS_w2_cont_rel$cd003_3_ <- car::recode(as.vector(CHARLS_w2_cont_rel$cd003_3_), "NA='-999'")
CHARLS_w2_cont_rel$cd003_4_ <- car::recode(as.vector(CHARLS_w2_cont_rel$cd003_4_), "NA='-999'")
CHARLS_w2_cont_rel$cd003_5_ <- car::recode(as.vector(CHARLS_w2_cont_rel$cd003_5_), "NA='-999'")
CHARLS_w2_cont_rel$cd003_6_ <- car::recode(as.vector(CHARLS_w2_cont_rel$cd003_6_), "NA='-999'")
CHARLS_w2_cont_rel$cd003_7_ <- car::recode(as.vector(CHARLS_w2_cont_rel$cd003_7_), "NA='-999'")
CHARLS_w2_cont_rel$cd003_8_ <- car::recode(as.vector(CHARLS_w2_cont_rel$cd003_8_), "NA='-999'")
CHARLS_w2_cont_rel$cd003_9_ <- car::recode(as.vector(CHARLS_w2_cont_rel$cd003_9_), "NA='-999'")
CHARLS_w2_cont_rel$cd003_10_ <- car::recode(as.vector(CHARLS_w2_cont_rel$cd003_10_), "NA='-999'")
CHARLS_w2_cont_rel$cd003_11_ <- car::recode(as.vector(CHARLS_w2_cont_rel$cd003_11_), "NA='-999'")

CHARLS_w2_cont_rel$cm001_w2_1s1 <- car::recode(as.vector(CHARLS_w2_cont_rel$cm001_w2_1s1), "NA='-999'")
CHARLS_w2_cont_rel$cm001_w2_1s2 <- car::recode(as.vector(CHARLS_w2_cont_rel$cm001_w2_1s2), "NA='-999'")
CHARLS_w2_cont_rel$cm001_w2_1s3 <- car::recode(as.vector(CHARLS_w2_cont_rel$cm001_w2_1s3), "NA='-999'")
CHARLS_w2_cont_rel$cm001_w2_1s4 <- car::recode(as.vector(CHARLS_w2_cont_rel$cm001_w2_1s4), "NA='-999'")
CHARLS_w2_cont_rel$cm001_w2_1s5 <- car::recode(as.vector(CHARLS_w2_cont_rel$cm001_w2_1s5), "NA='-999'")
CHARLS_w2_cont_rel$cm001_w2_1s6 <- car::recode(as.vector(CHARLS_w2_cont_rel$cm001_w2_1s6), "NA='-999'")
CHARLS_w2_cont_rel$cm001_w2_1s7 <- car::recode(as.vector(CHARLS_w2_cont_rel$cm001_w2_1s7), "NA='-999'")
CHARLS_w2_cont_rel$cm001_w2_1s8 <- car::recode(as.vector(CHARLS_w2_cont_rel$cm001_w2_1s8), "NA='-999'")
CHARLS_w2_cont_rel$cm001_w2_1s9 <- car::recode(as.vector(CHARLS_w2_cont_rel$cm001_w2_1s9), "NA='-999'")
CHARLS_w2_cont_rel$cm001_w2_1s10 <- car::recode(as.vector(CHARLS_w2_cont_rel$cm001_w2_1s10), "NA='-999'")
CHARLS_w2_cont_rel$cm001_w2_1s11 <- car::recode(as.vector(CHARLS_w2_cont_rel$cm001_w2_1s11), "NA='-999'")
CHARLS_w2_cont_rel$cm001_w2_1s12 <- car::recode(as.vector(CHARLS_w2_cont_rel$cm001_w2_1s12), "NA='-999'")
CHARLS_w2_cont_rel$cm001_w2_1s13 <- car::recode(as.vector(CHARLS_w2_cont_rel$cm001_w2_1s13), "NA='-999'")
CHARLS_w2_cont_rel$cm001_w2_1s14 <- car::recode(as.vector(CHARLS_w2_cont_rel$cm001_w2_1s14), "NA='-999'")
CHARLS_w2_cont_rel$cm001_w2_1s15 <- car::recode(as.vector(CHARLS_w2_cont_rel$cm001_w2_1s15), "NA='-999'")
CHARLS_w2_cont_rel$cm001_w2_1s16 <- car::recode(as.vector(CHARLS_w2_cont_rel$cm001_w2_1s16), "NA='-999'")


CHARLS_ds_w2$cont_rel <- c(NA) 
for(i in 1:dim(CHARLS_w2_cont_rel)[1]){
 
  if( CHARLS_w2_cont_rel$cm001_w2_1s1[i] == 1 | CHARLS_w2_cont_rel$cm001_w2_1s2[i] == 2 | CHARLS_w2_cont_rel$cm001_w2_1s3[i] == 3 | 
    CHARLS_w2_cont_rel$cm001_w2_1s4[i] == 4 | CHARLS_w2_cont_rel$cm001_w2_1s5[i] == 5 | CHARLS_w2_cont_rel$cm001_w2_1s6[i] == 6 | 
    CHARLS_w2_cont_rel$cm001_w2_1s7[i] == 7 | CHARLS_w2_cont_rel$cm001_w2_1s8[i] == 8 | CHARLS_w2_cont_rel$cm001_w2_1s9[i] == 9 | 
    CHARLS_w2_cont_rel$cm001_w2_1s10[i] == 10 | CHARLS_w2_cont_rel$cm001_w2_1s11[i] == 11 | CHARLS_w2_cont_rel$cm001_w2_1s12[i] == 12 | 
    CHARLS_w2_cont_rel$cm001_w2_1s13[i] == 13 | CHARLS_w2_cont_rel$cm001_w2_1s14[i] == 14 | CHARLS_w2_cont_rel$cm001_w2_1s15[i] == 15 | 
    CHARLS_w2_cont_rel$cm001_w2_1s16[i] == 16 ){
    CHARLS_ds_w2$cont_rel[i] = 1 }
   
  else if( CHARLS_w2_cont_rel$cd002_1_[i] %in% c(1,2,3,4,5) | CHARLS_w2_cont_rel$cd002_2_[i] %in% c(1,2,3,4,5) | CHARLS_w2_cont_rel$cd002_3_[i] %in% c(1,2,3,4,5) |
    CHARLS_w2_cont_rel$cd002_4_[i] %in% c(1,2,3,4,5) | CHARLS_w2_cont_rel$cd002_w2_1[i] %in% c(1,2,3,4,5) | CHARLS_w2_cont_rel$cd002_w2_2[i] %in% c(1,2,3,4,5) |
    CHARLS_w2_cont_rel$cd003_1_[i] %in% c(1,2,3,4,5) | CHARLS_w2_cont_rel$cd003_2_[i] %in% c(1,2,3,4,5) | CHARLS_w2_cont_rel$cd003_3_[i] %in% c(1,2,3,4,5) | 
    CHARLS_w2_cont_rel$cd003_4_[i] %in% c(1,2,3,4,5) | CHARLS_w2_cont_rel$cd003_5_[i] %in% c(1,2,3,4,5) | CHARLS_w2_cont_rel$cd003_6_[i] %in% c(1,2,3,4,5) | 
    CHARLS_w2_cont_rel$cd003_7_[i] %in% c(1,2,3,4,5) | CHARLS_w2_cont_rel$cd003_8_[i] %in% c(1,2,3,4,5) | CHARLS_w2_cont_rel$cd003_9_[i] %in% c(1,2,3,4,5) | 
    CHARLS_w2_cont_rel$cd003_10_[i] %in% c(1,2,3,4,5) | CHARLS_w2_cont_rel$cd003_11_[i] %in% c(1,2,3,4,5) ) {
  CHARLS_ds_w2$cont_rel[i] = 1 }
  
  else if( !( CHARLS_w2_cont_rel$cd002_1_[i] %in% c(1,2,3,4,5) | CHARLS_w2_cont_rel$cd002_2_[i] %in% c(1,2,3,4,5) | CHARLS_w2_cont_rel$cd002_3_[i] %in% c(1,2,3,4,5) |
    CHARLS_w2_cont_rel$cd002_4_[i] %in% c(1,2,3,4,5) | CHARLS_w2_cont_rel$cd002_w2_1[i] %in% c(1,2,3,4,5) | CHARLS_w2_cont_rel$cd002_w2_2[i] %in% c(1,2,3,4,5) |
    CHARLS_w2_cont_rel$cd003_1_[i] %in% c(1,2,3,4,5) | CHARLS_w2_cont_rel$cd003_2_[i] %in% c(1,2,3,4,5) | CHARLS_w2_cont_rel$cd003_3_[i] %in% c(1,2,3,4,5) | 
    CHARLS_w2_cont_rel$cd003_4_[i] %in% c(1,2,3,4,5) | CHARLS_w2_cont_rel$cd003_5_[i] %in% c(1,2,3,4,5) | CHARLS_w2_cont_rel$cd003_6_[i] %in% c(1,2,3,4,5) | 
    CHARLS_w2_cont_rel$cd003_7_[i] %in% c(1,2,3,4,5) | CHARLS_w2_cont_rel$cd003_8_[i] %in% c(1,2,3,4,5) | CHARLS_w2_cont_rel$cd003_9_[i] %in% c(1,2,3,4,5) | 
    CHARLS_w2_cont_rel$cd003_10_[i] %in% c(1,2,3,4,5) | CHARLS_w2_cont_rel$cd003_11_[i] %in% c(1,2,3,4,5) ) ) {
  CHARLS_ds_w2$cont_rel[i] = 0 }
}

CHARLS_ds_w2$cont_rel <- car::recode(as.vector(CHARLS_ds_w2$cont_rel), "NA='999'")
CHARLS_ds_w2$cont_rel <- labelled(CHARLS_ds_w2$cont_rel, labels = c("No"=0, "Yes"=1, "Missing"=999, "Do not know"=998, "Refuse"=997, "Not applicable"=996, "Don't answer"=995,  "Not attempt/not done/not yet recorded"=994, "Disable to measure"=993, "Impute"=992, "CAPI/interviewer error"=991))
```

#### Statistical description of the new harmonised variable
```{r descript2}
vari <- CHARLS_ds_w2$cont_rel
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[3]) 
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[2], caption = "Type of missing")
#Categorical_summary(var = CHARLS_ds_w2$cont_rel, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))
ggplot(CHARLS_ds_w2, aes(x=factor(cont_rel))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Are face to face contacts with relatives frequent (i.e. contact once a month or more often)") + ylab("Frequency")
```

#### Validation
```{r crosstabulation2}

```

```{r save, echo=FALSE}
cont_rel <- CHARLS_ds_w1
save(cont_rel, file = "../RData/w1/cont_rel.RData")
rm(cont_rel)

cont_rel <- CHARLS_ds_w2
save(cont_rel, file = "../RData/w2/cont_rel.RData")
rm(cont_rel)


```

# Quality estimation
```{r closeRsession, echo=FALSE} 
opal.logout(o)
```




