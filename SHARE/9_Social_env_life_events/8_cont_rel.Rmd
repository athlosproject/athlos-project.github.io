---
title: "Are any form of contact ( face-to-face/phone/mail/Internet communicators) with family members/relatives frequent (i.e. contact once a week or more often)?"
output:
  html_document:
    highlight: tango
    number_sections: yes
    theme: united
    toc: yes
    toc_depth: 6
    toc_float:
      collapsed: yes
      smooth_scroll: yes
---

<!-- ########################################################## --> 
<!-- # Installation, loading packages -->
```{r setup, include=FALSE}
source("../../setup_iago.r")
```
<!-- ########################################################## --> 
<!-- # Loading DS description -->
```{r main, child='../../_DS_Rmd/cont_relDS.Rmd'}
```
```{r global, echo=F}
source('../../_DS_Rmd/cont_relDS.R')
```



<!-- ########################################################## --> 

# Data process
## SHARE


### Wave 1

#### Study-specific variable description

The study-specific variables elected to be harmonised are:

* Name: `ch014_1` UP TO `ch014_4` **from table sharew1_rel2-6-0_ch**
* Label: `contact with (selected) child 1`
* Categories:
    + `1 = daily`
    + `2 = several times a week`
    + `3 = about once a week`
    + `4 = about every two weeks`
    + `5 = about once a month`
    + `6 = less than once a month`
    + `7 = never`
* Missings:
    + `-2 = refusal`
    + `-1 = don't know`
 
* Name: `dn032_2` **from table sharew1_rel2-6-0_dn**
* Label: `personal contact with parent during past 12 months: father`
* Categories:
    + `1 = daily`
    + `2 = several times a week`
    + `3 = about once a week`
    + `4 = about every two weeks`
    + `5 = about once a month`
    + `6 = less than once a month`
    + `7 = never`
* Missings:
    + `-2 = refusal`
    + `-1 = don't know`

* Name: `dn032_1` **from table sharew1_rel2-6-0_dn**
* Label: `personal contact with parent during past 12 months: mother`
* Categories:
    + `1 = daily`
    + `2 = several times a week`
    + `3 = about once a week`
    + `4 = about every two weeks`
    + `5 = about once a month`
    + `6 = less than once a month`
    + `7 = never`
* Missings:
    + `-2 = refusal`
    + `-1 = don't know`

* Name: `cv018_2` UP TO `cv018_9` **from table sharew1_rel2-6-0_cv_h**
* Label: `relation hhmember to respondent`
* Categories:
    + `1 = spouse`
    + `2 = partner`
    + `3 = child`
    + `4 = child-in-law`
    + `5 = parent`
    + `6 = parent-in-law`
    + `7 = sibling`
    + `8 = grand-child`
    + `9 = other relative (specify)`
    + `10 = other non-relative (specify)`
* Missings:
    + `-2 = refusal`
    + `-1 = don't know`
    
    
* Description: 
```{r assign1, echo=F}
opal.assign.table.tibble(o, 'SHARE_w1_cont_rel1','SHARE.sharew1_rel2-6-0_ch', 
                        variables=list('ch014_1','ch014_2','ch014_3','ch014_4', 'hhid'), missings = TRUE)

opal.assign.table.tibble(o, 'SHARE_w1_cont_rel2','SHARE.sharew1_rel2-6-0_dn', 
                        variables=list('dn032_2','dn032_1', 'hhid'), missings = TRUE)


opal.assign.table.tibble(o, 'SHARE_w1_cont_rel3','SHARE.sharew1_rel2-6-0_cv_h', 
                        variables=list('cv018_2','cv018_3','cv018_4','cv018_5','cv018_6','cv018_7','cv018_8','cv018_9'), missings = TRUE)

SHARE_w1_cont_rel1 <- opal.execute(o,'SHARE_w1_cont_rel1')
SHARE_w1_cont_rel2 <- opal.execute(o,'SHARE_w1_cont_rel2')
SHARE_w1_cont_rel3 <- opal.execute(o,'SHARE_w1_cont_rel3')

```

```{r local1, echo=F}

vari <- SHARE_w1_cont_rel1$ch014_1
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w1_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w1_cont_rel1, aes(x=factor(ch014_1))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 1") + ylab("Frequency") 

vari <- SHARE_w1_cont_rel1$ch014_2
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w1_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w1_cont_rel1, aes(x=factor(ch014_2))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 2") + ylab("Frequency") 

vari <- SHARE_w1_cont_rel1$ch014_3
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w1_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w1_cont_rel1, aes(x=factor(ch014_3))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 3") + ylab("Frequency") 

vari <- SHARE_w1_cont_rel1$ch014_4
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w1_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w1_cont_rel1, aes(x=factor(ch014_4))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 4") + ylab("Frequency") 




vari <- SHARE_w1_cont_rel2$dn032_2
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w1_cont_rel2$dn032_1, missing_values = NA)
ggplot(SHARE_w1_cont_rel2, aes(x=factor(dn032_2))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("personal contact with parent during past 12 months: mother") + ylab("Frequency") 



vari <- SHARE_w1_cont_rel3$cv018_3
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w1_home_rel$cv018_2, missing_values = NA)
ggplot(SHARE_w1_cont_rel3, aes(x=factor(cv018_3))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("relation hhmember to respondent") + ylab("Frequency") 

vari <- SHARE_w1_cont_rel3$cv018_4
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w1_home_rel$cv018_2, missing_values = NA)
ggplot(SHARE_w1_cont_rel3, aes(x=factor(cv018_4))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("relation hhmember to respondent") + ylab("Frequency")

vari <- SHARE_w1_cont_rel3$cv018_5
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w1_home_rel$cv018_2, missing_values = NA)
ggplot(SHARE_w1_cont_rel3, aes(x=factor(cv018_5))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("relation hhmember to respondent") + ylab("Frequency")

vari <- SHARE_w1_cont_rel3$cv018_6
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w1_home_rel$cv018_2, missing_values = NA)
ggplot(SHARE_w1_cont_rel3, aes(x=factor(cv018_6))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("relation hhmember to respondent") + ylab("Frequency")

vari <- SHARE_w1_cont_rel3$cv018_7
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w1_home_rel$cv018_2, missing_values = NA)
ggplot(SHARE_w1_cont_rel3, aes(x=factor(cv018_7))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("relation hhmember to respondent") + ylab("Frequency")

vari <- SHARE_w1_cont_rel3$cv018_8
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w1_home_rel$cv018_2, missing_values = NA)
ggplot(SHARE_w1_cont_rel3, aes(x=factor(cv018_8))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("relation hhmember to respondent") + ylab("Frequency")

vari <- SHARE_w1_cont_rel3$cv018_9
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w1_home_rel$cv018_2, missing_values = NA)
ggplot(SHARE_w1_cont_rel3, aes(x=factor(cv018_9))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("relation hhmember to respondent") + ylab("Frequency")



```

#### Harmonisation algorithm
To compute the harmonize variable from the study-specific variable it has to be recoded as follows:

* `if any ch014_1, ch014_2, ch014_3, ch014_4, dn032_1, dn032_2 is in 1:3 or any cv018_2, cv018_3, cv018_4, cv018_5, cv018_6, cv018_7, cv018_8, cv018_9 is in 1:9 then 1`

* `if every ch014_1, ch014_2, ch014_3, ch014_4, dn032_1, dn032_2 is in 4:7 and every  cv018_2, cv018_3, cv018_4, cv018_5, cv018_6, cv018_7, cv018_8, cv018_9 is 10 then 1`

* `-2 into 997`
* `-1 into 998`
* `NA into 999`


**R script:**

```{r harmo1, echo=TRUE}
SHARE_w1_cont_rel4 <- left_join(SHARE_w1_cont_rel1, SHARE_w1_cont_rel2, by='id')[,-7]
names(SHARE_w1_cont_rel4)[2] <- 'hhid'
names(SHARE_w1_cont_rel3)[1] <- 'hhid'
SHARE_w1_cont_rel <- left_join(SHARE_w1_cont_rel4, SHARE_w1_cont_rel3, by='hhid')


SHARE_ds_w1 <- tibble(id=SHARE_w1_cont_rel$id)

SHARE_w1_cont_rel$ch014_1 <- car::recode(as.vector(SHARE_w1_cont_rel$ch014_1), "NA='-999'")
SHARE_w1_cont_rel$ch014_2 <- car::recode(as.vector(SHARE_w1_cont_rel$ch014_2), "NA='-999'")
SHARE_w1_cont_rel$ch014_3 <- car::recode(as.vector(SHARE_w1_cont_rel$ch014_3), "NA='-999'")
SHARE_w1_cont_rel$ch014_4 <- car::recode(as.vector(SHARE_w1_cont_rel$ch014_4), "NA='-999'")
SHARE_w1_cont_rel$dn032_1 <- car::recode(as.vector(SHARE_w1_cont_rel$dn032_1), "NA='-999'")
SHARE_w1_cont_rel$dn032_2 <- car::recode(as.vector(SHARE_w1_cont_rel$dn032_2), "NA='-999'")
SHARE_w1_cont_rel$cv018_2 <- car::recode(as.vector(SHARE_w1_cont_rel$cv018_2), "NA='-999'")
SHARE_w1_cont_rel$cv018_3 <- car::recode(as.vector(SHARE_w1_cont_rel$cv018_3), "NA='-999'")
SHARE_w1_cont_rel$cv018_4 <- car::recode(as.vector(SHARE_w1_cont_rel$cv018_4), "NA='-999'")
SHARE_w1_cont_rel$cv018_5 <- car::recode(as.vector(SHARE_w1_cont_rel$cv018_5), "NA='-999'")
SHARE_w1_cont_rel$cv018_6 <- car::recode(as.vector(SHARE_w1_cont_rel$cv018_6), "NA='-999'")
SHARE_w1_cont_rel$cv018_7 <- car::recode(as.vector(SHARE_w1_cont_rel$cv018_7), "NA='-999'")
SHARE_w1_cont_rel$cv018_8 <- car::recode(as.vector(SHARE_w1_cont_rel$cv018_8), "NA='-999'")
SHARE_w1_cont_rel$cv018_9 <- car::recode(as.vector(SHARE_w1_cont_rel$cv018_9), "NA='-999'")

SHARE_ds_w1$cont_rel <- c(NA)
for(i in 1:dim(SHARE_w1_cont_rel)[1]){
  if( SHARE_w1_cont_rel$ch014_1[i] %in% c(1,2,3) | 
      SHARE_w1_cont_rel$ch014_2[i] %in% c(1,2,3) |
      SHARE_w1_cont_rel$ch014_3[i] %in% c(1,2,3) | 
      SHARE_w1_cont_rel$ch014_4[i] %in% c(1,2,3) |
      SHARE_w1_cont_rel$dn032_1[i] %in% c(1,2,3) | 
      SHARE_w1_cont_rel$dn032_2[i] %in% c(1,2,3) |
      SHARE_w1_cont_rel$cv018_2[i] %in% c(1:9) | 
      SHARE_w1_cont_rel$cv018_3[i] %in% c(1:9) |
      SHARE_w1_cont_rel$cv018_4[i] %in% c(1:9) | 
      SHARE_w1_cont_rel$cv018_5[i] %in% c(1:9) |
      SHARE_w1_cont_rel$cv018_6[i] %in% c(1:9) | 
      SHARE_w1_cont_rel$cv018_7[i] %in% c(1:9) |
      SHARE_w1_cont_rel$cv018_8[i] %in% c(1:9) | 
      SHARE_w1_cont_rel$cv018_9[i] %in% c(1:9)) {
    SHARE_ds_w1$cont_rel[i] = 1 }

  else if( SHARE_w1_cont_rel$ch014_1[i] == -999 & 
           SHARE_w1_cont_rel$ch014_2[i] == -999 &
           SHARE_w1_cont_rel$ch014_3[i] == -999 & 
           SHARE_w1_cont_rel$ch014_4[i] == -999 &
           SHARE_w1_cont_rel$dn032_1[i] == -999 & 
           SHARE_w1_cont_rel$dn032_2[i] == -999 &
           SHARE_w1_cont_rel$cv018_2[i] == -999 & 
           SHARE_w1_cont_rel$cv018_3[i] == -999 &
           SHARE_w1_cont_rel$cv018_4[i] == -999 & 
           SHARE_w1_cont_rel$cv018_5[i] == -999 &
           SHARE_w1_cont_rel$cv018_6[i] == -999 & 
           SHARE_w1_cont_rel$cv018_7[i] == -999 &
           SHARE_w1_cont_rel$cv018_8[i] == -999 & 
           SHARE_w1_cont_rel$cv018_9[i] == -999 ) {
    SHARE_ds_w1$cont_rel[i] = 999 }
  else if( SHARE_w1_cont_rel$ch014_1[i] == -1 & 
           SHARE_w1_cont_rel$ch014_2[i] == -1 &
           SHARE_w1_cont_rel$ch014_3[i] == -1 & 
           SHARE_w1_cont_rel$ch014_4[i] == -1 &
           SHARE_w1_cont_rel$dn032_1[i] == -1 & 
           SHARE_w1_cont_rel$dn032_2[i] == -1 &
           SHARE_w1_cont_rel$cv018_2[i] == -1 & 
           SHARE_w1_cont_rel$cv018_3[i] == -1 &
           SHARE_w1_cont_rel$cv018_4[i] == -1 & 
           SHARE_w1_cont_rel$cv018_5[i] == -1 &
           SHARE_w1_cont_rel$cv018_6[i] == -1 & 
           SHARE_w1_cont_rel$cv018_7[i] == -1 &
           SHARE_w1_cont_rel$cv018_8[i] == -1 & 
           SHARE_w1_cont_rel$cv018_9[i] == -1 ) {
    SHARE_ds_w1$cont_rel[i] = 998 }
  else if( SHARE_w1_cont_rel$ch014_1[i] == -2 & 
           SHARE_w1_cont_rel$ch014_2[i] == -2 &
           SHARE_w1_cont_rel$ch014_3[i] == -2 & 
           SHARE_w1_cont_rel$ch014_4[i] == -2 &
           SHARE_w1_cont_rel$dn032_1[i] == -2 & 
           SHARE_w1_cont_rel$dn032_2[i] == -2 &
           SHARE_w1_cont_rel$cv018_2[i] == -2 & 
           SHARE_w1_cont_rel$cv018_3[i] == -2 &
           SHARE_w1_cont_rel$cv018_4[i] == -2 & 
           SHARE_w1_cont_rel$cv018_5[i] == -2 &
           SHARE_w1_cont_rel$cv018_6[i] == -2 & 
           SHARE_w1_cont_rel$cv018_7[i] == -2 &
           SHARE_w1_cont_rel$cv018_8[i] == -2 & 
           SHARE_w1_cont_rel$cv018_9[i] == -2 ) {
    SHARE_ds_w1$cont_rel[i] = 997 }
    else if( !(SHARE_w1_cont_rel$ch014_1[i] %in% c(1,2,3) | 
      SHARE_w1_cont_rel$ch014_2[i] %in% c(1,2,3) |
      SHARE_w1_cont_rel$ch014_3[i] %in% c(1,2,3) | 
      SHARE_w1_cont_rel$ch014_4[i] %in% c(1,2,3) |
      SHARE_w1_cont_rel$dn032_1[i] %in% c(1,2,3) | 
      SHARE_w1_cont_rel$dn032_2[i] %in% c(1,2,3) |
      SHARE_w1_cont_rel$cv018_2[i] %in% c(1:9) | 
      SHARE_w1_cont_rel$cv018_3[i] %in% c(1:9) |
      SHARE_w1_cont_rel$cv018_4[i] %in% c(1:9) | 
      SHARE_w1_cont_rel$cv018_5[i] %in% c(1:9) |
      SHARE_w1_cont_rel$cv018_6[i] %in% c(1:9) | 
      SHARE_w1_cont_rel$cv018_7[i] %in% c(1:9) |
      SHARE_w1_cont_rel$cv018_8[i] %in% c(1:9) | 
      SHARE_w1_cont_rel$cv018_9[i] %in% c(1:9))) {
    SHARE_ds_w1$cont_rel[i] = 0 }

}

SHARE_ds_w1$cont_rel <- car::recode(as.vector(SHARE_ds_w1$cont_rel), "NA='999'")
SHARE_ds_w1$cont_rel <- labelled(SHARE_ds_w1$cont_rel, labels = c("No"=0, "Yes"=1, "Missing"=999, "Do not know"=998, "Refuse"=997, "Not applicable"=996, "Don't answer"=995,  "Not attempt/not done/not yet recorded"=994, "Disable to measure"=993, "Impute"=992, "CAPI/interviewer error"=991))



```



#### Statistics of the new harmonised variable
```{r descript1, echo=F}
vari <- SHARE_ds_w1$cont_rel
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[3]) 
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[2], caption = "Type of missing")
#Categorical_summary(var = SHARE_ds_w1$cont_rel, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))
ggplot(SHARE_ds_w1, aes(x=factor(cont_rel))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Are any form of contact with family members/relatives frequent") + ylab("Frequency")
```

#### Validation
```{r crosstabulation1, echo=F}

```

 
 


### Wave 2

#### Study-specific variable description

The study-specific variables elected to be harmonised are:
  
* Name: `ch014_1` UP TO `ch014_4` **from table sharew2_rel2-6-0_ch**
* Label: `contact with (selected) child 1`
* Categories:
    + `1 = daily`
    + `2 = several times a week`
    + `3 = about once a week`
    + `4 = about every two weeks`
    + `5 = about once a month`
    + `6 = less than once a month`
    + `7 = never`
* Missings:
    + `-2 = refusal`
    + `-1 = don't know`

* Name: `dn032_2` **from table sharew2_rel2-6-0_dn**
* Label: `personal contact with parent during past 12 months: father`
* Categories:
    + `1 = daily`
    + `2 = several times a week`
    + `3 = about once a week`
    + `4 = about every two weeks`
    + `5 = about once a month`
    + `6 = less than once a month`
    + `7 = never`
* Missings:
    + `-2 = refusal`
    + `-1 = don't know`

* Name: `dn032_1` **from table sharew2_rel2-6-0_dn**
* Label: `personal contact with parent during past 12 months: mother`
* Categories:
    + `1 = daily`
    + `2 = several times a week`
    + `3 = about once a week`
    + `4 = about every two weeks`
    + `5 = about once a month`
    + `6 = less than once a month`
    + `7 = never`
* Missings:
    + `-2 = refusal`
    + `-1 = don't know`

  
* Name: `cv018_2` UP TO `cv018_13` **from table sharew2_rel2-6-0_cv_h**
* Label: `relation hhmember to respondent`
* Categories:
    + `1 = spouse`
    + `2 = partner`
    + `3 = child`
    + `4 = child-in-law`
    + `5 = parent`
    + `6 = parent-in-law`
    + `7 = sibling`
    + `8 = grand-child`
    + `9 = other relative (specify)`
    + `10 = other non-relative (specify)`
    + `11 = ex-spouse/ex-partner`
* Missings:
    + `-2 = refusal`
    + `-1 = don't know`


* Description: 
```{r assign2, echo=F}
opal.assign.table.tibble(o, 'SHARE_w2_cont_rel1','SHARE.sharew2_rel2-6-0_ch', 
                         variables=list('ch014_1','ch014_2','ch014_3','ch014_4', 'hhid'), missings = TRUE)

opal.assign.table.tibble(o, 'SHARE_w2_cont_rel2','SHARE.sharew2_rel2-6-0_dn', 
                         variables=list('dn032_2','dn032_1', 'hhid'), missings = TRUE)

opal.assign.table.tibble(o, 'SHARE_w2_cont_rel3','SHARE.sharew2_rel2-6-0_cv_h', 
                         variables=list('cv018_2','cv018_3','cv018_4','cv018_5','cv018_6','cv018_7','cv018_8','cv018_9',
                                        'cv018_10','cv018_11','cv018_12','cv018_13'), missings = TRUE)

SHARE_w2_cont_rel1 <- opal.execute(o,'SHARE_w2_cont_rel1')
SHARE_w2_cont_rel2 <- opal.execute(o,'SHARE_w2_cont_rel2')
SHARE_w2_cont_rel3 <- opal.execute(o,'SHARE_w2_cont_rel3')

```

```{r local2, echo=F}

vari <- SHARE_w2_cont_rel1$ch014_1
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w1_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w2_cont_rel1, aes(x=factor(ch014_1))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 1") + ylab("Frequency") 

vari <- SHARE_w2_cont_rel1$ch014_2
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w1_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w2_cont_rel1, aes(x=factor(ch014_2))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 2") + ylab("Frequency") 

vari <- SHARE_w2_cont_rel1$ch014_3
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w1_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w2_cont_rel1, aes(x=factor(ch014_3))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 3") + ylab("Frequency") 

vari <- SHARE_w2_cont_rel1$ch014_4
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w1_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w2_cont_rel1, aes(x=factor(ch014_4))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 4") + ylab("Frequency") 




vari <- SHARE_w2_cont_rel2$dn032_2
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w2_cont_rel2$dn032_2, missing_values = NA)
ggplot(SHARE_w2_cont_rel2, aes(x=factor(dn032_2))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("personal contact with parent during past 12 months: father") + ylab("Frequency") 

vari <- SHARE_w2_cont_rel2$dn032_1
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w2_cont_rel2$dn032_1, missing_values = NA)
ggplot(SHARE_w2_cont_rel2, aes(x=factor(dn032_1))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("personal contact with parent during past 12 months: mother") + ylab("Frequency") 


vari <- SHARE_w2_cont_rel3$cv018_2
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w1_home_rel$cv018_2, missing_values = NA)
ggplot(SHARE_w2_cont_rel3, aes(x=factor(cv018_2))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("relation hhmember to respondent") + ylab("Frequency")

vari <- SHARE_w2_cont_rel3$cv018_3
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w1_home_rel$cv018_2, missing_values = NA)
ggplot(SHARE_w2_cont_rel3, aes(x=factor(cv018_3))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("relation hhmember to respondent") + ylab("Frequency")

vari <- SHARE_w2_cont_rel3$cv018_4
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w1_home_rel$cv018_2, missing_values = NA)
ggplot(SHARE_w2_cont_rel3, aes(x=factor(cv018_4))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("relation hhmember to respondent") + ylab("Frequency")

vari <- SHARE_w2_cont_rel3$cv018_5
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w1_home_rel$cv018_2, missing_values = NA)
ggplot(SHARE_w2_cont_rel3, aes(x=factor(cv018_5))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("relation hhmember to respondent") + ylab("Frequency")

vari <- SHARE_w2_cont_rel3$cv018_6
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w1_home_rel$cv018_2, missing_values = NA)
ggplot(SHARE_w2_cont_rel3, aes(x=factor(cv018_6))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("relation hhmember to respondent") + ylab("Frequency")

vari <- SHARE_w2_cont_rel3$cv018_7
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w1_home_rel$cv018_2, missing_values = NA)
ggplot(SHARE_w2_cont_rel3, aes(x=factor(cv018_7))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("relation hhmember to respondent") + ylab("Frequency")

vari <- SHARE_w2_cont_rel3$cv018_8
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w1_home_rel$cv018_2, missing_values = NA)
ggplot(SHARE_w2_cont_rel3, aes(x=factor(cv018_8))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("relation hhmember to respondent") + ylab("Frequency")

vari <- SHARE_w2_cont_rel3$cv018_9
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w1_home_rel$cv018_2, missing_values = NA)
ggplot(SHARE_w2_cont_rel3, aes(x=factor(cv018_9))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("relation hhmember to respondent") + ylab("Frequency")

vari <- SHARE_w2_cont_rel3$cv018_10
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w1_home_rel$cv018_2, missing_values = NA)
ggplot(SHARE_w2_cont_rel3, aes(x=factor(cv018_10))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("relation hhmember to respondent") + ylab("Frequency")

vari <- SHARE_w2_cont_rel3$cv018_11
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w1_home_rel$cv018_2, missing_values = NA)
ggplot(SHARE_w2_cont_rel3, aes(x=factor(cv018_11))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("relation hhmember to respondent") + ylab("Frequency")

vari <- SHARE_w2_cont_rel3$cv018_12
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w1_home_rel$cv018_2, missing_values = NA)
ggplot(SHARE_w2_cont_rel3, aes(x=factor(cv018_12))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("relation hhmember to respondent") + ylab("Frequency")

vari <- SHARE_w2_cont_rel3$cv018_13
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w1_home_rel$cv018_2, missing_values = NA)
ggplot(SHARE_w2_cont_rel3, aes(x=factor(cv018_13))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("relation hhmember to respondent") + ylab("Frequency")

```

#### Harmonisation algorithm
To compute the harmonize variable from the study-specific variable it has to be recoded as follows:
  
* `if any ch014_1, ch014_2, ch014_3, ch014_4, dn032_1, dn032_2 is in 1:3 or any cv018_2, cv018_3, cv018_4, cv018_5, cv018_6, cv018_7, cv018_8, cv018_9, cv018_10, cv018_11, cv018_12, cv018_13 is in 1:9 then 1`

* `if every ch014_1, ch014_2, ch014_3, ch014_4, dn032_1, dn032_2 is in 4:7 and every  cv018_2, cv018_3, cv018_4, cv018_5, cv018_6, cv018_7, cv018_8, cv018_9, cv018_10, cv018_11, cv018_12, cv018_13 is 10 then 1`

* `-2 into 997`
* `-1 into 998`
* `NA into 999`

**R script:**
  
```{r harmo2, echo=TRUE}
SHARE_w2_cont_rel4 <- left_join(SHARE_w2_cont_rel1, SHARE_w2_cont_rel2, by='id')[,-7]
names(SHARE_w2_cont_rel4)[2] <- 'hhid'
names(SHARE_w2_cont_rel3)[1] <- 'hhid'
SHARE_w2_cont_rel <- left_join(SHARE_w2_cont_rel4, SHARE_w2_cont_rel3, by='hhid')

SHARE_ds_w2 <- tibble(id=SHARE_w2_cont_rel$id)

SHARE_w2_cont_rel$ch014_1 <- car::recode(as.vector(SHARE_w2_cont_rel$ch014_1), "NA='-999'")
SHARE_w2_cont_rel$ch014_2 <- car::recode(as.vector(SHARE_w2_cont_rel$ch014_2), "NA='-999'")
SHARE_w2_cont_rel$ch014_3 <- car::recode(as.vector(SHARE_w2_cont_rel$ch014_3), "NA='-999'")
SHARE_w2_cont_rel$ch014_4 <- car::recode(as.vector(SHARE_w2_cont_rel$ch014_4), "NA='-999'")
SHARE_w2_cont_rel$dn032_1 <- car::recode(as.vector(SHARE_w2_cont_rel$dn032_1), "NA='-999'")
SHARE_w2_cont_rel$dn032_2 <- car::recode(as.vector(SHARE_w2_cont_rel$dn032_2), "NA='-999'")
SHARE_w2_cont_rel$cv018_2 <- car::recode(as.vector(SHARE_w2_cont_rel$cv018_2), "NA='-999'")
SHARE_w2_cont_rel$cv018_3 <- car::recode(as.vector(SHARE_w2_cont_rel$cv018_3), "NA='-999'")
SHARE_w2_cont_rel$cv018_4 <- car::recode(as.vector(SHARE_w2_cont_rel$cv018_4), "NA='-999'")
SHARE_w2_cont_rel$cv018_5 <- car::recode(as.vector(SHARE_w2_cont_rel$cv018_5), "NA='-999'")
SHARE_w2_cont_rel$cv018_6 <- car::recode(as.vector(SHARE_w2_cont_rel$cv018_6), "NA='-999'")
SHARE_w2_cont_rel$cv018_7 <- car::recode(as.vector(SHARE_w2_cont_rel$cv018_7), "NA='-999'")
SHARE_w2_cont_rel$cv018_8 <- car::recode(as.vector(SHARE_w2_cont_rel$cv018_8), "NA='-999'")
SHARE_w2_cont_rel$cv018_9 <- car::recode(as.vector(SHARE_w2_cont_rel$cv018_9), "NA='-999'")
SHARE_w2_cont_rel$cv018_10 <- car::recode(as.vector(SHARE_w2_cont_rel$cv018_10), "NA='-999'")
SHARE_w2_cont_rel$cv018_11 <- car::recode(as.vector(SHARE_w2_cont_rel$cv018_11), "NA='-999'")
SHARE_w2_cont_rel$cv018_12 <- car::recode(as.vector(SHARE_w2_cont_rel$cv018_12), "NA='-999'")
SHARE_w2_cont_rel$cv018_13 <- car::recode(as.vector(SHARE_w2_cont_rel$cv018_13), "NA='-999'")


SHARE_ds_w2$cont_rel <- c(NA)
for(i in 1:dim(SHARE_w2_cont_rel)[1]){
  if( SHARE_w2_cont_rel$ch014_1[i] %in% c(1,2,3) | 
      SHARE_w2_cont_rel$ch014_2[i] %in% c(1,2,3) |
      SHARE_w2_cont_rel$ch014_3[i] %in% c(1,2,3) | 
      SHARE_w2_cont_rel$ch014_4[i] %in% c(1,2,3) |
      SHARE_w2_cont_rel$dn032_1[i] %in% c(1,2,3) | 
      SHARE_w2_cont_rel$dn032_2[i] %in% c(1,2,3) |
      SHARE_w2_cont_rel$cv018_2[i] %in% c(1:9) | 
      SHARE_w2_cont_rel$cv018_3[i] %in% c(1:9) |
      SHARE_w2_cont_rel$cv018_4[i] %in% c(1:9) | 
      SHARE_w2_cont_rel$cv018_5[i] %in% c(1:9) |
      SHARE_w2_cont_rel$cv018_6[i] %in% c(1:9) | 
      SHARE_w2_cont_rel$cv018_7[i] %in% c(1:9) |
      SHARE_w2_cont_rel$cv018_8[i] %in% c(1:9) | 
      SHARE_w2_cont_rel$cv018_9[i] %in% c(1:9) |
      SHARE_w2_cont_rel$cv018_10[i] %in% c(1:9) |
      SHARE_w2_cont_rel$cv018_11[i] %in% c(1:9) |
      SHARE_w2_cont_rel$cv018_12[i] %in% c(1:9) |
      SHARE_w2_cont_rel$cv018_13[i] %in% c(1:9) ) {
    SHARE_ds_w2$cont_rel[i] = 1 }

  else if( SHARE_w2_cont_rel$ch014_1[i] == -999 & 
           SHARE_w2_cont_rel$ch014_2[i] == -999 &
           SHARE_w2_cont_rel$ch014_3[i] == -999 & 
           SHARE_w2_cont_rel$ch014_4[i] == -999 &
           SHARE_w2_cont_rel$dn032_1[i] == -999 & 
           SHARE_w2_cont_rel$dn032_2[i] == -999 &
           SHARE_w2_cont_rel$cv018_2[i] == -999 & 
           SHARE_w2_cont_rel$cv018_3[i] == -999 &
           SHARE_w2_cont_rel$cv018_4[i] == -999 & 
           SHARE_w2_cont_rel$cv018_5[i] == -999 &
           SHARE_w2_cont_rel$cv018_6[i] == -999 & 
           SHARE_w2_cont_rel$cv018_7[i] == -999 &
           SHARE_w2_cont_rel$cv018_8[i] == -999 & 
           SHARE_w2_cont_rel$cv018_9[i] == -999 &
           SHARE_w2_cont_rel$cv018_10[i] == -999 & 
           SHARE_w2_cont_rel$cv018_11[i] == -999 & 
           SHARE_w2_cont_rel$cv018_12[i] == -999 & 
           SHARE_w2_cont_rel$cv018_13[i] == -999 ) {
    SHARE_ds_w2$cont_rel[i] = 999 }
  else if( SHARE_w2_cont_rel$ch014_1[i] == -1 & 
           SHARE_w2_cont_rel$ch014_2[i] == -1 &
           SHARE_w2_cont_rel$ch014_3[i] == -1 & 
           SHARE_w2_cont_rel$ch014_4[i] == -1 &
           SHARE_w2_cont_rel$dn032_1[i] == -1 & 
           SHARE_w2_cont_rel$dn032_2[i] == -1 &
           SHARE_w2_cont_rel$cv018_2[i] == -1 & 
           SHARE_w2_cont_rel$cv018_3[i] == -1 &
           SHARE_w2_cont_rel$cv018_4[i] == -1 & 
           SHARE_w2_cont_rel$cv018_5[i] == -1 &
           SHARE_w2_cont_rel$cv018_6[i] == -1 & 
           SHARE_w2_cont_rel$cv018_7[i] == -1 &
           SHARE_w2_cont_rel$cv018_8[i] == -1 & 
           SHARE_w2_cont_rel$cv018_9[i] == -1 &
           SHARE_w2_cont_rel$cv018_10[i] == -1 &
           SHARE_w2_cont_rel$cv018_11[i] == -1 &
           SHARE_w2_cont_rel$cv018_12[i] == -1 &
           SHARE_w2_cont_rel$cv018_13[i] == -1 ) {
    SHARE_ds_w2$cont_rel[i] = 998 }
  else if( SHARE_w2_cont_rel$ch014_1[i] == -2 & 
           SHARE_w2_cont_rel$ch014_2[i] == -2 &
           SHARE_w2_cont_rel$ch014_3[i] == -2 & 
           SHARE_w2_cont_rel$ch014_4[i] == -2 &
           SHARE_w2_cont_rel$dn032_1[i] == -2 & 
           SHARE_w2_cont_rel$dn032_2[i] == -2 &
           SHARE_w2_cont_rel$cv018_2[i] == -2 & 
           SHARE_w2_cont_rel$cv018_3[i] == -2 &
           SHARE_w2_cont_rel$cv018_4[i] == -2 & 
           SHARE_w2_cont_rel$cv018_5[i] == -2 &
           SHARE_w2_cont_rel$cv018_6[i] == -2 & 
           SHARE_w2_cont_rel$cv018_7[i] == -2 &
           SHARE_w2_cont_rel$cv018_8[i] == -2 & 
           SHARE_w2_cont_rel$cv018_9[i] == -2 &
           SHARE_w2_cont_rel$cv018_10[i] == -2 &
           SHARE_w2_cont_rel$cv018_11[i] == -2 &
           SHARE_w2_cont_rel$cv018_12[i] == -2 &
           SHARE_w2_cont_rel$cv018_13[i] == -2) {
    SHARE_ds_w2$cont_rel[i] = 997 }
    else if( !(SHARE_w2_cont_rel$ch014_1[i] %in% c(1,2,3) | 
      SHARE_w2_cont_rel$ch014_2[i] %in% c(1,2,3) |
      SHARE_w2_cont_rel$ch014_3[i] %in% c(1,2,3) | 
      SHARE_w2_cont_rel$ch014_4[i] %in% c(1,2,3) |
      SHARE_w2_cont_rel$dn032_1[i] %in% c(1,2,3) | 
      SHARE_w2_cont_rel$dn032_2[i] %in% c(1,2,3) |
      SHARE_w2_cont_rel$cv018_2[i] %in% c(1:9) | 
      SHARE_w2_cont_rel$cv018_3[i] %in% c(1:9) |
      SHARE_w2_cont_rel$cv018_4[i] %in% c(1:9) | 
      SHARE_w2_cont_rel$cv018_5[i] %in% c(1:9) |
      SHARE_w2_cont_rel$cv018_6[i] %in% c(1:9) | 
      SHARE_w2_cont_rel$cv018_7[i] %in% c(1:9) |
      SHARE_w2_cont_rel$cv018_8[i] %in% c(1:9) | 
      SHARE_w2_cont_rel$cv018_9[i] %in% c(1:9) |
      SHARE_w2_cont_rel$cv018_10[i] %in% c(1:9) | 
      SHARE_w2_cont_rel$cv018_11[i] %in% c(1:9) | 
      SHARE_w2_cont_rel$cv018_12[i] %in% c(1:9) | 
      SHARE_w2_cont_rel$cv018_13[i] %in% c(1:9)  )) {
    SHARE_ds_w2$cont_rel[i] = 0 }

}

SHARE_ds_w2$cont_rel <- car::recode(as.vector(SHARE_ds_w2$cont_rel), "NA='999'")
SHARE_ds_w2$cont_rel <- labelled(SHARE_ds_w2$cont_rel, labels = c("No"=0, "Yes"=1, "Missing"=999, "Do not know"=998, "Refuse"=997, "Not applicable"=996, "Don't answer"=995,  "Not attempt/not done/not yet recorded"=994, "Disable to measure"=993, "Impute"=992, "CAPI/interviewer error"=991))
```

#### Statistical description of the new harmonised variable
```{r descript2, echo=F}
vari <- SHARE_ds_w2$cont_rel
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[3]) 
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[2], caption = "Type of missing")
#Categorical_summary(var = SHARE_ds_w2$cont_rel, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))
ggplot(SHARE_ds_w2, aes(x=factor(cont_rel))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Are any form of contact with family members/relatives frequent") + ylab("Frequency")
```

#### Validation
```{r crosstabulation2, echo=F}

```

 
### Wave 3
Not found.


### Wave 4

#### Study-specific variable description

The study-specific variables elected to be harmonised are:
  
* Name: `ch014_1` UP TO `ch014_20` **from table sharew4_rel1-1-1_ch**
* Label: `contact with (selected) child 1`
* Categories:
    + `1 = daily`
    + `2 = several times a week`
    + `3 = about once a week`
    + `4 = about every two weeks`
    + `5 = about once a month`
    + `6 = less than once a month`
    + `7 = never`
* Missings:
    + `-2 = refusal`
    + `-1 = don't know`

* Name: `dn032_2` **from table sharew4_rel1-1-1_dn**
* Label: `personal contact with parent during past 12 months: father`
* Categories:
    + `1 = daily`
    + `2 = several times a week`
    + `3 = about once a week`
    + `4 = about every two weeks`
    + `5 = about once a month`
    + `6 = less than once a month`
    + `7 = never`
* Missings:
    + `-2 = refusal`
    + `-1 = don't know`

* Name: `dn032_1` **from table sharew4_rel1-1-1_dn**
* Label: `personal contact with parent during past 12 months: mother`
* Categories:
    + `1 = daily`
    + `2 = several times a week`
    + `3 = about once a week`
    + `4 = about every two weeks`
    + `5 = about once a month`
    + `6 = less than once a month`
    + `7 = never`
* Missings:
    + `-2 = refusal`
    + `-1 = don't know`


* Name: `sn005_1` UP TO `sn005_7` **from table sharew4_rel1-1-1_sn**
* Label: `network relationship:sn person 1`
* Categories:
    + `1 = Spouse/Partner`
    + `2 = Mother`
    + `3 = Father`
    + `4 = Mother-in-law``
    + `5 = Father-in-law`
    + `6 = Stepmother`
    + `7 = Stepfather`
    + `8 = Brother`
    + `9 = Sister`
    + `10 = Child`
    + `11 = Step-child/your current partner's child`
    + `12 = Son-in-law``
    + `13 = Daughter-in-law`
    + `14 = Grandchild`
    + `15 = Grandparent`
    + `16 = Aunt`
    + `17 = Uncle`
    + `18 = Niece`
    + `19 = Nephew`
    + `20 = Other relative`
    + `21 = Friend`
    + `22 = (Ex-)colleague/co-worker`
    + `23 = Neighbour`
    + `24 = Ex-spouse/partner`
    + `25 = Minister, priest, or other clergy`
    + `26 = Therapist or other professional helper`
    + `27 = Housekeeper/Home health care provider`
    + `96 = None of these`
* Missings:
    + `-2 = refusal`
    + `-1 = don't know`
    
    
* Name: `sn007_1` UP TO `sn007_7` **from table sharew4_rel1-1-1_sn**
* Label: `network contact: sn person 1`
* Categories:
    + `1 = daily`
    + `2 = several times a week`
    + `3 = about once a week`
    + `4 = about every two weeks`
    + `5 = about once a month`
    + `6 = less than once a month`
    + `7 = never`
* Missings:
    + `-2 = refusal`
    + `-1 = don't know`

* Name: `sn006_1` UP TO `sn006_7` **from table sharew4_rel1-1-1_sn**
* Label: `network proximity: sn person 1`
* Categories:
    + `1 = In the same household`
    + `2 = In the same building`
    + `3 = Less than 1 kilometre away`
    + `4 = Between 1 and 5 kilometres away`
    + `5 = Between 5 and 25 kilometres away`
    + `6 = Between 25 and 100 kilometres away`
    + `7 = Between 100 and 500 kilometres away`
    + `8 = More than 500 kilometres away`
    + `9 = Country-specific category`
* Missings:
    + `-2 = refusal`
    + `-1 = don't know`
    
    
* Description: 
```{r assign4, echo=F}
opal.assign.table.tibble(o, 'SHARE_w4_cont_rel1','SHARE.sharew4_rel1-1-1_ch', 
                         variables=list('ch014_1','ch014_2','ch014_3','ch014_4','ch014_5','ch014_6','ch014_7','ch014_8','ch014_9','ch014_10','ch014_11','ch014_12','ch014_13','ch014_14','ch014_15','ch014_16',
                                        'ch014_17','ch014_18','ch014_19','ch014_20', 'hhid'), missings = TRUE)

opal.assign.table.tibble(o, 'SHARE_w4_cont_rel2','SHARE.sharew4_rel1-1-1_dn', 
                         variables=list('dn032_2','dn032_1', 'hhid'), missings = TRUE)

opal.assign.table.tibble(o, 'SHARE_w4_cont_rel3','SHARE.sharew4_rel1-1-1_sn', 
                         variables=list('sn005_1','sn005_2','sn005_3','sn005_4','sn005_5','sn005_6','sn005_7','sn006_1', 'sn006_2','sn006_3','sn006_4','sn006_5','sn006_6','sn006_7',
                                        'sn007_1','sn007_2','sn007_3','sn007_4','sn007_5','sn007_6','sn007_7'), missings = TRUE)

SHARE_w4_cont_rel1 <- opal.execute(o,'SHARE_w4_cont_rel1')
SHARE_w4_cont_rel2 <- opal.execute(o,'SHARE_w4_cont_rel2')
SHARE_w4_cont_rel3 <- opal.execute(o,'SHARE_w4_cont_rel3')


```

```{r local4, echo=F}
vari <- SHARE_w4_cont_rel1$ch014_1
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel1, aes(x=factor(ch014_1))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 1") + ylab("Frequency") 

vari <- SHARE_w4_cont_rel1$ch014_2
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel1, aes(x=factor(ch014_2))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 2") + ylab("Frequency") 

vari <- SHARE_w4_cont_rel1$ch014_3
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel1, aes(x=factor(ch014_3))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 3") + ylab("Frequency") 

vari <- SHARE_w4_cont_rel1$ch014_4
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel1, aes(x=factor(ch014_4))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 4") + ylab("Frequency") 

vari <- SHARE_w4_cont_rel1$ch014_5
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel1, aes(x=factor(ch014_5))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 5") + ylab("Frequency") 

vari <- SHARE_w4_cont_rel1$ch014_6
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel1, aes(x=factor(ch014_6))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 6") + ylab("Frequency") 


vari <- SHARE_w4_cont_rel1$ch014_7
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel1, aes(x=factor(ch014_7))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 7") + ylab("Frequency") 


vari <- SHARE_w4_cont_rel1$ch014_8
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel1, aes(x=factor(ch014_8))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 8") + ylab("Frequency") 

vari <- SHARE_w4_cont_rel1$ch014_9
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel1, aes(x=factor(ch014_9))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 9") + ylab("Frequency") 

vari <- SHARE_w4_cont_rel1$ch014_10
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel1, aes(x=factor(ch014_10))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 10") + ylab("Frequency") 

vari <- SHARE_w4_cont_rel1$ch014_11
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel1, aes(x=factor(ch014_11))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 11") + ylab("Frequency") 

vari <- SHARE_w4_cont_rel1$ch014_12
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel1, aes(x=factor(ch014_12))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 12") + ylab("Frequency") 

vari <- SHARE_w4_cont_rel1$ch014_13
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel1, aes(x=factor(ch014_13))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 13") + ylab("Frequency") 

vari <- SHARE_w4_cont_rel1$ch014_14
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel1, aes(x=factor(ch014_14))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 14") + ylab("Frequency") 

vari <- SHARE_w4_cont_rel1$ch014_15
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel1, aes(x=factor(ch014_15))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 15") + ylab("Frequency") 

vari <- SHARE_w4_cont_rel1$ch014_1
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel1, aes(x=factor(ch014_1))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 1") + ylab("Frequency") 

vari <- SHARE_w4_cont_rel1$ch014_16
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel1, aes(x=factor(ch014_16))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 16") + ylab("Frequency") 


vari <- SHARE_w4_cont_rel1$ch014_17
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel1, aes(x=factor(ch014_17))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 17") + ylab("Frequency") 

vari <- SHARE_w4_cont_rel1$ch014_18
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel1, aes(x=factor(ch014_18))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 18") + ylab("Frequency") 

vari <- SHARE_w4_cont_rel1$ch014_19
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel1, aes(x=factor(ch014_19))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 19") + ylab("Frequency") 

vari <- SHARE_w4_cont_rel1$ch014_20
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel1, aes(x=factor(ch014_20))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 20") + ylab("Frequency") 

vari <- SHARE_w4_cont_rel2$dn032_2
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel2$dn032_2, missing_values = NA)
ggplot(SHARE_w4_cont_rel2, aes(x=factor(dn032_2))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("personal contact with parent during past 12 months: father") + ylab("Frequency") 

vari <- SHARE_w4_cont_rel2$dn032_1
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel2$dn032_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel2, aes(x=factor(dn032_1))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("personal contact with parent during past 12 months: mother") + ylab("Frequency") 


vari <- SHARE_w4_cont_rel3$sn005_1
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel3$sn005_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel3, aes(x=factor(sn005_1))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("network relationship:sn person 1") + ylab("Frequency") 

vari <- SHARE_w4_cont_rel3$sn005_2
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel3$sn005_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel3, aes(x=factor(sn005_2))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("network relationship:sn person 2") + ylab("Frequency") 

vari <- SHARE_w4_cont_rel3$sn005_3
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel3$sn005_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel3, aes(x=factor(sn005_3))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("network relationship:sn person 3") + ylab("Frequency") 

vari <- SHARE_w4_cont_rel3$sn005_4
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel3$sn005_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel3, aes(x=factor(sn005_1))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("network relationship:sn person 4") + ylab("Frequency") 

vari <- SHARE_w4_cont_rel3$sn005_5
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel3$sn005_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel3, aes(x=factor(sn005_5))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("network relationship:sn person 5") + ylab("Frequency") 

vari <- SHARE_w4_cont_rel3$sn005_6
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel3$sn005_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel3, aes(x=factor(sn005_6))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("network relationship:sn person 6") + ylab("Frequency") 

vari <- SHARE_w4_cont_rel3$sn005_7
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel3$sn005_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel3, aes(x=factor(sn005_7))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("network relationship:sn person 7") + ylab("Frequency") 

vari <- SHARE_w4_cont_rel3$sn007_1
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel3$sn007_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel3, aes(x=factor(sn007_1))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("network contact: sn person 1") + ylab("Frequency") 


vari <- SHARE_w4_cont_rel3$sn007_2
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel3$sn007_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel3, aes(x=factor(sn007_2))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("network contact: sn person 2") + ylab("Frequency") 

vari <- SHARE_w4_cont_rel3$sn007_3
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel3$sn007_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel3, aes(x=factor(sn007_3))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("network contact: sn person 3") + ylab("Frequency") 

vari <- SHARE_w4_cont_rel3$sn007_4
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel3$sn007_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel3, aes(x=factor(sn007_4))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("network contact: sn person 4") + ylab("Frequency") 

vari <- SHARE_w4_cont_rel3$sn007_5
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel3$sn007_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel3, aes(x=factor(sn007_5))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("network contact: sn person 5") + ylab("Frequency") 

vari <- SHARE_w4_cont_rel3$sn007_6
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel3$sn007_6, missing_values = NA)
ggplot(SHARE_w4_cont_rel3, aes(x=factor(sn007_6))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("network contact: sn person 6") + ylab("Frequency") 

vari <- SHARE_w4_cont_rel3$sn007_7
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel3$sn007_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel3, aes(x=factor(sn007_7))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("network contact: sn person 7") + ylab("Frequency") 


vari <- SHARE_w4_cont_rel3$sn006_1
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel3$sn007_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel3, aes(x=factor(sn006_1))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("network proximity: person 1") + ylab("Frequency") 


vari <- SHARE_w4_cont_rel3$sn006_2
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel3$sn007_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel3, aes(x=factor(sn006_2))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("network proximity: person 2") + ylab("Frequency") 


vari <- SHARE_w4_cont_rel3$sn006_3
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel3$sn007_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel3, aes(x=factor(sn006_3))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("network proximity: person 3") + ylab("Frequency") 


vari <- SHARE_w4_cont_rel3$sn006_4
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel3$sn007_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel3, aes(x=factor(sn006_4))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("network proximity: person 4") + ylab("Frequency") 


vari <- SHARE_w4_cont_rel3$sn006_5
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel3$sn007_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel3, aes(x=factor(sn006_5))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("network proximity: person 5") + ylab("Frequency") 


vari <- SHARE_w4_cont_rel3$sn006_6
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel3$sn007_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel3, aes(x=factor(sn006_6))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("network proximity: person 6") + ylab("Frequency") 


vari <- SHARE_w4_cont_rel3$sn006_7
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w4_cont_rel3$sn007_1, missing_values = NA)
ggplot(SHARE_w4_cont_rel3, aes(x=factor(sn006_7))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("network proximity: person 7") + ylab("Frequency") 


```

#### Harmonisation algorithm
To compute the harmonize variable from the study-specific variable it has to be recoded as follows:
  
* `if any of ch014_i, dn032_i is in 1:3 then 1`
* `if for any i: sn005_i in 1:20 and sn007_i in 1:3 and sn006_i == 1, then 1`

**R script:**
  
```{r harmo4, echo=TRUE}
SHARE_w4_cont_rel12 <- left_join(SHARE_w4_cont_rel2, SHARE_w4_cont_rel1, by='id')


SHARE_w4_cont_rel <- left_join(SHARE_w4_cont_rel12, SHARE_w4_cont_rel3, by='id')


SHARE_ds_w4 <- tibble(id=SHARE_w4_cont_rel$id)

SHARE_w4_cont_rel$ch014_1 <- car::recode(as.vector(SHARE_w4_cont_rel$ch014_1), "NA='-999'")
SHARE_w4_cont_rel$ch014_2 <- car::recode(as.vector(SHARE_w4_cont_rel$ch014_2), "NA='-999'")
SHARE_w4_cont_rel$ch014_3 <- car::recode(as.vector(SHARE_w4_cont_rel$ch014_3), "NA='-999'")
SHARE_w4_cont_rel$ch014_4 <- car::recode(as.vector(SHARE_w4_cont_rel$ch014_4), "NA='-999'")
SHARE_w4_cont_rel$ch014_5 <- car::recode(as.vector(SHARE_w4_cont_rel$ch014_5), "NA='-999'")
SHARE_w4_cont_rel$ch014_6 <- car::recode(as.vector(SHARE_w4_cont_rel$ch014_6), "NA='-999'")
SHARE_w4_cont_rel$ch014_7 <- car::recode(as.vector(SHARE_w4_cont_rel$ch014_7), "NA='-999'")
SHARE_w4_cont_rel$ch014_8 <- car::recode(as.vector(SHARE_w4_cont_rel$ch014_8), "NA='-999'")
SHARE_w4_cont_rel$ch014_9 <- car::recode(as.vector(SHARE_w4_cont_rel$ch014_9), "NA='-999'")
SHARE_w4_cont_rel$ch014_10 <- car::recode(as.vector(SHARE_w4_cont_rel$ch014_10), "NA='-999'")
SHARE_w4_cont_rel$ch014_11 <- car::recode(as.vector(SHARE_w4_cont_rel$ch014_11), "NA='-999'")
SHARE_w4_cont_rel$ch014_12 <- car::recode(as.vector(SHARE_w4_cont_rel$ch014_12), "NA='-999'")
SHARE_w4_cont_rel$ch014_13 <- car::recode(as.vector(SHARE_w4_cont_rel$ch014_13), "NA='-999'")
SHARE_w4_cont_rel$ch014_14 <- car::recode(as.vector(SHARE_w4_cont_rel$ch014_14), "NA='-999'")
SHARE_w4_cont_rel$ch014_15 <- car::recode(as.vector(SHARE_w4_cont_rel$ch014_15), "NA='-999'")
SHARE_w4_cont_rel$ch014_16 <- car::recode(as.vector(SHARE_w4_cont_rel$ch014_16), "NA='-999'")
SHARE_w4_cont_rel$ch014_17 <- car::recode(as.vector(SHARE_w4_cont_rel$ch014_17), "NA='-999'")
SHARE_w4_cont_rel$ch014_18 <- car::recode(as.vector(SHARE_w4_cont_rel$ch014_18), "NA='-999'")
SHARE_w4_cont_rel$ch014_19 <- car::recode(as.vector(SHARE_w4_cont_rel$ch014_19), "NA='-999'")
SHARE_w4_cont_rel$ch014_20 <- car::recode(as.vector(SHARE_w4_cont_rel$ch014_20), "NA='-999'")

SHARE_w4_cont_rel$dn032_1 <- car::recode(as.vector(SHARE_w4_cont_rel$dn032_1), "NA='-999'")
SHARE_w4_cont_rel$dn032_2 <- car::recode(as.vector(SHARE_w4_cont_rel$dn032_2), "NA='-999'")

SHARE_w4_cont_rel$sn005_1 <- car::recode(as.vector(SHARE_w4_cont_rel$sn005_1), "NA='-999'")
SHARE_w4_cont_rel$sn005_2 <- car::recode(as.vector(SHARE_w4_cont_rel$sn005_2), "NA='-999'")
SHARE_w4_cont_rel$sn005_3 <- car::recode(as.vector(SHARE_w4_cont_rel$sn005_3), "NA='-999'")
SHARE_w4_cont_rel$sn005_4 <- car::recode(as.vector(SHARE_w4_cont_rel$sn005_4), "NA='-999'")
SHARE_w4_cont_rel$sn005_5 <- car::recode(as.vector(SHARE_w4_cont_rel$sn005_5), "NA='-999'")
SHARE_w4_cont_rel$sn005_6 <- car::recode(as.vector(SHARE_w4_cont_rel$sn005_6), "NA='-999'")
SHARE_w4_cont_rel$sn005_7 <- car::recode(as.vector(SHARE_w4_cont_rel$sn005_7), "NA='-999'")

SHARE_w4_cont_rel$sn007_1 <- car::recode(as.vector(SHARE_w4_cont_rel$sn007_1), "NA='-999'")
SHARE_w4_cont_rel$sn007_2 <- car::recode(as.vector(SHARE_w4_cont_rel$sn007_2), "NA='-999'")
SHARE_w4_cont_rel$sn007_3 <- car::recode(as.vector(SHARE_w4_cont_rel$sn007_3), "NA='-999'")
SHARE_w4_cont_rel$sn007_4 <- car::recode(as.vector(SHARE_w4_cont_rel$sn007_4), "NA='-999'")
SHARE_w4_cont_rel$sn007_5 <- car::recode(as.vector(SHARE_w4_cont_rel$sn007_5), "NA='-999'")
SHARE_w4_cont_rel$sn007_6 <- car::recode(as.vector(SHARE_w4_cont_rel$sn007_6), "NA='-999'")
SHARE_w4_cont_rel$sn007_7 <- car::recode(as.vector(SHARE_w4_cont_rel$sn007_7), "NA='-999'")

SHARE_w4_cont_rel$sn006_1 <- car::recode(as.vector(SHARE_w4_cont_rel$sn006_1), "NA='-999'")
SHARE_w4_cont_rel$sn006_2 <- car::recode(as.vector(SHARE_w4_cont_rel$sn006_2), "NA='-999'")
SHARE_w4_cont_rel$sn006_3 <- car::recode(as.vector(SHARE_w4_cont_rel$sn006_3), "NA='-999'")
SHARE_w4_cont_rel$sn006_4 <- car::recode(as.vector(SHARE_w4_cont_rel$sn006_4), "NA='-999'")
SHARE_w4_cont_rel$sn006_5 <- car::recode(as.vector(SHARE_w4_cont_rel$sn006_5), "NA='-999'")
SHARE_w4_cont_rel$sn006_6 <- car::recode(as.vector(SHARE_w4_cont_rel$sn006_6), "NA='-999'")
SHARE_w4_cont_rel$sn006_7 <- car::recode(as.vector(SHARE_w4_cont_rel$sn006_7), "NA='-999'")


SHARE_ds_w4$cont_rel <- c(NA)
for(i in 1:dim(SHARE_w4_cont_rel)[1]){
  
  if( SHARE_w4_cont_rel$ch014_1[i] %in% c(1,2,3) | 
      SHARE_w4_cont_rel$ch014_2[i] %in% c(1,2,3) |
      SHARE_w4_cont_rel$ch014_3[i] %in% c(1,2,3) | 
      SHARE_w4_cont_rel$ch014_4[i] %in% c(1,2,3) |
      SHARE_w4_cont_rel$ch014_5[i] %in% c(1,2,3) | 
      SHARE_w4_cont_rel$ch014_6[i] %in% c(1,2,3) |
      SHARE_w4_cont_rel$ch014_7[i] %in% c(1,2,3) | 
      SHARE_w4_cont_rel$ch014_8[i] %in% c(1,2,3) |
      SHARE_w4_cont_rel$ch014_9[i] %in% c(1,2,3) | 
      SHARE_w4_cont_rel$ch014_10[i] %in% c(1,2,3) |
      SHARE_w4_cont_rel$ch014_11[i] %in% c(1,2,3) | 
      SHARE_w4_cont_rel$ch014_12[i] %in% c(1,2,3) |
      SHARE_w4_cont_rel$ch014_13[i] %in% c(1,2,3) | 
      SHARE_w4_cont_rel$ch014_14[i] %in% c(1,2,3) |
      SHARE_w4_cont_rel$ch014_15[i] %in% c(1,2,3) | 
      SHARE_w4_cont_rel$ch014_16[i] %in% c(1,2,3) |
      SHARE_w4_cont_rel$ch014_17[i] %in% c(1,2,3) | 
      SHARE_w4_cont_rel$ch014_18[i] %in% c(1,2,3) |
      SHARE_w4_cont_rel$ch014_19[i] %in% c(1,2,3) | 
      SHARE_w4_cont_rel$ch014_20[i] %in% c(1,2,3) |
      SHARE_w4_cont_rel$dn032_1[i] %in% c(1,2,3) | 
      SHARE_w4_cont_rel$dn032_2[i] %in% c(1,2,3) ) {
    SHARE_ds_w4$cont_rel[i] = 1 }
  
  else if( (SHARE_w4_cont_rel$sn005_1[i] %in% c(1:20)  & SHARE_w4_cont_rel$sn006_1[i] ==1 & SHARE_w4_cont_rel$sn007_1[i] %in% c(1,2,3)) |
           (SHARE_w4_cont_rel$sn005_2[i] %in% c(1:20)  & SHARE_w4_cont_rel$sn006_2[i] ==1& SHARE_w4_cont_rel$sn007_2[i] %in% c(1,2,3)) |
           (SHARE_w4_cont_rel$sn005_3[i] %in% c(1:20)  & SHARE_w4_cont_rel$sn006_3[i] ==1& SHARE_w4_cont_rel$sn007_3[i] %in% c(1,2,3)) |
           (SHARE_w4_cont_rel$sn005_4[i] %in% c(1:20)  & SHARE_w4_cont_rel$sn006_4[i] ==1& SHARE_w4_cont_rel$sn007_4[i] %in% c(1,2,3)) |
           (SHARE_w4_cont_rel$sn005_5[i] %in% c(1:20)  & SHARE_w4_cont_rel$sn006_5[i] ==1& SHARE_w4_cont_rel$sn007_5[i] %in% c(1,2,3)) |
           (SHARE_w4_cont_rel$sn005_6[i] %in% c(1:20)  & SHARE_w4_cont_rel$sn006_6[i] ==1& SHARE_w4_cont_rel$sn007_6[i] %in% c(1,2,3)) |
           (SHARE_w4_cont_rel$sn005_7[i] %in% c(1:20)  & SHARE_w4_cont_rel$sn006_7[i] ==1& SHARE_w4_cont_rel$sn007_7[i] %in% c(1,2,3)) ){
    SHARE_ds_w4$cont_rel[i] = 1 }
  
  else if( !( SHARE_w4_cont_rel$ch014_1[i] %in% c(1,2,3) | SHARE_w4_cont_rel$ch014_2[i] %in% c(1,2,3) |
      SHARE_w4_cont_rel$ch014_3[i] %in% c(1,2,3) | SHARE_w4_cont_rel$ch014_4[i] %in% c(1,2,3) |
      SHARE_w4_cont_rel$ch014_5[i] %in% c(1,2,3) | SHARE_w4_cont_rel$ch014_6[i] %in% c(1,2,3) |
      SHARE_w4_cont_rel$ch014_7[i] %in% c(1,2,3) | SHARE_w4_cont_rel$ch014_8[i] %in% c(1,2,3) |
      SHARE_w4_cont_rel$ch014_9[i] %in% c(1,2,3) | SHARE_w4_cont_rel$ch014_10[i] %in% c(1,2,3) |
      SHARE_w4_cont_rel$ch014_11[i] %in% c(1,2,3) | SHARE_w4_cont_rel$ch014_12[i] %in% c(1,2,3) |
      SHARE_w4_cont_rel$ch014_13[i] %in% c(1,2,3) | SHARE_w4_cont_rel$ch014_14[i] %in% c(1,2,3) |
      SHARE_w4_cont_rel$ch014_15[i] %in% c(1,2,3) | SHARE_w4_cont_rel$ch014_16[i] %in% c(1,2,3) |
      SHARE_w4_cont_rel$ch014_17[i] %in% c(1,2,3) | SHARE_w4_cont_rel$ch014_18[i] %in% c(1,2,3) |
      SHARE_w4_cont_rel$ch014_19[i] %in% c(1,2,3) | SHARE_w4_cont_rel$ch014_20[i] %in% c(1,2,3) |
      SHARE_w4_cont_rel$dn032_1[i] %in% c(1,2,3) | SHARE_w4_cont_rel$dn032_2[i] %in% c(1,2,3) ) |
      !( (SHARE_w4_cont_rel$sn005_1[i] %in% c(1:20) & SHARE_w4_cont_rel$sn006_1[i] ==1& SHARE_w4_cont_rel$sn007_1[i] %in% c(1,2,3)) |
           (SHARE_w4_cont_rel$sn005_2[i] %in% c(1:20) & SHARE_w4_cont_rel$sn006_2[i] ==1& SHARE_w4_cont_rel$sn007_2[i] %in% c(1,2,3)) |
           (SHARE_w4_cont_rel$sn005_3[i] %in% c(1:20) & SHARE_w4_cont_rel$sn006_3[i] ==1& SHARE_w4_cont_rel$sn007_3[i] %in% c(1,2,3)) |
           (SHARE_w4_cont_rel$sn005_4[i] %in% c(1:20) & SHARE_w4_cont_rel$sn006_4[i] ==1& SHARE_w4_cont_rel$sn007_4[i] %in% c(1,2,3)) |
           (SHARE_w4_cont_rel$sn005_5[i] %in% c(1:20) & SHARE_w4_cont_rel$sn006_5[i] ==1& SHARE_w4_cont_rel$sn007_5[i] %in% c(1,2,3)) |
           (SHARE_w4_cont_rel$sn005_6[i] %in% c(1:20) & SHARE_w4_cont_rel$sn006_6[i] ==1& SHARE_w4_cont_rel$sn007_6[i] %in% c(1,2,3)) |
           (SHARE_w4_cont_rel$sn005_7[i] %in% c(1:20) & SHARE_w4_cont_rel$sn006_7[i] ==1& SHARE_w4_cont_rel$sn007_7[i] %in% c(1,2,3)) ) ) {
    SHARE_ds_w4$cont_rel[i] = 0 }
}

SHARE_ds_w4$cont_rel <- car::recode(as.vector(SHARE_ds_w4$cont_rel), "NA='999'")
SHARE_ds_w4$cont_rel <- labelled(SHARE_ds_w4$cont_rel, labels = c("No"=0, "Yes"=1, "Missing"=999, "Do not know"=998, "Refuse"=997, "Not applicable"=996, "Don't answer"=995,  "Not attempt/not done/not yet recorded"=994, "Disable to measure"=993, "Impute"=992, "CAPI/interviewer error"=991))


```

#### Statistical description of the new harmonised variable
```{r descript4, echo=F}
vari <- SHARE_ds_w4$cont_rel
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[3]) 
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[2], caption = "Type of missing")
#Categorical_summary(var = SHARE_ds_w4$cont_rel, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))
ggplot(SHARE_ds_w4, aes(x=factor(cont_rel))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Are any form of contact (face-to-face/phone/mail/Internet communicators) with family members/relatives frequent") + ylab("Frequency")
```

#### Validation
```{r crosstabulation4, echo=F}

```

 
 



### Wave 5

#### Study-specific variable description

The study-specific variables elected to be harmonised are:
  
* Name: `ch014_1` UP TO `ch014_20` **from table sharew5_rel1-0-0_ch**
* Label: `contact with (selected) child 1`
* Categories:
    + `1 = daily`
    + `2 = several times a week`
    + `3 = about once a week`
    + `4 = about every two weeks`
    + `5 = about once a month`
    + `6 = less than once a month`
    + `7 = never`
* Missings:
    + `-2 = refusal`
    + `-1 = don't know`

* Name: `dn032_2` **from table sharew5_rel1-0-0_dn**
* Label: `personal contact with parent during past 12 months: father`
* Categories:
    + `1 = daily`
    + `2 = several times a week`
    + `3 = about once a week`
    + `4 = about every two weeks`
    + `5 = about once a month`
    + `6 = less than once a month`
    + `7 = never`
* Missings:
    + `-2 = refusal`
    + `-1 = don't know`

* Name: `dn032_1` **from table sharew5_rel1-0-0_dn**
* Label: `personal contact with parent during past 12 months: mother`
* Categories:
    + `1 = daily`
    + `2 = several times a week`
    + `3 = about once a week`
    + `4 = about every two weeks`
    + `5 = about once a month`
    + `6 = less than once a month`
    + `7 = never`
* Missings:
    + `-2 = refusal`
    + `-1 = don't know`

* Name: `ch007_1` UP TO `ch007_20` **from table sharew5_rel1-0-0_ch**
* Label: `Child 1 where does child live`
* Categories:
    + `1 = In the same household`
    + `2 = In the same building`
    + `3 = Less than 1 kilometre away`
    + `4 = Between 1 and 5 kilometres away`
    + `5 = Between 5 and 25 kilometres away`
    + `6 = Between 25 and 100 kilometres away`
    + `7 = Between 100 and 500 kilometres away`
    + `8 = More than 500 kilometres away`
    + `9 = More than 500 kilometres away in another country`
* Missings:
    + `-2 = refusal`
    + `-1 = don't know`

* Description: 
```{r assign5, echo=F}
opal.assign.table.tibble(o, 'SHARE_w5_cont_rel1','SHARE.sharew5_rel1-0-0_ch', 
                         variables=list('ch014_1','ch014_2','ch014_3','ch014_4','ch014_5','ch014_6','ch014_7','ch014_8','ch014_9','ch014_10','ch014_11','ch014_12','ch014_13','ch014_14','ch014_15','ch014_16',
                                        'ch014_17','ch014_18','ch014_19','ch014_20', 'hhid'), missings = TRUE)

opal.assign.table.tibble(o, 'SHARE_w5_cont_rel2','SHARE.sharew5_rel1-0-0_dn', 
                         variables=list('dn032_2','dn032_1', 'hhid'), missings = TRUE)

opal.assign.table.tibble(o, 'SHARE_w5_cont_rel3','SHARE.sharew5_rel1-0-0_ch', 
                         variables=list('ch007_1','ch007_2','ch007_3','ch007_4','ch007_5','ch007_6','ch007_7','ch007_8',
                                        'ch007_9','ch007_10','ch007_11','ch007_12','ch007_13','ch007_14','ch007_15',
                                        'ch007_16','ch007_17','ch007_18','ch007_19','ch007_20'), missings = TRUE)

SHARE_w5_cont_rel1 <- opal.execute(o,'SHARE_w5_cont_rel1')
SHARE_w5_cont_rel2 <- opal.execute(o,'SHARE_w5_cont_rel2')
SHARE_w5_cont_rel3 <- opal.execute(o,'SHARE_w5_cont_rel3')

```

```{r local5, echo=F}


vari <- SHARE_w5_cont_rel1$ch014_1
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w5_cont_rel1, aes(x=factor(ch014_1))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 1") + ylab("Frequency") 

vari <- SHARE_w5_cont_rel1$ch014_2
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w5_cont_rel1, aes(x=factor(ch014_2))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 2") + ylab("Frequency") 

vari <- SHARE_w5_cont_rel1$ch014_3
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w5_cont_rel1, aes(x=factor(ch014_3))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 3") + ylab("Frequency") 

vari <- SHARE_w5_cont_rel1$ch014_4
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w5_cont_rel1, aes(x=factor(ch014_4))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 4") + ylab("Frequency") 

vari <- SHARE_w5_cont_rel1$ch014_5
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w5_cont_rel1, aes(x=factor(ch014_5))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 5") + ylab("Frequency") 

vari <- SHARE_w5_cont_rel1$ch014_6
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w5_cont_rel1, aes(x=factor(ch014_6))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 6") + ylab("Frequency") 

vari <- SHARE_w5_cont_rel1$ch014_7
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w5_cont_rel1, aes(x=factor(ch014_7))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 7") + ylab("Frequency") 

vari <- SHARE_w5_cont_rel1$ch014_8
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w5_cont_rel1, aes(x=factor(ch014_8))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 8") + ylab("Frequency") 

vari <- SHARE_w5_cont_rel1$ch014_9
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w5_cont_rel1, aes(x=factor(ch014_9))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 1") + ylab("Frequency") 

vari <- SHARE_w5_cont_rel1$ch014_10
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w5_cont_rel1, aes(x=factor(ch014_10))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 10") + ylab("Frequency") 

vari <- SHARE_w5_cont_rel1$ch014_11
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w5_cont_rel1, aes(x=factor(ch014_11))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 11") + ylab("Frequency") 

vari <- SHARE_w5_cont_rel1$ch014_12
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w5_cont_rel1, aes(x=factor(ch014_12))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 12") + ylab("Frequency") 



vari <- SHARE_w5_cont_rel1$ch014_13
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w5_cont_rel1, aes(x=factor(ch014_13))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 13") + ylab("Frequency") 

vari <- SHARE_w5_cont_rel1$ch014_14
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w5_cont_rel1, aes(x=factor(ch014_14))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 14") + ylab("Frequency") 

vari <- SHARE_w5_cont_rel1$ch014_15
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w5_cont_rel1, aes(x=factor(ch014_15))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 1") + ylab("Frequency") 


vari <- SHARE_w5_cont_rel1$ch014_16
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w5_cont_rel1, aes(x=factor(ch014_16))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 16") + ylab("Frequency") 

vari <- SHARE_w5_cont_rel1$ch014_17
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w5_cont_rel1, aes(x=factor(ch014_17))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 17") + ylab("Frequency")

vari <- SHARE_w5_cont_rel1$ch014_18
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w5_cont_rel1, aes(x=factor(ch014_18))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 18") + ylab("Frequency") 


vari <- SHARE_w5_cont_rel1$ch014_19
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w5_cont_rel1, aes(x=factor(ch014_19))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 19") + ylab("Frequency") 

vari <- SHARE_w5_cont_rel1$ch014_20
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel1$ch014_1, missing_values = NA)
ggplot(SHARE_w5_cont_rel1, aes(x=factor(ch014_20))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("contact with (selected) child 20") + ylab("Frequency") 

vari <- SHARE_w5_cont_rel2$dn032_2
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel2$dn032_2, missing_values = NA)
ggplot(SHARE_w5_cont_rel2, aes(x=factor(dn032_2))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("personal contact with parent during past 12 months: father") + ylab("Frequency") 

vari <- SHARE_w5_cont_rel2$dn032_1
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel2$dn032_1, missing_values = NA)
ggplot(SHARE_w5_cont_rel2, aes(x=factor(dn032_1))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("personal contact with parent during past 12 months: mother") + ylab("Frequency") 

vari <- SHARE_w5_cont_rel3$ch007_1
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel$ch007_1, missing_values = NA)
ggplot(SHARE_w5_cont_rel3, aes(x=factor(ch007_1))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Child 1 where does child live") + ylab("Frequency") 

vari <- SHARE_w5_cont_rel3$ch007_2
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel$ch007_2, missing_values = NA)
ggplot(SHARE_w5_cont_rel3, aes(x=factor(ch007_2))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Child 1 where does child live") + ylab("Frequency") 

vari <- SHARE_w5_cont_rel3$ch007_3
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel$ch007_3, missing_values = NA)
ggplot(SHARE_w5_cont_rel3, aes(x=factor(ch007_3))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Child 1 where does child live") + ylab("Frequency") 

vari <- SHARE_w5_cont_rel3$ch007_4
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel$ch007_4, missing_values = NA)
ggplot(SHARE_w5_cont_rel3, aes(x=factor(ch007_4))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Child 1 where does child live") + ylab("Frequency") 

vari <- SHARE_w5_cont_rel3$ch007_5
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel$ch007_5, missing_values = NA)
ggplot(SHARE_w5_cont_rel3, aes(x=factor(ch007_5))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Child 1 where does child live") + ylab("Frequency") 

vari <- SHARE_w5_cont_rel3$ch007_6
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel$ch007_6, missing_values = NA)
ggplot(SHARE_w5_cont_rel3, aes(x=factor(ch007_6))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Child 1 where does child live") + ylab("Frequency") 

vari <- SHARE_w5_cont_rel3$ch007_7
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel$ch007_7, missing_values = NA)
ggplot(SHARE_w5_cont_rel3, aes(x=factor(ch007_7))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Child 1 where does child live") + ylab("Frequency") 

vari <- SHARE_w5_cont_rel3$ch007_8
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel$ch007_8, missing_values = NA)
ggplot(SHARE_w5_cont_rel3, aes(x=factor(ch007_8))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Child 1 where does child live") + ylab("Frequency") 

vari <- SHARE_w5_cont_rel3$ch007_9
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel$ch007_9, missing_values = NA)
ggplot(SHARE_w5_cont_rel3, aes(x=factor(ch007_9))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Child 1 where does child live") + ylab("Frequency") 

vari <- SHARE_w5_cont_rel3$ch007_10
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel$ch007_10, missing_values = NA)
ggplot(SHARE_w5_cont_rel3, aes(x=factor(ch007_10))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Child 1 where does child live") + ylab("Frequency") 

vari <- SHARE_w5_cont_rel3$ch007_11
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel$ch007_11, missing_values = NA)
ggplot(SHARE_w5_cont_rel3, aes(x=factor(ch007_11))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Child 1 where does child live") + ylab("Frequency") 

vari <- SHARE_w5_cont_rel3$ch007_12
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel$ch007_12, missing_values = NA)
ggplot(SHARE_w5_cont_rel3, aes(x=factor(ch007_12))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Child 1 where does child live") + ylab("Frequency") 

vari <- SHARE_w5_cont_rel3$ch007_13
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel$ch007_13, missing_values = NA)
ggplot(SHARE_w5_cont_rel3, aes(x=factor(ch007_13))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Child 1 where does child live") + ylab("Frequency") 

vari <- SHARE_w5_cont_rel3$ch007_14
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel$ch007_14, missing_values = NA)
ggplot(SHARE_w5_cont_rel3, aes(x=factor(ch007_14))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Child 1 where does child live") + ylab("Frequency") 

vari <- SHARE_w5_cont_rel3$ch007_15
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel$ch007_15, missing_values = NA)
ggplot(SHARE_w5_cont_rel3, aes(x=factor(ch007_15))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Child 1 where does child live") + ylab("Frequency") 

vari <- SHARE_w5_cont_rel3$ch007_16
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel$ch007_16, missing_values = NA)
ggplot(SHARE_w5_cont_rel3, aes(x=factor(ch007_16))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Child 1 where does child live") + ylab("Frequency") 

vari <- SHARE_w5_cont_rel3$ch007_17
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel$ch007_17, missing_values = NA)
ggplot(SHARE_w5_cont_rel3, aes(x=factor(ch007_17))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Child 1 where does child live") + ylab("Frequency") 

vari <- SHARE_w5_cont_rel3$ch007_18
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel$ch007_18, missing_values = NA)
ggplot(SHARE_w5_cont_rel3, aes(x=factor(ch007_18))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Child 1 where does child live") + ylab("Frequency") 

vari <- SHARE_w5_cont_rel3$ch007_19
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel$ch007_19, missing_values = NA)
ggplot(SHARE_w5_cont_rel3, aes(x=factor(ch007_19))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Child 1 where does child live") + ylab("Frequency") 

vari <- SHARE_w5_cont_rel3$ch007_20
kable(Categorical_summary(vari, missing_values = c(-2,-1))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(-2,-1))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(-2,-1))[2], caption = "Type of missing")
#Categorical_summary(var =SHARE_w5_cont_rel$ch007_20, missing_values = NA)
ggplot(SHARE_w5_cont_rel3, aes(x=factor(ch007_20))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Child 1 where does child live") + ylab("Frequency") 
```

#### Harmonisation algorithm
To compute the harmonize variable from the study-specific variable it has to be recoded as follows:
  
* `if any ch014_i, dn032_2_i is in 1:3 then 1`
* `if any ch007_i equals 1 then 1`
**R script:**
  
```{r harmo5, echo=TRUE}


SHARE_w5_cont_rel12 <- left_join(SHARE_w5_cont_rel1, SHARE_w5_cont_rel2, by='id')
SHARE_w5_cont_rel <- left_join(SHARE_w5_cont_rel3, SHARE_w5_cont_rel12, by='id')


SHARE_ds_w5 <- tibble(id=SHARE_w5_cont_rel$id)

SHARE_w5_cont_rel$ch014_1 <- car::recode(as.vector(SHARE_w5_cont_rel$ch014_1), "NA='-999'")
SHARE_w5_cont_rel$ch014_2 <- car::recode(as.vector(SHARE_w5_cont_rel$ch014_2), "NA='-999'")
SHARE_w5_cont_rel$ch014_3 <- car::recode(as.vector(SHARE_w5_cont_rel$ch014_3), "NA='-999'")
SHARE_w5_cont_rel$ch014_4 <- car::recode(as.vector(SHARE_w5_cont_rel$ch014_4), "NA='-999'")
SHARE_w5_cont_rel$ch014_5 <- car::recode(as.vector(SHARE_w5_cont_rel$ch014_5), "NA='-999'")
SHARE_w5_cont_rel$ch014_6 <- car::recode(as.vector(SHARE_w5_cont_rel$ch014_6), "NA='-999'")
SHARE_w5_cont_rel$ch014_7 <- car::recode(as.vector(SHARE_w5_cont_rel$ch014_7), "NA='-999'")
SHARE_w5_cont_rel$ch014_8 <- car::recode(as.vector(SHARE_w5_cont_rel$ch014_8), "NA='-999'")
SHARE_w5_cont_rel$ch014_9 <- car::recode(as.vector(SHARE_w5_cont_rel$ch014_9), "NA='-999'")
SHARE_w5_cont_rel$ch014_10 <- car::recode(as.vector(SHARE_w5_cont_rel$ch014_10), "NA='-999'")
SHARE_w5_cont_rel$ch014_11 <- car::recode(as.vector(SHARE_w5_cont_rel$ch014_11), "NA='-999'")
SHARE_w5_cont_rel$ch014_12 <- car::recode(as.vector(SHARE_w5_cont_rel$ch014_12), "NA='-999'")
SHARE_w5_cont_rel$ch014_13 <- car::recode(as.vector(SHARE_w5_cont_rel$ch014_13), "NA='-999'")
SHARE_w5_cont_rel$ch014_14 <- car::recode(as.vector(SHARE_w5_cont_rel$ch014_14), "NA='-999'")
SHARE_w5_cont_rel$ch014_15 <- car::recode(as.vector(SHARE_w5_cont_rel$ch014_15), "NA='-999'")
SHARE_w5_cont_rel$ch014_16 <- car::recode(as.vector(SHARE_w5_cont_rel$ch014_16), "NA='-999'")
SHARE_w5_cont_rel$ch014_17 <- car::recode(as.vector(SHARE_w5_cont_rel$ch014_17), "NA='-999'")
SHARE_w5_cont_rel$ch014_18 <- car::recode(as.vector(SHARE_w5_cont_rel$ch014_18), "NA='-999'")
SHARE_w5_cont_rel$ch014_19 <- car::recode(as.vector(SHARE_w5_cont_rel$ch014_19), "NA='-999'")
SHARE_w5_cont_rel$ch014_20 <- car::recode(as.vector(SHARE_w5_cont_rel$ch014_20), "NA='-999'")
SHARE_w5_cont_rel$dn032_1 <- car::recode(as.vector(SHARE_w5_cont_rel$dn032_1), "NA='-999'")
SHARE_w5_cont_rel$dn032_2 <- car::recode(as.vector(SHARE_w5_cont_rel$dn032_2), "NA='-999'")

SHARE_w5_cont_rel$ch007_1 <- car::recode(as.vector(SHARE_w5_cont_rel$ch007_1), "NA='-999'")
SHARE_w5_cont_rel$ch007_2 <- car::recode(as.vector(SHARE_w5_cont_rel$ch007_2), "NA='-999'")
SHARE_w5_cont_rel$ch007_3 <- car::recode(as.vector(SHARE_w5_cont_rel$ch007_3), "NA='-999'")
SHARE_w5_cont_rel$ch007_4 <- car::recode(as.vector(SHARE_w5_cont_rel$ch007_4), "NA='-999'")
SHARE_w5_cont_rel$ch007_5 <- car::recode(as.vector(SHARE_w5_cont_rel$ch007_5), "NA='-999'")
SHARE_w5_cont_rel$ch007_6 <- car::recode(as.vector(SHARE_w5_cont_rel$ch007_6), "NA='-999'")
SHARE_w5_cont_rel$ch007_7 <- car::recode(as.vector(SHARE_w5_cont_rel$ch007_7), "NA='-999'")
SHARE_w5_cont_rel$ch007_8 <- car::recode(as.vector(SHARE_w5_cont_rel$ch007_8), "NA='-999'")
SHARE_w5_cont_rel$ch007_9 <- car::recode(as.vector(SHARE_w5_cont_rel$ch007_9), "NA='-999'")
SHARE_w5_cont_rel$ch007_10 <- car::recode(as.vector(SHARE_w5_cont_rel$ch007_10), "NA='-999'")
SHARE_w5_cont_rel$ch007_11 <- car::recode(as.vector(SHARE_w5_cont_rel$ch007_11), "NA='-999'")
SHARE_w5_cont_rel$ch007_12 <- car::recode(as.vector(SHARE_w5_cont_rel$ch007_12), "NA='-999'")
SHARE_w5_cont_rel$ch007_13 <- car::recode(as.vector(SHARE_w5_cont_rel$ch007_13), "NA='-999'")
SHARE_w5_cont_rel$ch007_14 <- car::recode(as.vector(SHARE_w5_cont_rel$ch007_14), "NA='-999'")
SHARE_w5_cont_rel$ch007_15 <- car::recode(as.vector(SHARE_w5_cont_rel$ch007_15), "NA='-999'")
SHARE_w5_cont_rel$ch007_16 <- car::recode(as.vector(SHARE_w5_cont_rel$ch007_16), "NA='-999'")
SHARE_w5_cont_rel$ch007_17 <- car::recode(as.vector(SHARE_w5_cont_rel$ch007_17), "NA='-999'")
SHARE_w5_cont_rel$ch007_18 <- car::recode(as.vector(SHARE_w5_cont_rel$ch007_18), "NA='-999'")
SHARE_w5_cont_rel$ch007_19 <- car::recode(as.vector(SHARE_w5_cont_rel$ch007_19), "NA='-999'")
SHARE_w5_cont_rel$ch007_20 <- car::recode(as.vector(SHARE_w5_cont_rel$ch007_20), "NA='-999'")

SHARE_ds_w5$cont_rel <- c(NA)
for(i in 1:dim(SHARE_w5_cont_rel)[1]){
  if( SHARE_w5_cont_rel$ch014_1[i] %in% c(1,2,3) | SHARE_w5_cont_rel$ch014_2[i] %in% c(1,2,3) |
      SHARE_w5_cont_rel$ch014_3[i] %in% c(1,2,3) | SHARE_w5_cont_rel$ch014_4[i] %in% c(1,2,3) |
      SHARE_w5_cont_rel$ch014_5[i] %in% c(1,2,3) | SHARE_w5_cont_rel$ch014_6[i] %in% c(1,2,3) |
      SHARE_w5_cont_rel$ch014_7[i] %in% c(1,2,3) | SHARE_w5_cont_rel$ch014_8[i] %in% c(1,2,3) |
      SHARE_w5_cont_rel$ch014_9[i] %in% c(1,2,3) | SHARE_w5_cont_rel$ch014_10[i] %in% c(1,2,3) |
      SHARE_w5_cont_rel$ch014_11[i] %in% c(1,2,3) | SHARE_w5_cont_rel$ch014_12[i] %in% c(1,2,3) |
      SHARE_w5_cont_rel$ch014_13[i] %in% c(1,2,3) | SHARE_w5_cont_rel$ch014_14[i] %in% c(1,2,3) |
      SHARE_w5_cont_rel$ch014_15[i] %in% c(1,2,3) | SHARE_w5_cont_rel$ch014_16[i] %in% c(1,2,3) |
      SHARE_w5_cont_rel$ch014_17[i] %in% c(1,2,3) | SHARE_w5_cont_rel$ch014_18[i] %in% c(1,2,3) |
      SHARE_w5_cont_rel$ch014_19[i] %in% c(1,2,3) | SHARE_w5_cont_rel$ch014_20[i] %in% c(1,2,3) |
      SHARE_w5_cont_rel$dn032_1[i] %in% c(1,2,3) | SHARE_w5_cont_rel$dn032_2[i] %in% c(1,2,3) |
      SHARE_w5_cont_rel$ch007_1[i] ==1 | SHARE_w5_cont_rel$ch007_2[i] ==1 | SHARE_w5_cont_rel$ch007_3[i] ==1 |
      SHARE_w5_cont_rel$ch007_4[i] ==1 | SHARE_w5_cont_rel$ch007_5[i] ==1 | SHARE_w5_cont_rel$ch007_6[i] ==1 |
      SHARE_w5_cont_rel$ch007_7[i] ==1 | SHARE_w5_cont_rel$ch007_8[i] ==1 | SHARE_w5_cont_rel$ch007_9[i] ==1 |
      SHARE_w5_cont_rel$ch007_10[i] ==1 | SHARE_w5_cont_rel$ch007_11[i] ==1 | SHARE_w5_cont_rel$ch007_12[i] ==1 |
      SHARE_w5_cont_rel$ch007_13[i] ==1 | SHARE_w5_cont_rel$ch007_14[i] ==1 | SHARE_w5_cont_rel$ch007_15[i] ==1 |
      SHARE_w5_cont_rel$ch007_16[i] ==1 | SHARE_w5_cont_rel$ch007_17[i] ==1 | SHARE_w5_cont_rel$ch007_18[i] ==1 |
      SHARE_w5_cont_rel$ch007_19[i] ==1 | SHARE_w5_cont_rel$ch007_20[i] ==1) {
    SHARE_ds_w5$cont_rel[i] = 1 }
  else if( SHARE_w5_cont_rel$ch014_1[i] == -999 & SHARE_w5_cont_rel$ch014_2[i] == -999 &
      SHARE_w5_cont_rel$ch014_3[i] == -999 & SHARE_w5_cont_rel$ch014_4[i] == -999 &
      SHARE_w5_cont_rel$ch014_5[i] == -999 & SHARE_w5_cont_rel$ch014_6[i] == -999 &
      SHARE_w5_cont_rel$ch014_7[i] == -999 & SHARE_w5_cont_rel$ch014_8[i] == -999 &
      SHARE_w5_cont_rel$ch014_9[i] == -999 & SHARE_w5_cont_rel$ch014_10[i] == -999 &
      SHARE_w5_cont_rel$ch014_11[i] == -999 & SHARE_w5_cont_rel$ch014_12[i] == -999 &
      SHARE_w5_cont_rel$ch014_13[i] == -999 & SHARE_w5_cont_rel$ch014_14[i] == -999 &
      SHARE_w5_cont_rel$ch014_15[i] == -999 & SHARE_w5_cont_rel$ch014_16[i] == -999 &
      SHARE_w5_cont_rel$ch014_17[i] == -999 & SHARE_w5_cont_rel$ch014_18[i] == -999 &
      SHARE_w5_cont_rel$ch014_19[i] == -999 & SHARE_w5_cont_rel$ch014_20[i] == -999 &
      SHARE_w5_cont_rel$dn032_1[i] == -999 & SHARE_w5_cont_rel$dn032_2[i] == -999  &
      SHARE_w5_cont_rel$ch007_1[i] == -999 & SHARE_w5_cont_rel$ch007_2[i] == -999 & SHARE_w5_cont_rel$ch007_3[i] == -999 &
      SHARE_w5_cont_rel$ch007_4[i] == -999 & SHARE_w5_cont_rel$ch007_5[i] == -999 & SHARE_w5_cont_rel$ch007_6[i] == -999 &
      SHARE_w5_cont_rel$ch007_7[i] == -999 & SHARE_w5_cont_rel$ch007_8[i] == -999 & SHARE_w5_cont_rel$ch007_9[i] == -999 &
      SHARE_w5_cont_rel$ch007_10[i] == -999 & SHARE_w5_cont_rel$ch007_11[i] == -999 & SHARE_w5_cont_rel$ch007_12[i] == -999 &
      SHARE_w5_cont_rel$ch007_13[i] == -999 & SHARE_w5_cont_rel$ch007_14[i] == -999 & SHARE_w5_cont_rel$ch007_15[i] == -999 &
      SHARE_w5_cont_rel$ch007_16[i] == -999 & SHARE_w5_cont_rel$ch007_17[i] == -999 & SHARE_w5_cont_rel$ch007_18[i] == -999 &
      SHARE_w5_cont_rel$ch007_19[i] == -999 & SHARE_w5_cont_rel$ch007_20[i] == -999) {
    SHARE_ds_w5$cont_rel[i] = 999 }
  else if( !( SHARE_w5_cont_rel$ch014_1[i] %in% c(1,2,3) | SHARE_w5_cont_rel$ch014_2[i] %in% c(1,2,3) |
      SHARE_w5_cont_rel$ch014_3[i] %in% c(1,2,3) | SHARE_w5_cont_rel$ch014_4[i] %in% c(1,2,3) |
      SHARE_w5_cont_rel$ch014_5[i] %in% c(1,2,3) | SHARE_w5_cont_rel$ch014_6[i] %in% c(1,2,3) |
      SHARE_w5_cont_rel$ch014_7[i] %in% c(1,2,3) | SHARE_w5_cont_rel$ch014_8[i] %in% c(1,2,3) |
      SHARE_w5_cont_rel$ch014_9[i] %in% c(1,2,3) | SHARE_w5_cont_rel$ch014_10[i] %in% c(1,2,3) |
      SHARE_w5_cont_rel$ch014_11[i] %in% c(1,2,3) | SHARE_w5_cont_rel$ch014_12[i] %in% c(1,2,3) |
      SHARE_w5_cont_rel$ch014_13[i] %in% c(1,2,3) | SHARE_w5_cont_rel$ch014_14[i] %in% c(1,2,3) |
      SHARE_w5_cont_rel$ch014_15[i] %in% c(1,2,3) | SHARE_w5_cont_rel$ch014_16[i] %in% c(1,2,3) |
      SHARE_w5_cont_rel$ch014_17[i] %in% c(1,2,3) | SHARE_w5_cont_rel$ch014_18[i] %in% c(1,2,3) |
      SHARE_w5_cont_rel$ch014_19[i] %in% c(1,2,3) | SHARE_w5_cont_rel$ch014_20[i] %in% c(1,2,3) |
      SHARE_w5_cont_rel$dn032_1[i] %in% c(1,2,3) | SHARE_w5_cont_rel$dn032_2[i] %in% c(1,2,3) |
      SHARE_w5_cont_rel$ch007_1[i] ==1 | SHARE_w5_cont_rel$ch007_2[i] ==1 | SHARE_w5_cont_rel$ch007_3[i] ==1 |
      SHARE_w5_cont_rel$ch007_4[i] ==1 | SHARE_w5_cont_rel$ch007_5[i] ==1 | SHARE_w5_cont_rel$ch007_6[i] ==1 |
      SHARE_w5_cont_rel$ch007_7[i] ==1 | SHARE_w5_cont_rel$ch007_8[i] ==1 | SHARE_w5_cont_rel$ch007_9[i] ==1 |
      SHARE_w5_cont_rel$ch007_10[i] ==1 | SHARE_w5_cont_rel$ch007_11[i] ==1 | SHARE_w5_cont_rel$ch007_12[i] ==1 |
      SHARE_w5_cont_rel$ch007_13[i] ==1 | SHARE_w5_cont_rel$ch007_14[i] ==1 | SHARE_w5_cont_rel$ch007_15[i] ==1 |
      SHARE_w5_cont_rel$ch007_16[i] ==1 | SHARE_w5_cont_rel$ch007_17[i] ==1 | SHARE_w5_cont_rel$ch007_18[i] ==1 |
      SHARE_w5_cont_rel$ch007_19[i] ==1 | SHARE_w5_cont_rel$ch007_20[i] ==1 ) ) {
    SHARE_ds_w5$cont_rel[i] = 0 }
}

SHARE_ds_w5$cont_rel <- car::recode(as.vector(SHARE_ds_w5$cont_rel), "NA='999'")
SHARE_ds_w5$cont_rel <- labelled(SHARE_ds_w5$cont_rel, labels = c("No"=0, "Yes"=1, "Missing"=999, "Do not know"=998, "Refuse"=997, "Not applicable"=996, "Don't answer"=995,  "Not attempt/not done/not yet recorded"=994, "Disable to measure"=993, "Impute"=992, "CAPI/interviewer error"=991))


```

#### Statistical description of the new harmonised variable
```{r descript5, echo=F}
vari <- SHARE_ds_w5$cont_rel
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[3]) 
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[2], caption = "Type of missing")
#Categorical_summary(var = SHARE_ds_w5$cont_rel, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))
ggplot(SHARE_ds_w5, aes(x=factor(cont_rel))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Are any form of contact (face-to-face/phone/mail/Internet communicators) with family members/relatives frequent") + ylab("Frequency")
```

#### Validation
```{r crosstabulation5, echo=F}

```

 
 

```{r final, echo=F}

l.hds <- list(w1 = SHARE_ds_w1, w2 = SHARE_ds_w2, w4 = SHARE_ds_w4, w5 = SHARE_ds_w5)

for(name in names(l.hds)) {
  aux_object <- l.hds[[name]]
  label(l.hds[[name]][[2]]) <- label(aux_object[[2]]) <- ds_label # Text value assigned at the DS description, at the top
  l.hds[[name]][[2]] <- labelled(l.hds[[name]][[2]], labels = cat_label)
  aux_object[[2]] <- car::recode(aux_object[[2]], "miss_values_vector=NA")
  aux_object[[2]] <- labelled(aux_object[[2]], labels = cat_label[1:2])
  m_name <- paste0("SHARE_m_ds_",name)
  assign(m_name, aux_object)
  rm(aux_object)
}

```

## Summary of descriptive statistics of the harmonised variable accross populations and waves

Two tables are generated: 

1. Percentages of categories in each harmonised variable.

2. Frequencies and percentages of individuals with different trajectories.


```{r summ}

t.hds <- frq(l.hds[[1]][2])[[1]][,c(1,2)] 
for (i in seq_along(l.hds)){
  t.hds[2+i] <- frq(l.hds[[i]][2])[[1]][,4] 
}
t.hds[13,] <- c("n", "sample size", sapply(l.hds,function(wave) length(wave[[1]]))
             )
names(t.hds)<-c("val", "label",names(l.hds))
kable(t.hds)

dbb <- get(paste0("SHARE_m_ds_",names(l.hds)[1]))[,c("id","cont_rel")]
for(ind in 2:length(l.hds)){
  dbb <- merge(dbb, get(paste0("SHARE_m_ds_",names(l.hds)[ind]))[,c("id","cont_rel")], by = "id", suffixes = c("", paste0(".",names(l.hds)[ind])), all = T)
}
names(dbb) <- c("id", names(l.hds))

v.dbb <- dbb[,2]
for(ind in 2:length(l.hds)){
  v.dbb <- paste(v.dbb,dbb[,ind+1],sep="")
}
f.dbb <- frq(v.dbb)[[1]][,c(1,2,4)]
kable(f.dbb)

```


```{r save, echo=FALSE}
cont_rel <- SHARE_ds_w1
save(cont_rel, file = "../RData/w1/cont_rel.RData")
rm(cont_rel)

cont_rel <- SHARE_ds_w2
save(cont_rel, file = "../RData/w2/cont_rel.RData")
rm(cont_rel)

cont_rel <- SHARE_ds_w4
save(cont_rel, file = "../RData/w4/cont_rel.RData")
rm(cont_rel)

cont_rel <- SHARE_ds_w5
save(cont_rel, file = "../RData/w5/cont_rel.RData")
rm(cont_rel)


```

# Quality estimation
```{r closeRsession, echo=FALSE} 
opal.logout(o)
```


