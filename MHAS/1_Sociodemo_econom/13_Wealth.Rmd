---
title: "Wealth"
output: 
  html_document:
    theme: united
    highlight: tango
    toc: true
    toc_depth: 6
    toc_float:
      collapsed: true
      smooth_scroll: true
    number_sections: true
---

<!-- ########################################################## --> 

<!-- # Installation, loading packages -->
<!-- **R script:** -->



```{r setup, include=FALSE,  echo=FALSE}
source("M:/WPs/WP1/Maelstrom/data_process/athlos-project.github.io/setup_laia.r")
```

<!-- ########################################################## --> 

# Description of DataSchema variable 

* Short name: `wealth`
* Variable label: `Total score based in all sources of income transformed into a comparable and normalized categoric variable.`
* Domain: `Socio-demographic and economic characteristics`
* Value type: `categorical ordinal`
* Category coding:

**Code** | **Category Label**
-------- | ------------------
1        | 1st quintile
2        | 2nd quintile
3        | 3rd quintile
4        | 4th quintile
5        | 5th quintile

* Category missings: 

**Code** | **Category Label**
----| ------------------
991 | CAPI/interviewer error
992 | Impute
993 | Disable to measure
994 | Not attempt/not done
995 | Does not answer
996 | Not applicable
997 | Refuse
998 | Do not know
999 | Missing

* Comments: `Need to pay attention to specificities like: before/after taxes or contributions. People: HH income is prioritized. When not available individual/caregiver/informant/family income is caolected. Source: Pension/family/work/government/disablity/total. all sources are taken into account. For some studies, the maximum value can be compared (and crossed by sex and age to control biases) . Time-lapse: weekly, monthly, in the last 12 months. 'Many values are missing since not all respondents have all sources of income or, within the household there is not always more members, in these cases do not confuse missing data with missing values and mean a 0 should be added to the total sum in each case.`

```{r lab, echo=FALSE}
ds_label <- "Wealth"
ds_label_all <- "Total score based in all sources of income transformed into a comparable and normalized categoric variable"
```


# Data process

## Mexico

### Wave 1 

#### Study-specific variable description

| **Name** | `K8_1` | `K9A1` | `K9B1` | `K9C1` |
|-|-|-|-|
| **Label** | `Value of business 1` | `Value of business 1 is more than 75,000` | `Value of business 1 is more than 25,000` | `Value of business 1 is more than 250,000` |
| **Table name** | `sect_k` | `sect_k` | `sect_k` |
| **Missings** |  | | |
| **Description** |  | | |


```{r assign1, echo=F}
opal.assign.table.tibble(o, 'MHAS_wealth2','Mexican Health Aging Study.sect_k',
                         variables=list('K8_1', 'K9A1', 'K9B1', 'K9C1', 'K8_2', 'K9A2', 'K9B2', 'K9C2', 'K11_1', 'K12A1', 'K12B1', 'K12C1', 'K11_2', 'K12A2', 'K12B2', 'K12C2', 'K22_1', 'K23A1', 'K23B1', 'K23C1', 'K22_2', 'K23A2', 'K23B2', 'K23C2', 'K31_3', 'K32A3', 'K32B3', 'K32C3', 'K34_3', 'K35A3', 'K35B3', 'K35C3', 'K40', 'K41A', 'K41B', 'K41C', 'K42', 'k45a_3', 'k45b_3', 'k45c_3', 'K44A_1', 'K44B1', 'K44B2', 'K44B3', 'K45A_1', 'K45B1', 'K45B2', 'K45B3', 'K47A_1', 'K47B1', 'K47B2', 'K47B3', 'K48A_1', 'K48B1', 'K48B2', 'K48B3', 'K50A_1', 'K51B1', 'K51B2', 'K51B3', 'K53A_1', 'K53B1', 'K53B2', 'K53B3', 'K54A_1', 'K54B1', 'K54B2', 'K54B3', 'K58_1', 'K59A1', 'K59B1', 'K59C1', 'K58_2', 'K59A2', 'K59B2', 'K59C2', 'K58_3', 'K59A3', 'K59B3', 'K59C3', 'K58_4', 'K59A4', 'K59B4', 'K59C4', 'K64_1', 'K65A1', 'K65B1', 'K65C1', 'K64_2', 'K65A2', 'K65B2', 'K65C2', 'K64_3', 'K65A3', 'K65B3', 'K65C3', 'K64_4', 'K65A4', 'K65B4', 'K65C4', 'K77_1', 'K77_2', 'K80_1', 'K80_2', 'k83e', 'k80c', 'K25_1', 'K26A1', 'K26B1', 'K26C1', 'K25_2', 'K26A2', 'K26B2', 'K26C2', 'K31_1', 'K32A1', 'K32B1', 'K32C1', 'K34_1', 'K35A1', 'K35B1', 'K35C1', 'K31_2', 'K32A2', 'K32B2', 'K32C2', 'K34_2', 'K35A2', 'K35B2', 'K35C2', 'K51A_1', 'K51B1', 'K51B2', 'K51B3'), missings = TRUE)
MHAS_wealth2 <- opal.execute(o,'MHAS_wealth2')

opal.assign.table.tibble(o, 'MHAS_w1_id','Mexican Health Aging Study.MHAS-2001',
                         variables=list('unhhid'), missings = TRUE)
MHAS_w1_id <- opal.execute(o,'MHAS_w1_id')


names(MHAS_wealth2) <- c("unhhid", names(MHAS_wealth2)[2:length(MHAS_wealth2)])
attributes(MHAS_wealth2$unhhid) <- NULL
MHAS_wealth2$unhhid <- as.numeric(MHAS_wealth2$unhhid)
MHAS_wealth <- left_join(MHAS_w1_id, MHAS_wealth2, by='unhhid')
MHAS_wealth <- distinct(MHAS_wealth,id, .keep_all=TRUE)
```

##### Data management

Each question was asked in continous way and if the respondent did not know it, it was reasked in categorical way using three variables in order to fit the individuals into 5 intervals.
For this reason, it was joined the information of the continous and categorical way in one variable using the continous number and ifelse the median of each interval. 

```{r dm1, echo=TRUE}
m1 <- median(MHAS_wealth$K8_1[which(MHAS_wealth$K8_1<25000)])
m2 <- median(MHAS_wealth$K8_1[which(MHAS_wealth$K8_1>25000 & MHAS_wealth$K8_1<75000)])
m3 <- median(MHAS_wealth$K8_1[which(MHAS_wealth$K8_1>75000 & MHAS_wealth$K8_1<250000)])
m4 <- median(MHAS_wealth$K8_1[which(MHAS_wealth$K8_1>250000)])

MHAS_wealth$bisnes1 <- car::recode(MHAS_wealth$K8_1, "9999999=NA; 8888888=NA")
MHAS_wealth$bisnes1[is.na(MHAS_wealth$bisnes1)] <- apply(X = select(MHAS_wealth, K9A1, K9B1, K9C1)[is.na(MHAS_wealth$bisnes1),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$bisnes1 <- car::recode(MHAS_wealth$bisnes1, "'1NA1'=m4; '1NA2'=m3; '1NA9'=250000; '21NA'=m2; '22NA'=m1; '29NA'=25000; '9NANA'=NA; 'NANANA'=NA")

m1 <- median(MHAS_wealth$K8_2[which(MHAS_wealth$K8_2<25000)])
m2 <- median(MHAS_wealth$K8_2[which(MHAS_wealth$K8_2>25000 & MHAS_wealth$K8_2<75000)])
m3 <- median(MHAS_wealth$K8_2[which(MHAS_wealth$K8_2>75000 & MHAS_wealth$K8_2<250000)])
m4 <- median(MHAS_wealth$K8_2[which(MHAS_wealth$K8_2>250000)])

MHAS_wealth$bisnes2 <- car::recode(MHAS_wealth$K8_2, "9999999=NA; 8888888=NA")
MHAS_wealth$bisnes2[is.na(MHAS_wealth$bisnes2)] <- apply(X = select(MHAS_wealth, K9A2, K9B2,  K9C2)[is.na(MHAS_wealth$bisnes2),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$bisnes2 <- car::recode(MHAS_wealth$bisnes2, "'1NA1'=m4; '1NA2'=m3; '1NA9'=250000; '21NA'=m2; '22NA'=m1; '29NA'=25000; '9NANA'=NA; 'NANANA'=NA")

m1 <- median(MHAS_wealth$K11_1[which(MHAS_wealth$K11_1<10000)])
m2 <- median(MHAS_wealth$K11_1[which(MHAS_wealth$K11_1>10000 & MHAS_wealth$K11_1<30000)])
m3 <- median(MHAS_wealth$K11_1[which(MHAS_wealth$K11_1>30000 & MHAS_wealth$K11_1<100000)])
m4 <- median(MHAS_wealth$K11_1[which(MHAS_wealth$K11_1>100000)])

MHAS_wealth$i_bisnes1 <- car::recode(MHAS_wealth$K11_1, "9999999=NA; 8888888=NA")
MHAS_wealth$i_bisnes1[is.na(MHAS_wealth$i_bisnes1)] <- apply(X = select(MHAS_wealth, K12A1, K12A1,  K12A1)[is.na(MHAS_wealth$i_bisnes1),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$i_bisnes1 <- car::recode(MHAS_wealth$i_bisnes1, "'1NANA'=m3; '2NANA'=m1; '9NANA'=NA; 'NANANA'=NA")

m1 <- median(MHAS_wealth$K11_2[which(MHAS_wealth$K11_2<10000)])
m2 <- median(MHAS_wealth$K11_2[which(MHAS_wealth$K11_2>10000 & MHAS_wealth$K11_2<30000)])
m3 <- median(MHAS_wealth$K11_2[which(MHAS_wealth$K11_2>30000 & MHAS_wealth$K11_2<100000)])
m4 <- median(MHAS_wealth$K11_2[which(MHAS_wealth$K11_2>100000)])

MHAS_wealth$i_bisnes2 <- car::recode(MHAS_wealth$K11_2, "9999999=NA; 8888888=NA")
MHAS_wealth$i_bisnes2[is.na(MHAS_wealth$i_bisnes2)] <- apply(X = select(MHAS_wealth, K12A2, K12B2,  K12C2)[is.na(MHAS_wealth$i_bisnes2),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$i_bisnes2 <- car::recode(MHAS_wealth$i_bisnes2, "'1NA1'=m4; '1NA2'=m3; '21NA'=m2; '22NA'=m1; '9NANA'=NA; 'NANANA'=NA")

m1 <- median(MHAS_wealth$K22_1[which(MHAS_wealth$K22_1<50000)])
m2 <- median(MHAS_wealth$K22_1[which(MHAS_wealth$K22_1>50000 & MHAS_wealth$K22_1<100000)])
m3 <- median(MHAS_wealth$K22_1[which(MHAS_wealth$K22_1>100000 & MHAS_wealth$K22_1<250000)])
m4 <- median(MHAS_wealth$K22_1[which(MHAS_wealth$K22_1>250000)])

MHAS_wealth$estate1 <- car::recode(MHAS_wealth$K22_1, "9999999=NA; 8888888=NA")
MHAS_wealth$estate1[is.na(MHAS_wealth$estate1)] <- apply(X = select(MHAS_wealth, K23A1, K23B1,  K23C1)[is.na(MHAS_wealth$estate1),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$estate1 <- car::recode(MHAS_wealth$estate1, "'1NA1'=m4; '1NA2'=m3; '1NA9'=250000; '21NA'=m2; '22NA'=m1; '29NA'=50000; '9NANA'=NA; 'NANANA'=NA")


m1 <- median(MHAS_wealth$K22_2[which(MHAS_wealth$K22_2<50000)])
m2 <- median(MHAS_wealth$K22_2[which(MHAS_wealth$K22_2>50000 & MHAS_wealth$K22_2<100000)])
m3 <- median(MHAS_wealth$K22_2[which(MHAS_wealth$K22_2>100000 & MHAS_wealth$K22_2<250000)])
m4 <- median(MHAS_wealth$K22_2[which(MHAS_wealth$K22_2>250000)])

MHAS_wealth$estate2 <- car::recode(MHAS_wealth$K22_2, "9999999=NA; 8888888=NA")
MHAS_wealth$estate2[is.na(MHAS_wealth$estate2)] <- apply(X = select(MHAS_wealth, K23A2, K23B2,  K23C2)[is.na(MHAS_wealth$estate2),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$estate2 <- car::recode(MHAS_wealth$estate2, "'1NA1'=m4; '1NA2'=m3; '9NANA'=NA; 'NANANA'=NA")


m <- c(1000, 3000, 9000)
m1 <- median(MHAS_wealth$K25_1[which(MHAS_wealth$K25_1<m[1])])
m2 <- median(MHAS_wealth$K25_1[which(MHAS_wealth$K25_1>m[1] & MHAS_wealth$K25_1<m[2])])
m3 <- median(MHAS_wealth$K25_1[which(MHAS_wealth$K25_1>m[2] & MHAS_wealth$K25_1<m[3])])
m4 <- median(MHAS_wealth$K25_1[which(MHAS_wealth$K25_1>m[3])])

MHAS_wealth$i_estate1 <- car::recode(MHAS_wealth$K25_1, "9999999=NA; 8888888=NA")
MHAS_wealth$i_estate1[is.na(MHAS_wealth$i_estate1)] <- apply(X = select(MHAS_wealth, K26A1, K26B1, K26C1)[is.na(MHAS_wealth$i_estate1),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$i_estate1 <- car::recode(MHAS_wealth$i_estate1, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

m1 <- median(MHAS_wealth$K25_2[which(MHAS_wealth$K25_2<m[1])])
m2 <- median(MHAS_wealth$K25_2[which(MHAS_wealth$K25_2>m[1] & MHAS_wealth$K25_2<m[2])])
m3 <- median(MHAS_wealth$K25_2[which(MHAS_wealth$K25_2>m[2] & MHAS_wealth$K25_2<m[3])])
m4 <- median(MHAS_wealth$K25_2[which(MHAS_wealth$K25_2>m[3])])

MHAS_wealth$i_estate2 <- car::recode(MHAS_wealth$K25_2, "9999999=NA; 8888888=NA")
MHAS_wealth$i_estate2[is.na(MHAS_wealth$i_estate2)] <- apply(X = select(MHAS_wealth, K26A2, K26B2, K26C2)[is.na(MHAS_wealth$i_estate2),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$i_estate2 <- car::recode(MHAS_wealth$i_estate2, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

m <- c(6000, 12000, 48000)
m1 <- median(MHAS_wealth$K31_1[which(MHAS_wealth$K31_1<m[1])])
m2 <- median(MHAS_wealth$K31_1[which(MHAS_wealth$K31_1>m[1] & MHAS_wealth$K31_1<m[2])])
m3 <- median(MHAS_wealth$K31_1[which(MHAS_wealth$K31_1>m[2] & MHAS_wealth$K31_1<m[3])])
m4 <- median(MHAS_wealth$K31_1[which(MHAS_wealth$K31_1>m[3])])

MHAS_wealth$accounts <- car::recode(MHAS_wealth$K31_1, "9999999=NA; 8888888=NA")
MHAS_wealth$accounts[is.na(MHAS_wealth$accounts)] <- apply(X = select(MHAS_wealth, K32A1, K32B1, K32C1)[is.na(MHAS_wealth$accounts),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$accounts <- car::recode(MHAS_wealth$accounts, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

m <- 12*c(100, 200, 1000)
MHAS_wealth$K34_1 <- 12*MHAS_wealth$K34_1
m1 <- median(MHAS_wealth$K34_1[which(MHAS_wealth$K34_1<m[1])])
m2 <- median(MHAS_wealth$K34_1[which(MHAS_wealth$K34_1>m[1] & MHAS_wealth$K34_1<m[2])])
m3 <- median(MHAS_wealth$K34_1[which(MHAS_wealth$K34_1>m[2] & MHAS_wealth$K34_1<m[3])])
m4 <- median(MHAS_wealth$K34_1[which(MHAS_wealth$K34_1>m[3])])

MHAS_wealth$i_accounts <- car::recode(MHAS_wealth$K34_1, "9999999=NA; 8888888=NA")
MHAS_wealth$i_accounts[is.na(MHAS_wealth$i_accounts)] <- apply(X = select(MHAS_wealth, K35A1, K35B1, K35C1)[is.na(MHAS_wealth$i_accounts),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$i_accounts <- car::recode(MHAS_wealth$i_accounts, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

m <- c(6000, 12000, 48000)
m1 <- median(MHAS_wealth$K31_2[which(MHAS_wealth$K31_2<m[1])])
m2 <- median(MHAS_wealth$K31_2[which(MHAS_wealth$K31_2>m[1] & MHAS_wealth$K31_2<m[2])])
m3 <- median(MHAS_wealth$K31_2[which(MHAS_wealth$K31_2>m[2] & MHAS_wealth$K31_2<m[3])])
m4 <- median(MHAS_wealth$K31_2[which(MHAS_wealth$K31_2>m[3])])

MHAS_wealth$credits <- car::recode(MHAS_wealth$K31_2, "9999999=NA; 8888888=NA")
MHAS_wealth$credits[is.na(MHAS_wealth$credits)] <- apply(X = select(MHAS_wealth, K32A2, K32B2, K32C2)[is.na(MHAS_wealth$credits),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$credits <- car::recode(MHAS_wealth$credits, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

m <- 12*c(100, 200, 1000)
MHAS_wealth$K34_2 <- 12*MHAS_wealth$K34_2
m1 <- median(MHAS_wealth$K34_2[which(MHAS_wealth$K34_2<m[1])])
m2 <- median(MHAS_wealth$K34_2[which(MHAS_wealth$K34_2>m[1] & MHAS_wealth$K34_2<m[2])])
m3 <- median(MHAS_wealth$K34_2[which(MHAS_wealth$K34_2>m[2] & MHAS_wealth$K34_2<m[3])])
m4 <- median(MHAS_wealth$K34_2[which(MHAS_wealth$K34_2>m[3])])

MHAS_wealth$i_credits <- car::recode(MHAS_wealth$K34_2, "9999999=NA; 8888888=NA")
MHAS_wealth$i_credits[is.na(MHAS_wealth$i_credits)] <- apply(X = select(MHAS_wealth, K35A2, K35B2, K35C2)[is.na(MHAS_wealth$i_credits),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$i_credits <- car::recode(MHAS_wealth$i_credits, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")


m1 <- median(MHAS_wealth$K31_3[which(MHAS_wealth$K31_3<6000)])
m2 <- median(MHAS_wealth$K31_3[which(MHAS_wealth$K31_3>6000 & MHAS_wealth$K31_3<12000)])
m3 <- median(MHAS_wealth$K31_3[which(MHAS_wealth$K31_3>12000 & MHAS_wealth$K31_3<48000)])
m4 <- median(MHAS_wealth$K31_3[which(MHAS_wealth$K31_3>48000)])

MHAS_wealth$stocks <- car::recode(MHAS_wealth$K31_3, "9999999=NA; 8888888=NA")
MHAS_wealth$stocks[is.na(MHAS_wealth$stocks)] <- apply(X = select(MHAS_wealth, K32A3, K32B3,  K32C3)[is.na(MHAS_wealth$stocks),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$stocks <- car::recode(MHAS_wealth$stocks, "'NANANA'=NA")

m <- 12*c(100, 200, 1000)
MHAS_wealth$K34_3 <- 12*MHAS_wealth$K34_3
m1 <- median(MHAS_wealth$K34_3[which(MHAS_wealth$K34_3<m[1])])
m2 <- median(MHAS_wealth$K34_3[which(MHAS_wealth$K34_3>m[1] & MHAS_wealth$K34_3<m[2])])
m3 <- median(MHAS_wealth$K34_3[which(MHAS_wealth$K34_3>m[2] & MHAS_wealth$K34_3<m[3])])
m4 <- median(MHAS_wealth$K34_3[which(MHAS_wealth$K34_3>m[3])])

MHAS_wealth$i_stocks <- car::recode(MHAS_wealth$K34_3, "9999999=NA; 8888888=NA")
MHAS_wealth$i_stocks[is.na(MHAS_wealth$i_stocks)] <- apply(X = select(MHAS_wealth, K35A3, K35B3,  K35C3)[is.na(MHAS_wealth$i_stocks),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$i_stocks <- car::recode(MHAS_wealth$i_stocks, "'NANANA'=NA")

m1 <- median(MHAS_wealth$K40[which(MHAS_wealth$K40<50000)])
m2 <- median(MHAS_wealth$K40[which(MHAS_wealth$K40>50000 & MHAS_wealth$K40<100000)])
m3 <- median(MHAS_wealth$K40[which(MHAS_wealth$K40>100000 & MHAS_wealth$K40<250000)])
m4 <- median(MHAS_wealth$K40[which(MHAS_wealth$K40>250000)])

MHAS_wealth$vehicles <- car::recode(MHAS_wealth$K40, "9999999=NA; 8888888=NA")
MHAS_wealth$vehicles[is.na(MHAS_wealth$vehicles)] <- apply(X = select(MHAS_wealth, K41A, K41B,  K41C)[is.na(MHAS_wealth$vehicles),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$vehicles <- car::recode(MHAS_wealth$vehicles, "'1NA1'=m4; '1NA2'=m3; '1NA9'=250000; '21NA'=m2; '22NA'=m1; '29NA'=50000; '9NANA'=NA; 'NANANA'=NA")

m1 <- median(MHAS_wealth$K42[which(MHAS_wealth$K42<50000)])
m2 <- median(MHAS_wealth$K42[which(MHAS_wealth$K42>50000 & MHAS_wealth$K42<100000)])
m3 <- median(MHAS_wealth$K42[which(MHAS_wealth$K42>100000 & MHAS_wealth$K42<250000)])
m4 <- median(MHAS_wealth$K42[which(MHAS_wealth$K42>250000)])

MHAS_wealth$assets <- car::recode(MHAS_wealth$K42, "9999999=NA; 8888888=NA")
MHAS_wealth$assets[is.na(MHAS_wealth$assets)] <- apply(X = select(MHAS_wealth, k45a_3, k45b_3,  k45c_3)[is.na(MHAS_wealth$assets),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$assets <- car::recode(MHAS_wealth$assets, "'NANANA'=NA")

m1 <- median(MHAS_wealth$K44A_1[which(MHAS_wealth$K44A_1<1000)])
m2 <- median(MHAS_wealth$K44A_1[which(MHAS_wealth$K44A_1>1000 & MHAS_wealth$K44A_1<4000)])
m3 <- median(MHAS_wealth$K44A_1[which(MHAS_wealth$K44A_1>4000 & MHAS_wealth$K44A_1<8000)])
m4 <- median(MHAS_wealth$K44A_1[which(MHAS_wealth$K44A_1>8000)])

MHAS_wealth$salary <- car::recode(MHAS_wealth$K44A_1, "9999999=NA; 8888888=NA")
MHAS_wealth$salary[is.na(MHAS_wealth$salary)] <- apply(X = select(MHAS_wealth, K44B1, K44B2,  K44B3)[is.na(MHAS_wealth$salary),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$salary <- car::recode(MHAS_wealth$salary, "'1NA1'=m4; '1NA2'=m3; '1NA9'=250000; '21NA'=m2; '22NA'=m1; '29NA'=1000; '9NANA'=NA; 'NANANA'=NA")

m1 <- median(MHAS_wealth$K45A_1[which(MHAS_wealth$K45A_1<1000)])
m2 <- median(MHAS_wealth$K45A_1[which(MHAS_wealth$K45A_1>1000 & MHAS_wealth$K45A_1<4000)])
m3 <- median(MHAS_wealth$K45A_1[which(MHAS_wealth$K45A_1>4000 & MHAS_wealth$K45A_1<8000)])
m4 <- median(MHAS_wealth$K45A_1[which(MHAS_wealth$K45A_1>8000)])

MHAS_wealth$bonus <- car::recode(MHAS_wealth$K45A_1, "9999999=NA; 8888888=NA")
MHAS_wealth$bonus[is.na(MHAS_wealth$bonus)] <- apply(X = select(MHAS_wealth, K45B1, K45B2,  K45B3)[is.na(MHAS_wealth$bonus),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$bonus <- car::recode(MHAS_wealth$bonus, "'1NA1'=m4; '1NA2'=m3; '21NA'=m2; '22NA'=m1; '29NA'=1000; '9NANA'=NA; 'NANANA'=NA")

m1 <- median(MHAS_wealth$K47A_1[which(MHAS_wealth$K47A_1<1000)])
m2 <- median(MHAS_wealth$K47A_1[which(MHAS_wealth$K47A_1>1000 & MHAS_wealth$K47A_1<4000)])
m3 <- median(MHAS_wealth$K47A_1[which(MHAS_wealth$K47A_1>4000 & MHAS_wealth$K47A_1<8000)])
m4 <- median(MHAS_wealth$K47A_1[which(MHAS_wealth$K47A_1>8000)])

MHAS_wealth$salary2 <- car::recode(MHAS_wealth$K47A_1, "9999999=NA; 8888888=NA")
MHAS_wealth$salary2[is.na(MHAS_wealth$salary2)] <- apply(X = select(MHAS_wealth, K47B1, K47B2,  K47B3)[is.na(MHAS_wealth$salary2),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$salary2 <- car::recode(MHAS_wealth$salary2, "'1NA1'=m4; '1NA2'=m3; '21NA'=m2; '22NA'=m1; '29NA'=1000; '9NANA'=NA; 'NANANA'=NA")


m1 <- median(MHAS_wealth$K48A_1[which(MHAS_wealth$K48A_1<1000)])
m2 <- median(MHAS_wealth$K48A_1[which(MHAS_wealth$K48A_1>1000 & MHAS_wealth$K48A_1<4000)])
m3 <- median(MHAS_wealth$K48A_1[which(MHAS_wealth$K48A_1>4000 & MHAS_wealth$K48A_1<8000)])
m4 <- median(MHAS_wealth$K48A_1[which(MHAS_wealth$K48A_1>8000)])

MHAS_wealth$bonus2 <- car::recode(MHAS_wealth$K48A_1, "9999999=NA; 8888888=NA")
MHAS_wealth$bonus2[is.na(MHAS_wealth$bonus2)] <- apply(X = select(MHAS_wealth, K48B1, K48B2,  K48B3)[is.na(MHAS_wealth$bonus2),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$bonus2 <- car::recode(MHAS_wealth$bonus2, "'1NA1'=m4; '22NA'=m1; '29NA'=1000; '9NANA'=NA; 'NANANA'=NA")

m1 <- median(MHAS_wealth$K50A_1[which(MHAS_wealth$K50A_1<1000)])
m2 <- median(MHAS_wealth$K50A_1[which(MHAS_wealth$K50A_1>1000 & MHAS_wealth$K50A_1<4000)])
m3 <- median(MHAS_wealth$K50A_1[which(MHAS_wealth$K50A_1>4000 & MHAS_wealth$K50A_1<8000)])
m4 <- median(MHAS_wealth$K50A_1[which(MHAS_wealth$K50A_1>8000)])

MHAS_wealth$s_salary <- car::recode(MHAS_wealth$K50A_1, "9999999=NA; 8888888=NA")
MHAS_wealth$s_salary[is.na(MHAS_wealth$s_salary)] <- apply(X = select(MHAS_wealth, K51B1, K51B2,  K51B3)[is.na(MHAS_wealth$s_salary),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$s_salary <- car::recode(MHAS_wealth$s_salary, "'1NA1'=m4; '1NA2'=m3; '21NA'=m2; '22NA'=m1; '9NANA'=NA; 'NANANA'=NA")


m <- c(1000, 4000, 8000)
m1 <- median(MHAS_wealth$K31_2[which(MHAS_wealth$K31_2<m[1])])
m2 <- median(MHAS_wealth$K31_2[which(MHAS_wealth$K31_2>m[1] & MHAS_wealth$K31_2<m[2])])
m3 <- median(MHAS_wealth$K31_2[which(MHAS_wealth$K31_2>m[2] & MHAS_wealth$K31_2<m[3])])
m4 <- median(MHAS_wealth$K31_2[which(MHAS_wealth$K31_2>m[3])])

MHAS_wealth$s_bonus <- car::recode(MHAS_wealth$K31_2, "9999999=NA; 8888888=NA")
MHAS_wealth$s_bonus[is.na(MHAS_wealth$s_bonus)] <- apply(X = select(MHAS_wealth, K51B1, K51B2, K51B3)[is.na(MHAS_wealth$s_bonus),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$s_bonus <- car::recode(MHAS_wealth$s_bonus, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")


m1 <- median(MHAS_wealth$K53A_1[which(MHAS_wealth$K53A_1<1000)])
m2 <- median(MHAS_wealth$K53A_1[which(MHAS_wealth$K53A_1>1000 & MHAS_wealth$K53A_1<4000)])
m3 <- median(MHAS_wealth$K53A_1[which(MHAS_wealth$K53A_1>4000 & MHAS_wealth$K53A_1<8000)])
m4 <- median(MHAS_wealth$K53A_1[which(MHAS_wealth$K53A_1>8000)])

MHAS_wealth$s_salary2 <- car::recode(MHAS_wealth$K53A_1, "9999999=NA; 8888888=NA")
MHAS_wealth$s_salary2[is.na(MHAS_wealth$s_salary2)] <- apply(X = select(MHAS_wealth, K53B1, K53B2,  K53B3)[is.na(MHAS_wealth$s_salary2),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$s_salary2 <- car::recode(MHAS_wealth$s_salary2, "'1NA1'=m4; '1NA2'=m3; '21NA'=m2; '22NA'=m1; '9NANA'=NA; 'NANANA'=NA")

m1 <- median(MHAS_wealth$K54A_1[which(MHAS_wealth$K54A_1<1000)])
m2 <- median(MHAS_wealth$K54A_1[which(MHAS_wealth$K54A_1>1000 & MHAS_wealth$K54A_1<4000)])
m3 <- median(MHAS_wealth$K54A_1[which(MHAS_wealth$K54A_1>4000 & MHAS_wealth$K54A_1<8000)])
m4 <- median(MHAS_wealth$K54A_1[which(MHAS_wealth$K54A_1>8000)])

MHAS_wealth$s_bonus2 <- car::recode(MHAS_wealth$K54A_1, "9999999=NA; 8888888=NA")
MHAS_wealth$s_bonus2[is.na(MHAS_wealth$s_bonus2)] <- apply(X = select(MHAS_wealth, K54B1, K54B2,  K54B3)[is.na(MHAS_wealth$s_bonus2),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$s_bonus2 <- car::recode(MHAS_wealth$s_bonus2, "'1NA1'=m4; '1NA2'=m3; '21NA'=m2; '9NANA'=NA; 'NANANA'=NA")

m1 <- median(MHAS_wealth$K58_1[which(MHAS_wealth$K58_1<500)])
m2 <- median(MHAS_wealth$K58_1[which(MHAS_wealth$K58_1>500 & MHAS_wealth$K58_1<1000)])
m3 <- median(MHAS_wealth$K58_1[which(MHAS_wealth$K58_1>1000 & MHAS_wealth$K58_1<4000)])
m4 <- median(MHAS_wealth$K58_1[which(MHAS_wealth$K58_1>4000)])

MHAS_wealth$pension <- car::recode(MHAS_wealth$K58_1, "9999999=NA; 8888888=NA")
MHAS_wealth$pension[is.na(MHAS_wealth$pension)] <- apply(X = select(MHAS_wealth, K59A1, K59B1,  K59C1)[is.na(MHAS_wealth$pension),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$pension <- car::recode(MHAS_wealth$pension, "'NANANA'=NA")

m1 <- median(MHAS_wealth$K58_2[which(MHAS_wealth$K58_2<500)])
m2 <- median(MHAS_wealth$K58_2[which(MHAS_wealth$K58_2>500 & MHAS_wealth$K58_2<1000)])
m3 <- median(MHAS_wealth$K58_2[which(MHAS_wealth$K58_2>1000 & MHAS_wealth$K58_2<4000)])
m4 <- median(MHAS_wealth$K58_2[which(MHAS_wealth$K58_2>4000)])

MHAS_wealth$pension2 <- car::recode(MHAS_wealth$K58_2, "9999999=NA; 8888888=NA")
MHAS_wealth$pension2[is.na(MHAS_wealth$pension2)] <- apply(X = select(MHAS_wealth, K59A2, K59B2,  K59C2)[is.na(MHAS_wealth$pension2),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$pension2 <- car::recode(MHAS_wealth$pension2, " '1NA2'=m3; '9NANA'=NA; 'NANANA'=NA")

m1 <- median(MHAS_wealth$K58_3[which(MHAS_wealth$K58_3<500)])
m2 <- median(MHAS_wealth$K58_3[which(MHAS_wealth$K58_3>500 & MHAS_wealth$K58_3<1000)])
m3 <- median(MHAS_wealth$K58_3[which(MHAS_wealth$K58_3>1000 & MHAS_wealth$K58_3<4000)])
m4 <- median(MHAS_wealth$K58_3[which(MHAS_wealth$K58_3>4000)])

MHAS_wealth$pension3 <- car::recode(MHAS_wealth$K58_3, "9999999=NA; 8888888=NA")
MHAS_wealth$pension3[is.na(MHAS_wealth$pension3)] <- apply(X = select(MHAS_wealth, K59A3, K59B3,  K59C3)[is.na(MHAS_wealth$pension3),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$pension3 <- car::recode(MHAS_wealth$pension3, " '1NA2'=m3; '9NANA'=NA; 'NANANA'=NA")


m1 <- median(MHAS_wealth$K58_4[which(MHAS_wealth$K58_4<500)])
m2 <- median(MHAS_wealth$K58_4[which(MHAS_wealth$K58_4>500 & MHAS_wealth$K58_4<1000)])
m3 <- median(MHAS_wealth$K58_4[which(MHAS_wealth$K58_4>1000 & MHAS_wealth$K58_4<4000)])
m4 <- median(MHAS_wealth$K58_4[which(MHAS_wealth$K58_4>4000)])

MHAS_wealth$pension4 <- car::recode(MHAS_wealth$K58_4, "9999999=NA; 8888888=NA")
MHAS_wealth$pension4[is.na(MHAS_wealth$pension4)] <- apply(X = select(MHAS_wealth, K59A4, K59B4,  K59C4)[is.na(MHAS_wealth$pension4),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$pension4 <- car::recode(MHAS_wealth$pension4, "'NANANA'=NA")

m1 <- median(MHAS_wealth$K64_1[which(MHAS_wealth$K64_1<500)])
m2 <- median(MHAS_wealth$K64_1[which(MHAS_wealth$K64_1>500 & MHAS_wealth$K64_1<1000)])
m3 <- median(MHAS_wealth$K64_1[which(MHAS_wealth$K64_1>1000 & MHAS_wealth$K64_1<4000)])
m4 <- median(MHAS_wealth$K64_1[which(MHAS_wealth$K64_1>4000)])

MHAS_wealth$s_pension <- car::recode(MHAS_wealth$K64_1, "9999999=NA; 8888888=NA")
MHAS_wealth$s_pension[is.na(MHAS_wealth$s_pension)] <- apply(X = select(MHAS_wealth, K65A1, K65B1,  K65C1)[is.na(MHAS_wealth$s_pension),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$s_pension <- car::recode(MHAS_wealth$s_pension, "'NANANA'=NA")

m1 <- median(MHAS_wealth$K64_2[which(MHAS_wealth$K64_2<500)])
m2 <- median(MHAS_wealth$K64_2[which(MHAS_wealth$K64_2>500 & MHAS_wealth$K64_2<1000)])
m3 <- median(MHAS_wealth$K64_2[which(MHAS_wealth$K64_2>1000 & MHAS_wealth$K64_2<4000)])
m4 <- median(MHAS_wealth$K64_2[which(MHAS_wealth$K64_2>4000)])

MHAS_wealth$s_pension2 <- car::recode(MHAS_wealth$K64_2, "9999999=NA; 8888888=NA")
MHAS_wealth$s_pension2[is.na(MHAS_wealth$s_pension2)] <- apply(X = select(MHAS_wealth, K65A2, K65B2,  K65C2)[is.na(MHAS_wealth$s_pension2),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$s_pension2 <- car::recode(MHAS_wealth$s_pension2, "'NANANA'=NA")

m1 <- median(MHAS_wealth$K64_3[which(MHAS_wealth$K64_3<500)])
m2 <- median(MHAS_wealth$K64_3[which(MHAS_wealth$K64_3>500 & MHAS_wealth$K64_3<1000)])
m3 <- median(MHAS_wealth$K64_3[which(MHAS_wealth$K64_3>1000 & MHAS_wealth$K64_3<4000)])
m4 <- median(MHAS_wealth$K64_3[which(MHAS_wealth$K64_3>4000)])

MHAS_wealth$s_pension3 <- car::recode(MHAS_wealth$K64_3, "9999999=NA; 8888888=NA")
MHAS_wealth$s_pension3[is.na(MHAS_wealth$s_pension3)] <- apply(X = select(MHAS_wealth, K65A3, K65B3,  K65C3)[is.na(MHAS_wealth$s_pension3),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$s_pension3 <- car::recode(MHAS_wealth$s_pension3, "'NANANA'=NA")

m1 <- median(MHAS_wealth$K64_4[which(MHAS_wealth$K64_4<500)])
m2 <- median(MHAS_wealth$K64_4[which(MHAS_wealth$K64_4>500 & MHAS_wealth$K64_4<1000)])
m3 <- median(MHAS_wealth$K64_4[which(MHAS_wealth$K64_4>1000 & MHAS_wealth$K64_4<4000)])
m4 <- median(MHAS_wealth$K64_4[which(MHAS_wealth$K64_4>4000)])

MHAS_wealth$s_pension4 <- car::recode(MHAS_wealth$K64_4, "9999999=NA; 8888888=NA")
MHAS_wealth$s_pension4[is.na(MHAS_wealth$s_pension4)] <- apply(X = select(MHAS_wealth, K65A4, K65B4,  K65C4)[is.na(MHAS_wealth$s_pension4),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$s_pension4 <- car::recode(MHAS_wealth$s_pension4, "'NANANA'=NA")
```



```{r local1, echo=F}
vari <- MHAS_wealth$bisnes1
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$bisnes2
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$i_bisnes1
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$i_bisnes2
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$estate1
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$estate2
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$i_estate1
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$i_estate2
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$accounts
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$i_accounts
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$credits
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$i_credits
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$stocks
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$i_stocks
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$vehicles
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$assets
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$salary
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$bonus
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$salary2
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$bonus2
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$s_salary
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$s_bonus
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$s_salary2
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$s_bonus2
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$pension
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$pension2
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$pension3
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$pension4
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$s_pension
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$s_pension2
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$s_pension3
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$s_pension4
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$K77_1
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$K77_2
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$K80_1
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$K80_2
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$k83e
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$k80c
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 
```

#### Harmonisation algorithm
To compute the harmonized variable from the study specific varibale sum up all the variables and divide the population into 5 groups each containing 20$\%$ of the corresponding N and the missing values have to be recoded as follows: 

* `NA into 999`

**R script:**

```{r harmo1}
MHAS_wealth$sum <- apply(X = select(MHAS_wealth, bisnes1, bisnes2, i_bisnes1, i_bisnes2, estate1, estate2, i_estate1, i_estate2, accounts, i_accounts, credits, i_credits, stocks, i_stocks, vehicles, assets, salary, bonus, salary2, bonus2, s_salary, s_bonus, s_salary2, s_bonus2, pension, pension2, pension3, pension4, s_pension, s_pension2, s_pension3, s_pension4, K77_1, K77_2, K80_1, K80_2, k83e, k80c), MARGIN = 1, FUN = function(x) sum(as.numeric(x), na.rm = TRUE))
MHAS_wealth$sum <- car::recode(MHAS_wealth$sum, "0=NA")

qq <- quantile(MHAS_wealth$sum, probs = seq(0, 1, .2), na.rm = TRUE)

MHAS_ds_w1 <- tibble(id=MHAS_wealth$id)
MHAS_ds_w1$wealth <- car::recode(MHAS_wealth$sum, "0:qq[2]=1; (qq[2]+1):qq[3]=2; (qq[3]+1):qq[4]=3; (qq[4]+1):qq[5]=4; (qq[5]+1):hi=5")
MHAS_ds_w1$wealth <- car::recode(MHAS_ds_w1$wealth, "NA=999")
MHAS_ds_w1$wealth <- as.integer(MHAS_ds_w1$wealth)
MHAS_ds_w1$wealth <- labelled(MHAS_ds_w1$wealth, labels = c("Missing"=999, "Do not know"=998, "Refuse"=997, "Not applicable"=996, "Does not answer"=995,  "Not attempt not done"=994, "Disable to measure"=993, "Impute"=992, "CAPI interviewer error"=991))
```

#### Statistics of the new harmonised variable
```{r descript1, echo=F}
vari <- MHAS_ds_w1$wealth
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[3], caption = ds_label) 
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[2], caption = "Type of missing")
ggplot(MHAS_ds_w1, aes(x=factor(wealth))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab(ds_label) + ylab("Frequency")
```

#### Validation
```{r crosstabulation1, echo=F}
```





```{r importOPAL1, echo=F}
#opal.assign.data(o, 'MHAS_ds_w1', MHAS_ds_w1)
#opal.symbol_import(o,'MHAS_ds_w1', project='_Athlos_Harm_Dataset')
wealth <- MHAS_ds_w1
save(wealth, file = "../RData/w1/wealth.RData")
rm(wealth)

MHAS_m_ds_w1 <- MHAS_ds_w1
MHAS_m_ds_w1$wealth <- car::recode(MHAS_m_ds_w1$wealth, "c(991, 992, 993, 994, 995, 996, 997,998, 999)=NA")
#opal.assign.data(o, 'MHAS_m_ds_w1', MHAS_m_ds_w1)
#opal.symbol_import(o,'MHAS_m_ds_w1', project='_Athlos_Harm_Dataset')
```






### Wave 2 

#### Study-specific variable description

| **Name** | `a1_1` |
|----------|------------|
| **Label** | `Day of birth` |
| **Table name** | `MHAS-2001` |
| **Missings** | `99 = Don't know` |
| **Description** |  |


```{r assign2, echo=F}
opal.assign.table.tibble(o, 'MHAS_wealth2','Mexican Health Aging Study.sect_k03',
                         variables=list('cunicah', 'k8_1', 'k9a_1', 'k9b_1', 'k9c_1', 'k8_2', 'k9a_2', 'k9b_2', 'k9c_2', 'k11_1', 'k12a_1', 'k12b_1', 'k12c_1', 'k11_2', 'k12a_2', 'k12b_2', 'k12c_2', 'k24_1', 'k25a_1', 'k25b_1', 'k25c_1', 'k24_2', 'k25a_2', 'k25b_2', 'k25c_2', 'k27_1', 'k28a_1', 'k28b_1', 'k28c_1', 'k27_2', 'k28a_2', 'k28b_2', 'k28c_2', 'k33_1', 'k34a_1', 'k34b_1', 'k34c_1', 'k36_1', 'k37a_1', 'k37b_1', 'k37c_1', 'k33_2', 'k34a_2', 'k34b_2', 'k34c_2', 'k36_2', 'k37a_2', 'k37b_2', 'k37c_2', 'k33_3', 'k34a_3', 'k34b_3', 'k34c_3', 'k36_3', 'k37a_3', 'k37b_3', 'k37c_3', 'k42', 'k43a_3', 'k43b_3', 'k43c_3', 'k44', 'k45a_3', 'k45b_3', 'k45c_3', 'k47a', 'k47b1', 'k47b2', 'k47b3', 'k48a', 'k48b1', 'k48b2', 'k48b3', 'k50a', 'k50b1', 'k50b2', 'k50b3', 'k51a', 'k51b1', 'k51b2', 'k51b3', 'k53a', 'k53b1', 'k53b2', 'k53b3', 'k54a', 'k54b1', 'k54b2', 'k54b3', 'k56a', 'k56b1', 'k56b2', 'k56b3', 'k57a', 'k57b1', 'k57b2', 'k57b3', 'k61a', 'k62a_a', 'k62b_a', 'k62c_a', 'k61b', 'k62a_b', 'k62b_b', 'k62c_b', 'k61c', 'k62a_c', 'k62b_c', 'k62c_c', 'k61d', 'k62a_d', 'k62b_d', 'k62c_d', 'k65c', 'k68a_c', 'k68b_c', 'k68c_c', 'k67d', 'k68a_d', 'k68b_d', 'k68c_d', 'k67e', 'k68a_e', 'k68b_e', 'k68c_e', 'k67f', 'k68a_f', 'k68b_f', 'k68c_f', 'k80a', 'k80b', 'k83c', 'k83d', 'k83e', 'k80c'), missings = TRUE)
MHAS_wealth2 <- opal.execute(o,'MHAS_wealth2')

opal.assign.table.tibble(o, 'MHAS_w2_id','Mexican Health Aging Study.MHAS_2003',
                         variables=list('cunicah'), missings = TRUE)
MHAS_w2_id <- opal.execute(o,'MHAS_w2_id')


attributes(MHAS_wealth2$cunicah) <- NULL
MHAS_wealth2$cunicah <- as.numeric(MHAS_wealth2$cunicah)
MHAS_wealth <- left_join(MHAS_w2_id, MHAS_wealth2, by='cunicah')
names(MHAS_wealth) <- c("id", names(MHAS_wealth)[2:length(names(MHAS_wealth))])
MHAS_wealth <- distinct(MHAS_wealth,id, .keep_all=TRUE)
```


##### Data management

Each question was asked in continous way and if the respondent did not know it, it was reasked in categorical way using three variables in order to fit the individuals into 5 intervals.
For this reason, it was joined the information of the continous and categorical way in one variable using the continous number and ifelse the median of each interval. 


```{r dm2, echo=TRUE}
m <- c(25000, 75000, 250000)
m1 <- median(MHAS_wealth$k8_1[which(MHAS_wealth$k8_1<m[1])])
m2 <- median(MHAS_wealth$k8_1[which(MHAS_wealth$k8_1>m[1] & MHAS_wealth$k8_1<m[2])])
m3 <- median(MHAS_wealth$k8_1[which(MHAS_wealth$k8_1>m[2] & MHAS_wealth$k8_1<m[3])])
m4 <- median(MHAS_wealth$k8_1[which(MHAS_wealth$k8_1>m[3])])

MHAS_wealth$bisnes1 <- car::recode(MHAS_wealth$k8_1, "9999999=NA; 8888888=NA")
MHAS_wealth$bisnes1[is.na(MHAS_wealth$bisnes1)] <- apply(X = select(MHAS_wealth, k9a_1, k9b_1, k9c_1)[is.na(MHAS_wealth$bisnes1),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$bisnes1 <- car::recode(MHAS_wealth$bisnes1, "'1NA1'=m4; '1NA2'=m3; '1NA9'=250000; '21NA'=m2; '22NA'=m1; '29NA'=25000; '9NANA'=NA; 'NANANA'=NA")

m1 <- median(MHAS_wealth$k8_2[which(MHAS_wealth$k8_2<m[1])])
m2 <- median(MHAS_wealth$k8_2[which(MHAS_wealth$k8_2>m[1] & MHAS_wealth$k8_2<m[2])])
m3 <- median(MHAS_wealth$k8_2[which(MHAS_wealth$k8_2>m[2] & MHAS_wealth$k8_2<m[3])])
m4 <- median(MHAS_wealth$k8_2[which(MHAS_wealth$k8_2>m[3])])

MHAS_wealth$bisnes2 <- car::recode(MHAS_wealth$k8_2, "9999999=NA; 8888888=NA")
MHAS_wealth$bisnes2[is.na(MHAS_wealth$bisnes2)] <- apply(X = select(MHAS_wealth, k9a_2, k9b_2, k9c_2)[is.na(MHAS_wealth$bisnes2),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$bisnes2 <- car::recode(MHAS_wealth$bisnes2, "'1NA1'=m4; '1NA2'=m3; '1NA9'=250000; '21NA'=m2; '22NA'=m1; '9NANA'=NA; 'NANANA'=NA")

m <- c(10000, 30000, 100000)
m1 <- median(MHAS_wealth$k11_1[which(MHAS_wealth$k11_1<m[1])])
m2 <- median(MHAS_wealth$k11_1[which(MHAS_wealth$k11_1>m[1] & MHAS_wealth$k11_1<m[2])])
m3 <- median(MHAS_wealth$k11_1[which(MHAS_wealth$k11_1>m[2] & MHAS_wealth$k11_1<m[3])])
m4 <- median(MHAS_wealth$k11_1[which(MHAS_wealth$k11_1>m[3])])

MHAS_wealth$i_bisnes1 <- car::recode(MHAS_wealth$k11_1, "9999999=NA; 8888888=NA")
MHAS_wealth$i_bisnes1[is.na(MHAS_wealth$i_bisnes1)] <- apply(X = select(MHAS_wealth, k12a_1, k12b_1, k12c_1)[is.na(MHAS_wealth$i_bisnes1),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$i_bisnes1 <- car::recode(MHAS_wealth$i_bisnes1, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

m1 <- median(MHAS_wealth$k11_2[which(MHAS_wealth$k11_2<m[1])])
m2 <- median(MHAS_wealth$k11_2[which(MHAS_wealth$k11_2>m[1] & MHAS_wealth$k11_2<m[2])])
m3 <- median(MHAS_wealth$k11_2[which(MHAS_wealth$k11_2>m[2] & MHAS_wealth$k11_2<m[3])])
m4 <- median(MHAS_wealth$k11_2[which(MHAS_wealth$k11_2>m[3])])

MHAS_wealth$i_bisnes2 <- car::recode(MHAS_wealth$k11_2, "9999999=NA; 8888888=NA")
MHAS_wealth$i_bisnes2[is.na(MHAS_wealth$i_bisnes2)] <- apply(X = select(MHAS_wealth, k12a_2, k12b_2, k12c_2)[is.na(MHAS_wealth$i_bisnes2),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$i_bisnes2 <- car::recode(MHAS_wealth$i_bisnes2, "'1NA2'=m3; '21NA'=m2; '22NA'=m1; '9NANA'=NA; 'NANANA'=NA")

m <- c(50000, 100000, 250000)
m1 <- median(MHAS_wealth$k24_1[which(MHAS_wealth$k24_1<m[1])])
m2 <- median(MHAS_wealth$k24_1[which(MHAS_wealth$k24_1>m[1] & MHAS_wealth$k24_1<m[2])])
m3 <- median(MHAS_wealth$k24_1[which(MHAS_wealth$k24_1>m[2] & MHAS_wealth$k24_1<m[3])])
m4 <- median(MHAS_wealth$k24_1[which(MHAS_wealth$k24_1>m[3])])

MHAS_wealth$estate1 <- car::recode(MHAS_wealth$k24_1, "9999999=NA; 8888888=NA")
MHAS_wealth$estate1[is.na(MHAS_wealth$estate1)] <- apply(X = select(MHAS_wealth, k25a_1, k25b_1, k25c_1)[is.na(MHAS_wealth$estate1),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$estate1 <- car::recode(MHAS_wealth$estate1, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

m1 <- median(MHAS_wealth$k24_2[which(MHAS_wealth$k24_2<m[1])])
m2 <- median(MHAS_wealth$k24_2[which(MHAS_wealth$k24_2>m[1] & MHAS_wealth$k24_2<m[2])])
m3 <- median(MHAS_wealth$k24_2[which(MHAS_wealth$k24_2>m[2] & MHAS_wealth$k24_2<m[3])])
m4 <- median(MHAS_wealth$k24_2[which(MHAS_wealth$k24_2>m[3])])

MHAS_wealth$estate2 <- car::recode(MHAS_wealth$k24_2, "9999999=NA; 8888888=NA")
MHAS_wealth$estate2[is.na(MHAS_wealth$estate2)] <- apply(X = select(MHAS_wealth, k25a_2, k25b_2, k25c_2)[is.na(MHAS_wealth$estate2),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$estate2 <- car::recode(MHAS_wealth$estate2, "'1NA1'=m4; '1NA9'=m[3]; '22NA'=m1; '9NANA'=NA; 'NANANA'=NA")

m <- c(1000, 3000, 9000)
m1 <- median(MHAS_wealth$k27_1[which(MHAS_wealth$k27_1<m[1])])
m2 <- median(MHAS_wealth$k27_1[which(MHAS_wealth$k27_1>m[1] & MHAS_wealth$k27_1<m[2])])
m3 <- median(MHAS_wealth$k27_1[which(MHAS_wealth$k27_1>m[2] & MHAS_wealth$k27_1<m[3])])
m4 <- median(MHAS_wealth$k27_1[which(MHAS_wealth$k27_1>m[3])])

MHAS_wealth$i_estate1 <- car::recode(MHAS_wealth$k27_1, "9999999=NA; 8888888=NA")
MHAS_wealth$i_estate1[is.na(MHAS_wealth$i_estate1)] <- apply(X = select(MHAS_wealth, k28a_1, k28b_1, k28c_1)[is.na(MHAS_wealth$i_estate1),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$i_estate1 <- car::recode(MHAS_wealth$i_estate1, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

m1 <- median(MHAS_wealth$k27_2[which(MHAS_wealth$k27_2<m[1])])
m2 <- median(MHAS_wealth$k27_2[which(MHAS_wealth$k27_2>m[1] & MHAS_wealth$k27_2<m[2])])
m3 <- median(MHAS_wealth$k27_2[which(MHAS_wealth$k27_2>m[2] & MHAS_wealth$k27_2<m[3])])
m4 <- median(MHAS_wealth$k27_2[which(MHAS_wealth$k27_2>m[3])])

MHAS_wealth$i_estate2 <- car::recode(MHAS_wealth$k27_2, "9999999=NA; 8888888=NA")
MHAS_wealth$i_estate2[is.na(MHAS_wealth$i_estate2)] <- apply(X = select(MHAS_wealth, k28a_2, k28b_2, k28c_2)[is.na(MHAS_wealth$i_estate2),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$i_estate2 <- car::recode(MHAS_wealth$i_estate2, "'9NANA'=NA; 'NANANA'=NA")

m <- c(6000, 12000, 48000)
m1 <- median(MHAS_wealth$k33_1[which(MHAS_wealth$k33_1<m[1])])
m2 <- median(MHAS_wealth$k33_1[which(MHAS_wealth$k33_1>m[1] & MHAS_wealth$k33_1<m[2])])
m3 <- median(MHAS_wealth$k33_1[which(MHAS_wealth$k33_1>m[2] & MHAS_wealth$k33_1<m[3])])
m4 <- median(MHAS_wealth$k33_1[which(MHAS_wealth$k33_1>m[3])])

MHAS_wealth$accounts <- car::recode(MHAS_wealth$k33_1, "9999999=NA; 8888888=NA")
MHAS_wealth$accounts[is.na(MHAS_wealth$accounts)] <- apply(X = select(MHAS_wealth, k34a_1, k34b_1, k34c_1)[is.na(MHAS_wealth$accounts),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$accounts <- car::recode(MHAS_wealth$accounts, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '9NANA'=NA; 'NANANA'=NA")

m <- 12*c(100, 200, 1000)
MHAS_wealth$k36_1 <- MHAS_wealth$k36_1*12
m1 <- median(MHAS_wealth$k36_1[which(MHAS_wealth$k36_1<m[1])])
m2 <- median(MHAS_wealth$k36_1[which(MHAS_wealth$k36_1>m[1] & MHAS_wealth$k36_1<m[2])])
m3 <- median(MHAS_wealth$k36_1[which(MHAS_wealth$k36_1>m[2] & MHAS_wealth$k36_1<m[3])])
m4 <- median(MHAS_wealth$k36_1[which(MHAS_wealth$k36_1>m[3])])

MHAS_wealth$i_accounts <- car::recode(MHAS_wealth$k36_1, "9999999=NA; 8888888=NA")
MHAS_wealth$i_accounts[is.na(MHAS_wealth$i_accounts)] <- apply(X = select(MHAS_wealth, k37a_1, k37b_1, k37c_1)[is.na(MHAS_wealth$i_accounts),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$i_accounts <- car::recode(MHAS_wealth$i_accounts, "'NANANA'=NA")

m <- c(6000, 12000, 48000)
m1 <- median(MHAS_wealth$k33_2[which(MHAS_wealth$k33_2<m[1])])
m2 <- median(MHAS_wealth$k33_2[which(MHAS_wealth$k33_2>m[1] & MHAS_wealth$k33_2<m[2])])
m3 <- median(MHAS_wealth$k33_2[which(MHAS_wealth$k33_2>m[2] & MHAS_wealth$k33_2<m[3])])
m4 <- median(MHAS_wealth$k33_2[which(MHAS_wealth$k33_2>m[3])])

MHAS_wealth$credits <- car::recode(MHAS_wealth$k33_2, "9999999=NA; 8888888=NA")
MHAS_wealth$credits[is.na(MHAS_wealth$credits)] <- apply(X = select(MHAS_wealth, k34a_2, k34b_2, k34c_2)[is.na(MHAS_wealth$credits),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$credits <- car::recode(MHAS_wealth$credits, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '9NANA'=NA; 'NANANA'=NA")

m <- 12*c(100, 200, 1000)
MHAS_wealth$k36_2 <- MHAS_wealth$k36_2*12
m1 <- median(MHAS_wealth$k36_2[which(MHAS_wealth$k36_2<m[1])])
m2 <- median(MHAS_wealth$k36_2[which(MHAS_wealth$k36_2>m[1] & MHAS_wealth$k36_2<m[2])])
m3 <- median(MHAS_wealth$k36_2[which(MHAS_wealth$k36_2>m[2] & MHAS_wealth$k36_2<m[3])])
m4 <- median(MHAS_wealth$k36_2[which(MHAS_wealth$k36_2>m[3])])

MHAS_wealth$i_credits <- car::recode(MHAS_wealth$k36_2, "9999999=NA; 8888888=NA")
MHAS_wealth$i_credits[is.na(MHAS_wealth$i_credits)] <- apply(X = select(MHAS_wealth, k37a_2, k37b_2, k37c_2)[is.na(MHAS_wealth$i_credits),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$i_credits <- car::recode(MHAS_wealth$i_credits, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '9NANA'=NA; 'NANANA'=NA")

m <- c(6000, 12000, 48000)
m1 <- median(MHAS_wealth$k33_3[which(MHAS_wealth$k33_3<m[1])])
m2 <- median(MHAS_wealth$k33_3[which(MHAS_wealth$k33_3>m[1] & MHAS_wealth$k33_3<m[2])])
m3 <- median(MHAS_wealth$k33_3[which(MHAS_wealth$k33_3>m[2] & MHAS_wealth$k33_3<m[3])])
m4 <- median(MHAS_wealth$k33_3[which(MHAS_wealth$k33_3>m[3])])

MHAS_wealth$stocks <- car::recode(MHAS_wealth$k33_3, "9999999=NA; 8888888=NA")
MHAS_wealth$stocks[is.na(MHAS_wealth$stocks)] <- apply(X = select(MHAS_wealth, k34a_3, k34b_3, k34c_3)[is.na(MHAS_wealth$stocks),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$stocks <- car::recode(MHAS_wealth$stocks, "'1NA1'=m4; '1NA2'=m3; '21NA'=m2; '22NA'=m1; '9NANA'=NA; 'NANANA'=NA")

m <- 12*c(100, 200, 1000)
MHAS_wealth$k36_3 <- MHAS_wealth$k36_3*12
m1 <- median(MHAS_wealth$k36_3[which(MHAS_wealth$k36_3<m[1])])
m2 <- median(MHAS_wealth$k36_3[which(MHAS_wealth$k36_3>m[1] & MHAS_wealth$k36_3<m[2])])
m3 <- median(MHAS_wealth$k36_3[which(MHAS_wealth$k36_3>m[2] & MHAS_wealth$k36_3<m[3])])
m4 <- median(MHAS_wealth$k36_3[which(MHAS_wealth$k36_3>m[3])])

MHAS_wealth$i_stocks <- car::recode(MHAS_wealth$k36_3, "9999999=NA; 8888888=NA")
MHAS_wealth$i_stocks[is.na(MHAS_wealth$i_stocks)] <- apply(X = select(MHAS_wealth, k37a_3, k37b_3, k37c_3)[is.na(MHAS_wealth$i_stocks),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$i_stocks <- car::recode(MHAS_wealth$i_stocks, "'1NA1'=m4; '1NA2'=m3; '21NA'=m2; '22NA'=m1; '9NANA'=NA; 'NANANA'=NA")

m <- c(50000, 100000, 250000)
m1 <- median(MHAS_wealth$k42[which(MHAS_wealth$k42<m[1])])
m2 <- median(MHAS_wealth$k42[which(MHAS_wealth$k42>m[1] & MHAS_wealth$k42<m[2])])
m3 <- median(MHAS_wealth$k42[which(MHAS_wealth$k42>m[2] & MHAS_wealth$k42<m[3])])
m4 <- median(MHAS_wealth$k42[which(MHAS_wealth$k42>m[3])])

MHAS_wealth$vehicles <- car::recode(MHAS_wealth$k42, "9999999=NA; 8888888=NA")
MHAS_wealth$vehicles[is.na(MHAS_wealth$vehicles)] <- apply(X = select(MHAS_wealth, k43a_3, k43b_3, k43c_3)[is.na(MHAS_wealth$vehicles),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$vehicles <- car::recode(MHAS_wealth$vehicles, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

m1 <- median(MHAS_wealth$k44[which(MHAS_wealth$k44<m[1])])
m2 <- median(MHAS_wealth$k44[which(MHAS_wealth$k44>m[1] & MHAS_wealth$k44<m[2])])
m3 <- median(MHAS_wealth$k44[which(MHAS_wealth$k44>m[2] & MHAS_wealth$k44<m[3])])
m4 <- median(MHAS_wealth$k44[which(MHAS_wealth$k44>m[3])])

MHAS_wealth$other <- car::recode(MHAS_wealth$k44, "9999999=NA; 8888888=NA")
MHAS_wealth$other[is.na(MHAS_wealth$other)] <- apply(X = select(MHAS_wealth, k45a_3, k45b_3, k45c_3)[is.na(MHAS_wealth$other),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$other <- car::recode(MHAS_wealth$other, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

m <- c(1000, 4000, 8000)
m1 <- median(MHAS_wealth$k47a[which(MHAS_wealth$k47a<m[1])])
m2 <- median(MHAS_wealth$k47a[which(MHAS_wealth$k47a>m[1] & MHAS_wealth$k47a<m[2])])
m3 <- median(MHAS_wealth$k47a[which(MHAS_wealth$k47a>m[2] & MHAS_wealth$k47a<m[3])])
m4 <- median(MHAS_wealth$k47a[which(MHAS_wealth$k47a>m[3])])

MHAS_wealth$salary <- car::recode(MHAS_wealth$k47a, "9999999=NA; 8888888=NA")
MHAS_wealth$salary[is.na(MHAS_wealth$salary)] <- apply(X = select(MHAS_wealth, k47b1, k47b2, k47b3)[is.na(MHAS_wealth$salary),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$salary <- car::recode(MHAS_wealth$salary, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

m1 <- median(MHAS_wealth$k48a[which(MHAS_wealth$k48a<m[1])])
m2 <- median(MHAS_wealth$k48a[which(MHAS_wealth$k48a>m[1] & MHAS_wealth$k48a<m[2])])
m3 <- median(MHAS_wealth$k48a[which(MHAS_wealth$k48a>m[2] & MHAS_wealth$k48a<m[3])])
m4 <- median(MHAS_wealth$k48a[which(MHAS_wealth$k48a>m[3])])

MHAS_wealth$bonus <- car::recode(MHAS_wealth$k48a, "9999999=NA; 8888888=NA")
MHAS_wealth$bonus[is.na(MHAS_wealth$bonus)] <- apply(X = select(MHAS_wealth, k48b1, k48b2, k48b3)[is.na(MHAS_wealth$bonus),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$bonus <- car::recode(MHAS_wealth$bonus, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

m1 <- median(MHAS_wealth$k50a[which(MHAS_wealth$k50a<m[1])])
m2 <- median(MHAS_wealth$k50a[which(MHAS_wealth$k50a>m[1] & MHAS_wealth$k50a<m[2])])
m3 <- median(MHAS_wealth$k50a[which(MHAS_wealth$k50a>m[2] & MHAS_wealth$k50a<m[3])])
m4 <- median(MHAS_wealth$k50a[which(MHAS_wealth$k50a>m[3])])

MHAS_wealth$salary2 <- car::recode(MHAS_wealth$k50a, "9999999=NA; 8888888=NA")
MHAS_wealth$salary2[is.na(MHAS_wealth$salary2)] <- apply(X = select(MHAS_wealth, k50b1, k50b2, k50b3)[is.na(MHAS_wealth$salary2),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$salary2 <- car::recode(MHAS_wealth$salary2, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

m1 <- median(MHAS_wealth$k51a[which(MHAS_wealth$k51a<m[1])])
m2 <- median(MHAS_wealth$k51a[which(MHAS_wealth$k51a>m[1] & MHAS_wealth$k51a<m[2])])
m3 <- median(MHAS_wealth$k51a[which(MHAS_wealth$k51a>m[2] & MHAS_wealth$k51a<m[3])])
m4 <- median(MHAS_wealth$k51a[which(MHAS_wealth$k51a>m[3])])

MHAS_wealth$bonus2 <- car::recode(MHAS_wealth$k51a, "9999999=NA; 8888888=NA")
MHAS_wealth$bonus2[is.na(MHAS_wealth$bonus2)] <- apply(X = select(MHAS_wealth, k51b1, k51b2, k51b3)[is.na(MHAS_wealth$bonus2),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$bonus2 <- car::recode(MHAS_wealth$bonus2, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

m1 <- median(MHAS_wealth$k53a[which(MHAS_wealth$k53a<m[1])])
m2 <- median(MHAS_wealth$k53a[which(MHAS_wealth$k53a>m[1] & MHAS_wealth$k53a<m[2])])
m3 <- median(MHAS_wealth$k53a[which(MHAS_wealth$k53a>m[2] & MHAS_wealth$k53a<m[3])])
m4 <- median(MHAS_wealth$k53a[which(MHAS_wealth$k53a>m[3])])

MHAS_wealth$s_salary <- car::recode(MHAS_wealth$k53a, "9999999=NA; 8888888=NA")
MHAS_wealth$s_salary[is.na(MHAS_wealth$s_salary)] <- apply(X = select(MHAS_wealth, k53b1, k53b2, k53b3)[is.na(MHAS_wealth$s_salary),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$s_salary <- car::recode(MHAS_wealth$s_salary, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

m1 <- median(MHAS_wealth$k54a[which(MHAS_wealth$k54a<m[1])])
m2 <- median(MHAS_wealth$k54a[which(MHAS_wealth$k54a>m[1] & MHAS_wealth$k54a<m[2])])
m3 <- median(MHAS_wealth$k54a[which(MHAS_wealth$k54a>m[2] & MHAS_wealth$k54a<m[3])])
m4 <- median(MHAS_wealth$k54a[which(MHAS_wealth$k54a>m[3])])

MHAS_wealth$s_bonus <- car::recode(MHAS_wealth$k54a, "9999999=NA; 8888888=NA")
MHAS_wealth$s_bonus[is.na(MHAS_wealth$s_bonus)] <- apply(X = select(MHAS_wealth, k54b1, k54b2, k54b3)[is.na(MHAS_wealth$s_bonus),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$s_bonus <- car::recode(MHAS_wealth$s_bonus, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

m1 <- median(MHAS_wealth$k56a[which(MHAS_wealth$k56a<m[1])])
m2 <- median(MHAS_wealth$k56a[which(MHAS_wealth$k56a>m[1] & MHAS_wealth$k56a<m[2])])
m3 <- median(MHAS_wealth$k56a[which(MHAS_wealth$k56a>m[2] & MHAS_wealth$k56a<m[3])])
m4 <- median(MHAS_wealth$k56a[which(MHAS_wealth$k56a>m[3])])

MHAS_wealth$s_salary2 <- car::recode(MHAS_wealth$k56a, "9999999=NA; 8888888=NA")
MHAS_wealth$s_salary2[is.na(MHAS_wealth$s_salary2)] <- apply(X = select(MHAS_wealth, k56b1, k56b2, k56b3)[is.na(MHAS_wealth$s_salary2),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$s_salary2 <- car::recode(MHAS_wealth$s_salary2, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

m1 <- median(MHAS_wealth$k57a[which(MHAS_wealth$k57a<m[1])])
m2 <- median(MHAS_wealth$k57a[which(MHAS_wealth$k57a>m[1] & MHAS_wealth$k57a<m[2])])
m3 <- median(MHAS_wealth$k57a[which(MHAS_wealth$k57a>m[2] & MHAS_wealth$k57a<m[3])])
m4 <- median(MHAS_wealth$k57a[which(MHAS_wealth$k57a>m[3])])

MHAS_wealth$s_bonus2 <- car::recode(MHAS_wealth$k57a, "9999999=NA; 8888888=NA")
MHAS_wealth$s_bonus2[is.na(MHAS_wealth$s_bonus2)] <- apply(X = select(MHAS_wealth, k57b1, k57b2, k57b3)[is.na(MHAS_wealth$s_bonus2),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$s_bonus2 <- car::recode(MHAS_wealth$s_bonus2, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

m1 <- median(MHAS_wealth$k57a[which(MHAS_wealth$k57a<m[1])])
m2 <- median(MHAS_wealth$k57a[which(MHAS_wealth$k57a>m[1] & MHAS_wealth$k57a<m[2])])
m3 <- median(MHAS_wealth$k57a[which(MHAS_wealth$k57a>m[2] & MHAS_wealth$k57a<m[3])])
m4 <- median(MHAS_wealth$k57a[which(MHAS_wealth$k57a>m[3])])

MHAS_wealth$s_bonus2 <- car::recode(MHAS_wealth$k57a, "9999999=NA; 8888888=NA")
MHAS_wealth$s_bonus2[is.na(MHAS_wealth$s_bonus2)] <- apply(X = select(MHAS_wealth, k57b1, k57b2, k57b3)[is.na(MHAS_wealth$s_bonus2),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$s_bonus2 <- car::recode(MHAS_wealth$s_bonus2, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")


m <- c(500, 1000, 4000)
m1 <- median(MHAS_wealth$k61a[which(MHAS_wealth$k61a<m[1])])
m2 <- median(MHAS_wealth$k61a[which(MHAS_wealth$k61a>m[1] & MHAS_wealth$k61a<m[2])])
m3 <- median(MHAS_wealth$k61a[which(MHAS_wealth$k61a>m[2] & MHAS_wealth$k61a<m[3])])
m4 <- median(MHAS_wealth$k61a[which(MHAS_wealth$k61a>m[3])])
MHAS_wealth$pension <- car::recode(MHAS_wealth$k61a, "9999999=NA; 8888888=NA")
MHAS_wealth$pension[is.na(MHAS_wealth$pension)] <- apply(X = select(MHAS_wealth, k62a_a, k62b_a, k62c_a)[is.na(MHAS_wealth$pension),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$pension <- car::recode(MHAS_wealth$pension, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")


m1 <- median(MHAS_wealth$k61b[which(MHAS_wealth$k61b<m[1])])
m2 <- median(MHAS_wealth$k61b[which(MHAS_wealth$k61b>m[1] & MHAS_wealth$k61b<m[2])])
m3 <- median(MHAS_wealth$k61b[which(MHAS_wealth$k61b>m[2] & MHAS_wealth$k61b<m[3])])
m4 <- median(MHAS_wealth$k61b[which(MHAS_wealth$k61b>m[3])])

MHAS_wealth$pension2 <- car::recode(MHAS_wealth$k61b, "9999999=NA; 8888888=NA")
MHAS_wealth$pension2[is.na(MHAS_wealth$pension2)] <- apply(X = select(MHAS_wealth, k62a_b, k62b_b, k62c_b)[is.na(MHAS_wealth$pension2),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$pension2 <- car::recode(MHAS_wealth$pension2, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

m1 <- median(MHAS_wealth$k61c[which(MHAS_wealth$k61c<m[1])])
m2 <- median(MHAS_wealth$k61c[which(MHAS_wealth$k61c>m[1] & MHAS_wealth$k61c<m[2])])
m3 <- median(MHAS_wealth$k61c[which(MHAS_wealth$k61c>m[2] & MHAS_wealth$k61c<m[3])])
m4 <- median(MHAS_wealth$k61c[which(MHAS_wealth$k61c>m[3])])

MHAS_wealth$pension3 <- car::recode(MHAS_wealth$k61c, "9999999=NA; 8888888=NA")
MHAS_wealth$pension3[is.na(MHAS_wealth$pension3)] <- apply(X = select(MHAS_wealth, k62a_c, k62b_c, k62c_c)[is.na(MHAS_wealth$pension3),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$pension3 <- car::recode(MHAS_wealth$pension3, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

m1 <- median(MHAS_wealth$k61d[which(MHAS_wealth$k61d<m[1])])
m2 <- median(MHAS_wealth$k61d[which(MHAS_wealth$k61d>m[1] & MHAS_wealth$k61d<m[2])])
m3 <- median(MHAS_wealth$k61d[which(MHAS_wealth$k61d>m[2] & MHAS_wealth$k61d<m[3])])
m4 <- median(MHAS_wealth$k61d[which(MHAS_wealth$k61d>m[3])])

MHAS_wealth$pension4 <- car::recode(MHAS_wealth$k61d, "9999999=NA; 8888888=NA")
MHAS_wealth$pension4[is.na(MHAS_wealth$pension4)] <- apply(X = select(MHAS_wealth, k62a_d, k62b_d, k62c_d)[is.na(MHAS_wealth$pension4),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$pension4 <- car::recode(MHAS_wealth$pension4, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

m1 <- median(MHAS_wealth$k65c[which(MHAS_wealth$k65c<m[1])])
m2 <- median(MHAS_wealth$k65c[which(MHAS_wealth$k65c>m[1] & MHAS_wealth$k65c<m[2])])
m3 <- median(MHAS_wealth$k65c[which(MHAS_wealth$k65c>m[2] & MHAS_wealth$k65c<m[3])])
m4 <- median(MHAS_wealth$k65c[which(MHAS_wealth$k65c>m[3])])

MHAS_wealth$s_pension <- car::recode(MHAS_wealth$k65c, "9999999=NA; 8888888=NA")
MHAS_wealth$s_pension[is.na(MHAS_wealth$s_pension)] <- apply(X = select(MHAS_wealth, k68a_c, k68b_c, k68c_c)[is.na(MHAS_wealth$s_pension),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$s_pension <- car::recode(MHAS_wealth$s_pension, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

m1 <- median(MHAS_wealth$k67d[which(MHAS_wealth$k67d<m[1])])
m2 <- median(MHAS_wealth$k67d[which(MHAS_wealth$k67d>m[1] & MHAS_wealth$k67d<m[2])])
m3 <- median(MHAS_wealth$k67d[which(MHAS_wealth$k67d>m[2] & MHAS_wealth$k67d<m[3])])
m4 <- median(MHAS_wealth$k67d[which(MHAS_wealth$k67d>m[3])])

MHAS_wealth$s_pension2 <- car::recode(MHAS_wealth$k67d, "9999999=NA; 8888888=NA")
MHAS_wealth$s_pension2[is.na(MHAS_wealth$s_pension2)] <- apply(X = select(MHAS_wealth, k68a_d, k68b_d, k68c_d)[is.na(MHAS_wealth$s_pension2),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$s_pension2 <- car::recode(MHAS_wealth$s_pension2, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

m1 <- median(MHAS_wealth$k67e[which(MHAS_wealth$k67e<m[1])])
m2 <- median(MHAS_wealth$k67e[which(MHAS_wealth$k67e>m[1] & MHAS_wealth$k67e<m[2])])
m3 <- median(MHAS_wealth$k67e[which(MHAS_wealth$k67e>m[2] & MHAS_wealth$k67e<m[3])])
m4 <- median(MHAS_wealth$k67e[which(MHAS_wealth$k67e>m[3])])

MHAS_wealth$s_pension3 <- car::recode(MHAS_wealth$k67e, "9999999=NA; 8888888=NA")
MHAS_wealth$s_pension3[is.na(MHAS_wealth$s_pension3)] <- apply(X = select(MHAS_wealth, k68a_e, k68b_e, k68c_e)[is.na(MHAS_wealth$s_pension3),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$s_pension3 <- car::recode(MHAS_wealth$s_pension3, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")


m1 <- median(MHAS_wealth$k67f[which(MHAS_wealth$k67f<m[1])])
m2 <- median(MHAS_wealth$k67f[which(MHAS_wealth$k67f>m[1] & MHAS_wealth$k67f<m[2])])
m3 <- median(MHAS_wealth$k67f[which(MHAS_wealth$k67f>m[2] & MHAS_wealth$k67f<m[3])])
m4 <- median(MHAS_wealth$k67f[which(MHAS_wealth$k67f>m[3])])

MHAS_wealth$s_pension4 <- car::recode(MHAS_wealth$k67f, "9999999=NA; 8888888=NA")
MHAS_wealth$s_pension4[is.na(MHAS_wealth$s_pension4)] <- apply(X = select(MHAS_wealth, k68a_f, k68b_f, k68c_f)[is.na(MHAS_wealth$s_pension4),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$s_pension4 <- car::recode(MHAS_wealth$s_pension4, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")
```

```{r local2, echo=F}
vari <- MHAS_wealth$bisnes1
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$bisnes2
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$i_bisnes1
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$i_bisnes2
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$estate1
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$estate2
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$i_estate1
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$i_estate2
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$accounts
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$i_accounts
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$credits
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$i_credits
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$stocks
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$i_stocks
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$vehicles
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$other
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$salary
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$bonus
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$salary2
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$bonus2
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$s_salary
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$s_bonus
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$s_salary2
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$s_bonus2
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$pension
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$pension2
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$pension3
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$pension4
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$s_pension
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$s_pension2
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$s_pension3
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$s_pension4
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$k80a
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$k80b
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$k83c
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$k83d
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$k83e
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 

vari <- MHAS_wealth$k80c
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(MHAS_wealth, aes(vari)) + geom_histogram(stat="count", fill="steelblue") + xlab(ds_label) + ylab("Frequency") 
```


#### Harmonisation algorithm
To compute the harmonized variable from the study specific varibale sum up all the variables and divide the population into 5 groups each containing 20$\%$ of the corresponding N and the missing values have to be recoded as follows: 

* `NA into 999`

**R script:**

```{r harmo2}
MHAS_wealth$sum <- apply(X = select(MHAS_wealth, bisnes1, bisnes2, i_bisnes1, i_bisnes2, estate1, estate2, i_estate1, i_estate2, accounts, i_accounts, credits, i_credits, stocks, i_stocks, vehicles, other, salary, bonus, salary2, bonus2, s_salary, s_bonus, s_salary2, s_bonus2, pension, pension2, pension3, pension4, s_pension, s_pension2, s_pension3, s_pension4, k80a, k80b, k83c, k83d, k83e, k80c), MARGIN = 1, FUN = function(x) sum(as.numeric(x), na.rm = TRUE))
MHAS_wealth$sum <- car::recode(MHAS_wealth$sum, "0=NA")

qq <- quantile(MHAS_wealth$sum, probs = seq(0, 1, .2), na.rm = TRUE)

MHAS_ds_w2 <- tibble(id=MHAS_wealth$id)
MHAS_ds_w2$wealth <- car::recode(MHAS_wealth$sum, "0:qq[2]=1; (qq[2]+1):qq[3]=2; (qq[3]+1):qq[4]=3; (qq[4]+1):qq[5]=4; (qq[5]+1):hi=5")
MHAS_ds_w2$wealth <- car::recode(MHAS_ds_w2$wealth, "NA=999")
MHAS_ds_w2$wealth <- as.integer(MHAS_ds_w2$wealth)
MHAS_ds_w2$wealth <- labelled(MHAS_ds_w2$wealth, labels = c("Missing"=999, "Do not know"=998, "Refuse"=997, "Not applicable"=996, "Does not answer"=995,  "Not attempt not done"=994, "Disable to measure"=993, "Impute"=992, "CAPI interviewer error"=991))
```

#### Statistics of the new harmonised variable
```{r descript2, echo=F}
vari <- MHAS_ds_w2$wealth
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[3], caption = ds_label) 
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[2], caption = "Type of missing")
ggplot(MHAS_ds_w2, aes(x=factor(wealth))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab(ds_label) + ylab("Frequency")
```

#### Validation
```{r crosstabulation2, echo=F}
```





```{r importOPAL2, echo=F}

#opal.assign.data(o, 'MHAS_ds_w2', MHAS_ds_w2)
#opal.symbol_import(o,'MHAS_ds_w2', project='_Athlos_Harm_Dataset')
wealth <- MHAS_ds_w2
save(wealth, file = "../RData/w2/wealth.RData")
rm(wealth)

MHAS_m_ds_w2 <- MHAS_ds_w2
MHAS_m_ds_w2$wealth <- car::recode(MHAS_m_ds_w2$wealth, "c(991, 992, 993, 994, 995, 996, 997,998, 999)=NA")
#opal.assign.data(o, 'MHAS_m_ds_w2', MHAS_m_ds_w2)
#opal.symbol_import(o,'MHAS_m_ds_w2', project='_Athlos_Harm_Dataset')
```








### Wave 3 

#### Study-specific variable description

| **Name** | `a1_1` |
|----------|------------|
| **Label** | `Day of birth` |
| **Table name** | `MHAS-2001` |
| **Missings** | `99 = Don't know` |
| **Description** |  |


```{r assign3, echo=F}
opal.assign.table.tibble(o, 'MHAS_wealth2','Mexican Health Aging Study.sect_g_j_k_sa_2012',
                         variables=list('k8_1_12', 'k9a1_12', 'k9b1_12', 'k9c1_12', 'k8_2_12', 'k9a2_12', 'k9b2_12', 'k9c2_12', 'k11_1_12', 'k12a1_12', 'k12b1_12', 'k12c1_12', 'k11_2_12', 'k12a2_12', 'k12b2_12', 'k12c2_12', 'k24_1_12', 'k25a1_12', 'k25b1_12', 'k25c1_12', 'k24_2_12', 'k25a2_12', 'k25b2_12', 'k25c2_12', 'k27_1_12', 'k28a1_12', 'k28b1_12', 'k28c1_12', 'k27_2_12', 'k28a2_12', 'k28b2_12', 'k28c2_12', 'k33_1_12', 'k34a1_12', 'k34b1_12', 'k34c1_12', 'k35_1_12', 'k33_2_12', 'k34a2_12', 'k34b2_12', 'k34c2_12', 'k36_2_12', 'k37a2_12', 'k37b2_12', 'k37c2_12', 'k33_3_12', 'k34a3_12', 'k34b3_12', 'k34c3_12', 'k36_3_12', 'k37a3_12', 'k37b3_12', 'k37c3_12', 'k42_12', 'k43a_12', 'k43b_12', 'k43c_12', 'k36_1_12', 'k37a1_12', 'k37b1_12', 'k37c1_12', 'k44_12', 'k45a_12', 'k45b_12', 'k45c_12', 'k47a_12', 'k47b1_12', 'k47b2_12', 'k47b3_12', 'k48a_12', 'k48b1_12', 'k48b2_12', 'k48b3_12', 'k50a_12', 'k50b1_12', 'k50b2_12', 'k50b3_12', 'k51a_12', 'k51b1_12', 'k51b2_12', 'k51b3_12', 'k53a_12', 'k53b1_12', 'k53b2_12', 'k53b3_12', 'k54a_12', 'k54b1_12', 'k54b2_12', 'k54b3_12', 'k56a_12', 'k56b1_12', 'k56b2_12', 'k56b3_12', 'k57a_12', 'k57b1_12', 'k57b2_12', 'k57b3_12', 'k61_1_12', 'k62a1_12', 'k62b1_12', 'k62c1_12', 'k61_2_12', 'k62a2_12', 'k62b2_12', 'k62c2_12', 'k61_3_12', 'k62a3_12', 'k62b3_12', 'k62c3_12', 'k61_4_12', 'k62a4_12', 'k62b4_12', 'k62c4_12', 'k67_1_12', 'k68a1_12', 'k68b1_12', 'k68c1_12', 'k67_2_12', 'k68a2_12', 'k68b2_12', 'k68c2_12', 'k67_3_12', 'k68a3_12', 'k68b3_12', 'k68c3_12', 'k67_4_12', 'k68a4_12', 'k68b4_12', 'k68c4_12', 'k80_1_12', 'k80_2_12', 'k80_3_12', 'k83_1_12', 'k83_2_12', 'k83_3_12'), missings = TRUE)
MHAS_wealth2 <- opal.execute(o,'MHAS_wealth2')

opal.assign.table.tibble(o, 'MHAS_w3_id','Mexican Health Aging Study.MHAS_2012_new',
                         variables=list('cunicah'), missings = TRUE)
MHAS_w3_id <- opal.execute(o,'MHAS_w3_id')


names(MHAS_wealth2) <- c("cunicah", names(MHAS_wealth2)[2:length(names(MHAS_wealth2))])
MHAS_wealth2$cunicah <- as.integer(MHAS_wealth2$cunicah)
attributes(MHAS_wealth2$cunicah) <- NULL
MHAS_wealth <- left_join(MHAS_w3_id, MHAS_wealth2, by='cunicah')
MHAS_wealth <- distinct(MHAS_wealth,id, .keep_all=TRUE)
```


##### Data management

Each question was asked in continous way and if the respondent did not know it, it was reasked in categorical way using three variables in order to fit the individuals into 5 intervals.
For this reason, it was joined the information of the continous and categorical way in one variable using the continous number and ifelse the median of each interval. 


```{r dm3, echo=TRUE}
m <- c(40000, 120000, 400000)
m1 <- median(MHAS_wealth$k8_1_12[which(MHAS_wealth$k8_1_12<m[1])])
m2 <- median(MHAS_wealth$k8_1_12[which(MHAS_wealth$k8_1_12>m[1] & MHAS_wealth$k8_1_12<m[2])])
m3 <- median(MHAS_wealth$k8_1_12[which(MHAS_wealth$k8_1_12>m[2] & MHAS_wealth$k8_1_12<m[3])])
m4 <- median(MHAS_wealth$k8_1_12[which(MHAS_wealth$k8_1_12>m[3])])

MHAS_wealth$bisnes1 <- car::recode(MHAS_wealth$k8_1_12, "9999999=NA; 8888888=NA")
MHAS_wealth$bisnes1[is.na(MHAS_wealth$bisnes1)] <- apply(X = select(MHAS_wealth, k9a1_12, k9b1_12, k9c1_12)[is.na(MHAS_wealth$bisnes1),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$bisnes1 <- car::recode(MHAS_wealth$bisnes1, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")


m1 <- median(MHAS_wealth$k8_2_12[which(MHAS_wealth$k8_2_12<m[1])])
m2 <- median(MHAS_wealth$k8_2_12[which(MHAS_wealth$k8_2_12>m[1] & MHAS_wealth$k8_2_12<m[2])])
m3 <- median(MHAS_wealth$k8_2_12[which(MHAS_wealth$k8_2_12>m[2] & MHAS_wealth$k8_2_12<m[3])])
m4 <- median(MHAS_wealth$k8_2_12[which(MHAS_wealth$k8_2_12>m[3])])

MHAS_wealth$bisnes2 <- car::recode(MHAS_wealth$k8_2_12, "9999999=NA; 8888888=NA")
MHAS_wealth$bisnes2[is.na(MHAS_wealth$bisnes2)] <- apply(X = select(MHAS_wealth, k9a2_12, k9b2_12, k9c2_12)[is.na(MHAS_wealth$bisnes2),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$bisnes2 <- car::recode(MHAS_wealth$bisnes2, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

MHAS_wealth$k11_1_12 <- MHAS_wealth$k11_1_12*12
m <- c(15000, 45000, 150000)*12
m1 <- median(MHAS_wealth$k11_1_12[which(MHAS_wealth$k11_1_12<m[1])])
m2 <- median(MHAS_wealth$k11_1_12[which(MHAS_wealth$k11_1_12>m[1] & MHAS_wealth$k11_1_12<m[2])])
m3 <- median(MHAS_wealth$k11_1_12[which(MHAS_wealth$k11_1_12>m[2] & MHAS_wealth$k11_1_12<m[3])])
m4 <- median(MHAS_wealth$k11_1_12[which(MHAS_wealth$k11_1_12>m[3])])

MHAS_wealth$i_bisnes1 <- car::recode(MHAS_wealth$k11_1_12, "12*9999999=NA; 12*8888888=NA")
MHAS_wealth$i_bisnes1[is.na(MHAS_wealth$i_bisnes1)] <- apply(X = select(MHAS_wealth, k12a1_12, k12b1_12, k12c1_12)[is.na(MHAS_wealth$i_bisnes1),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$i_bisnes1 <- car::recode(MHAS_wealth$i_bisnes1, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

MHAS_wealth$k11_2_12 <- MHAS_wealth$k11_2_12*12
m1 <- median(MHAS_wealth$k11_2_12[which(MHAS_wealth$k11_2_12<m[1])])
m2 <- median(MHAS_wealth$k11_2_12[which(MHAS_wealth$k11_2_12>m[1] & MHAS_wealth$k11_2_12<m[2])])
m3 <- median(MHAS_wealth$k11_2_12[which(MHAS_wealth$k11_2_12>m[2] & MHAS_wealth$k11_2_12<m[3])])
m4 <- median(MHAS_wealth$k11_2_12[which(MHAS_wealth$k11_2_12>m[3])])

MHAS_wealth$i_bisnes2 <- car::recode(MHAS_wealth$k11_2_12, "12*9999999=NA; 12*8888888=NA")
MHAS_wealth$i_bisnes2[is.na(MHAS_wealth$i_bisnes2)] <- apply(X = select(MHAS_wealth, k12a2_12, k12b2_12, k12c2_12)[is.na(MHAS_wealth$i_bisnes2),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$i_bisnes2 <- car::recode(MHAS_wealth$i_bisnes2, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

m <- c(75000, 150000, 400000)
m1 <- median(MHAS_wealth$k24_1_12[which(MHAS_wealth$k24_1_12<m[1])])
m2 <- median(MHAS_wealth$k24_1_12[which(MHAS_wealth$k24_1_12>m[1] & MHAS_wealth$k24_1_12<m[2])])
m3 <- median(MHAS_wealth$k24_1_12[which(MHAS_wealth$k24_1_12>m[2] & MHAS_wealth$k24_1_12<m[3])])
m4 <- median(MHAS_wealth$k24_1_12[which(MHAS_wealth$k24_1_12>m[3])])

MHAS_wealth$estate1 <- car::recode(MHAS_wealth$k24_1_12, "9999999=NA; 8888888=NA")
MHAS_wealth$estate1[is.na(MHAS_wealth$estate1)] <- apply(X = select(MHAS_wealth, k25a1_12, k25b1_12, k25c1_12)[is.na(MHAS_wealth$estate1),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$estate1 <- car::recode(MHAS_wealth$estate1, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

m1 <- median(MHAS_wealth$k24_2_12[which(MHAS_wealth$k24_2_12<m[1])])
m2 <- median(MHAS_wealth$k24_2_12[which(MHAS_wealth$k24_2_12>m[1] & MHAS_wealth$k24_2_12<m[2])])
m3 <- median(MHAS_wealth$k24_2_12[which(MHAS_wealth$k24_2_12>m[2] & MHAS_wealth$k24_2_12<m[3])])
m4 <- median(MHAS_wealth$k24_2_12[which(MHAS_wealth$k24_2_12>m[3])])

MHAS_wealth$estate2 <- car::recode(MHAS_wealth$k24_2_12, "9999999=NA; 8888888=NA")
MHAS_wealth$estate2[is.na(MHAS_wealth$estate2)] <- apply(X = select(MHAS_wealth, k25a2_12, k25b2_12, k25c2_12)[is.na(MHAS_wealth$estate2),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$estate2 <- car::recode(MHAS_wealth$estate2, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

MHAS_wealth$k27_1_12 <- MHAS_wealth$k27_1_12*12
m <- c(1500, 4500, 14000)*12
m1 <- median(MHAS_wealth$k27_1_12[which(MHAS_wealth$k27_1_12<m[1])])
m2 <- median(MHAS_wealth$k27_1_12[which(MHAS_wealth$k27_1_12>m[1] & MHAS_wealth$k27_1_12<m[2])])
m3 <- median(MHAS_wealth$k27_1_12[which(MHAS_wealth$k27_1_12>m[2] & MHAS_wealth$k27_1_12<m[3])])
m4 <- median(MHAS_wealth$k27_1_12[which(MHAS_wealth$k27_1_12>m[3])])

MHAS_wealth$i_estate1 <- car::recode(MHAS_wealth$k27_1_12, "12*9999999=NA; 12*8888888=NA")
MHAS_wealth$i_estate1[is.na(MHAS_wealth$i_estate1)] <- apply(X = select(MHAS_wealth, k28a1_12, k28b1_12, k28c1_12)[is.na(MHAS_wealth$i_estate1),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$i_estate1 <- car::recode(MHAS_wealth$i_estate1, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

MHAS_wealth$k27_2_12 <- MHAS_wealth$k27_2_12*12
m1 <- median(MHAS_wealth$k27_2_12[which(MHAS_wealth$k27_2_12<m[1])])
m2 <- median(MHAS_wealth$k27_2_12[which(MHAS_wealth$k27_2_12>m[1] & MHAS_wealth$k27_2_12<m[2])])
m3 <- median(MHAS_wealth$k27_2_12[which(MHAS_wealth$k27_2_12>m[2] & MHAS_wealth$k27_2_12<m[3])])
m4 <- median(MHAS_wealth$k27_2_12[which(MHAS_wealth$k27_2_12>m[3])])

MHAS_wealth$i_estate2 <- car::recode(MHAS_wealth$k27_2_12, "12*9999999=NA; 12*8888888=NA")
MHAS_wealth$i_estate2[is.na(MHAS_wealth$i_estate2)] <- apply(X = select(MHAS_wealth, k28a2_12, k28b2_12, k28c2_12)[is.na(MHAS_wealth$i_estate2),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$i_estate2 <- car::recode(MHAS_wealth$i_estate2, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")


m <- c(10000, 20000, 70000)
m1 <- median(MHAS_wealth$k33_1_12[which(MHAS_wealth$k33_1_12<m[1])])
m2 <- median(MHAS_wealth$k33_1_12[which(MHAS_wealth$k33_1_12>m[1] & MHAS_wealth$k33_1_12<m[2])])
m3 <- median(MHAS_wealth$k33_1_12[which(MHAS_wealth$k33_1_12>m[2] & MHAS_wealth$k33_1_12<m[3])])
m4 <- median(MHAS_wealth$k33_1_12[which(MHAS_wealth$k33_1_12>m[3])])

MHAS_wealth$accounts <- car::recode(MHAS_wealth$k33_1_12, "9999999=NA; 8888888=NA")
MHAS_wealth$accounts[is.na(MHAS_wealth$accounts)] <- apply(X = select(MHAS_wealth, k25a1_12, k25b1_12, k25c1_12)[is.na(MHAS_wealth$accounts),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$accounts <- car::recode(MHAS_wealth$accounts, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

MHAS_wealth$i_accounts <- car::recode(MHAS_wealth$k35_1_12, "9999999=NA; 8888888=NA")

m <- c(10000, 20000, 70000)
m1 <- median(MHAS_wealth$k33_2_12[which(MHAS_wealth$k33_2_12<m[1])])
m2 <- median(MHAS_wealth$k33_2_12[which(MHAS_wealth$k33_2_12>m[1] & MHAS_wealth$k33_2_12<m[2])])
m3 <- median(MHAS_wealth$k33_2_12[which(MHAS_wealth$k33_2_12>m[2] & MHAS_wealth$k33_2_12<m[3])])
m4 <- median(MHAS_wealth$k33_2_12[which(MHAS_wealth$k33_2_12>m[3])])

MHAS_wealth$loans <- car::recode(MHAS_wealth$k33_2_12, "9999999=NA; 8888888=NA")
MHAS_wealth$loans[is.na(MHAS_wealth$loans)] <- apply(X = select(MHAS_wealth, k34a2_12, k34b2_12, k34c2_12)[is.na(MHAS_wealth$loans),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$loans <- car::recode(MHAS_wealth$loans, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

MHAS_wealth$k36_2_12 <- MHAS_wealth$k36_2_12*12
m <- c(150, 300, 1500)*12
m1 <- median(MHAS_wealth$k36_2_12[which(MHAS_wealth$k36_2_12<m[1])])
m2 <- median(MHAS_wealth$k36_2_12[which(MHAS_wealth$k36_2_12>m[1] & MHAS_wealth$k36_2_12<m[2])])
m3 <- median(MHAS_wealth$k36_2_12[which(MHAS_wealth$k36_2_12>m[2] & MHAS_wealth$k36_2_12<m[3])])
m4 <- median(MHAS_wealth$k36_2_12[which(MHAS_wealth$k36_2_12>m[3])])

MHAS_wealth$i_loans <- car::recode(MHAS_wealth$k36_2_12, "12*9999999=NA; 12*8888888=NA")
MHAS_wealth$i_loans[is.na(MHAS_wealth$i_loans)] <- apply(X = select(MHAS_wealth, k37a2_12, k37b2_12, k37c2_12)[is.na(MHAS_wealth$i_loans),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$i_loans <- car::recode(MHAS_wealth$i_loans, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

m <- c(10000, 20000, 70000)
m1 <- median(MHAS_wealth$k33_3_12[which(MHAS_wealth$k33_3_12<m[1])])
m2 <- median(MHAS_wealth$k33_3_12[which(MHAS_wealth$k33_3_12>m[1] & MHAS_wealth$k33_3_12<m[2])])
m3 <- median(MHAS_wealth$k33_3_12[which(MHAS_wealth$k33_3_12>m[2] & MHAS_wealth$k33_3_12<m[3])])
m4 <- median(MHAS_wealth$k33_3_12[which(MHAS_wealth$k33_3_12>m[3])])

MHAS_wealth$stocks <- car::recode(MHAS_wealth$k33_3_12, "9999999=NA; 8888888=NA")
MHAS_wealth$stocks[is.na(MHAS_wealth$stocks)] <- apply(X = select(MHAS_wealth, k34a3_12, k34b3_12, k34c3_12)[is.na(MHAS_wealth$stocks),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$stocks <- car::recode(MHAS_wealth$stocks, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

MHAS_wealth$k36_3_12 <- MHAS_wealth$k36_3_12*12
m <- c(150, 300, 1500)*12
m1 <- median(MHAS_wealth$k36_3_12[which(MHAS_wealth$k36_3_12<m[1])])
m2 <- median(MHAS_wealth$k36_3_12[which(MHAS_wealth$k36_3_12>m[1] & MHAS_wealth$k36_3_12<m[2])])
m3 <- median(MHAS_wealth$k36_3_12[which(MHAS_wealth$k36_3_12>m[2] & MHAS_wealth$k36_3_12<m[3])])
m4 <- median(MHAS_wealth$k36_3_12[which(MHAS_wealth$k36_3_12>m[3])])

MHAS_wealth$i_stocks <- car::recode(MHAS_wealth$k36_3_12, "12*9999999=NA; 12*8888888=NA")
MHAS_wealth$i_stocks[is.na(MHAS_wealth$i_stocks)] <- apply(X = select(MHAS_wealth, k37a3_12, k37b3_12, k37c3_12)[is.na(MHAS_wealth$i_stocks),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$i_stocks <- car::recode(MHAS_wealth$i_stocks, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

m <- c(75000, 150000, 400000)
m1 <- median(MHAS_wealth$k42_12[which(MHAS_wealth$k42_12<m[1])])
m2 <- median(MHAS_wealth$k42_12[which(MHAS_wealth$k42_12>m[1] & MHAS_wealth$k42_12<m[2])])
m3 <- median(MHAS_wealth$k42_12[which(MHAS_wealth$k42_12>m[2] & MHAS_wealth$k42_12<m[3])])
m4 <- median(MHAS_wealth$k42_12[which(MHAS_wealth$k42_12>m[3])])

MHAS_wealth$vehicles <- car::recode(MHAS_wealth$k42_12, "9999999=NA; 8888888=NA")
MHAS_wealth$vehicles[is.na(MHAS_wealth$vehicles)] <- apply(X = select(MHAS_wealth, k43a_12, k43b_12, k43c_12)[is.na(MHAS_wealth$vehicles),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$vehicles <- car::recode(MHAS_wealth$vehicles, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

MHAS_wealth$k36_1_12 <- MHAS_wealth$k36_1_12*12
m <- c(150, 300, 1500)*12
m1 <- median(MHAS_wealth$k36_1_12[which(MHAS_wealth$k36_1_12<m[1])])
m2 <- median(MHAS_wealth$k36_1_12[which(MHAS_wealth$k36_1_12>m[1] & MHAS_wealth$k36_1_12<m[2])])
m3 <- median(MHAS_wealth$k36_1_12[which(MHAS_wealth$k36_1_12>m[2] & MHAS_wealth$k36_1_12<m[3])])
m4 <- median(MHAS_wealth$k36_1_12[which(MHAS_wealth$k36_1_12>m[3])])

MHAS_wealth$i_assets <- car::recode(MHAS_wealth$k36_1_12, "12*9999999=NA; 12*8888888=NA")
MHAS_wealth$i_assets[is.na(MHAS_wealth$i_assets)] <- apply(X = select(MHAS_wealth, k37a1_12, k37b1_12, k37c1_12)[is.na(MHAS_wealth$i_assets),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$i_assets <- car::recode(MHAS_wealth$i_assets, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

m <- c(75000, 150000, 400000)
m1 <- median(MHAS_wealth$k44_12[which(MHAS_wealth$k44_12<m[1])])
m2 <- median(MHAS_wealth$k44_12[which(MHAS_wealth$k44_12>m[1] & MHAS_wealth$k44_12<m[2])])
m3 <- median(MHAS_wealth$k44_12[which(MHAS_wealth$k44_12>m[2] & MHAS_wealth$k44_12<m[3])])
m4 <- median(MHAS_wealth$k44_12[which(MHAS_wealth$k44_12>m[3])])

MHAS_wealth$others_assets <- car::recode(MHAS_wealth$k44_12, "9999999=NA; 8888888=NA")
MHAS_wealth$others_assets[is.na(MHAS_wealth$others_assets)] <- apply(X = select(MHAS_wealth, k45a_12, k45b_12, k45c_12)[is.na(MHAS_wealth$others_assets),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$others_assets <- car::recode(MHAS_wealth$others_assets, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")


MHAS_wealth$k47a_12 <- MHAS_wealth$k47a_12*12
m <- c(1500, 6000, 12000)*12
m1 <- median(MHAS_wealth$k47a_12[which(MHAS_wealth$k47a_12<m[1])])
m2 <- median(MHAS_wealth$k47a_12[which(MHAS_wealth$k47a_12>m[1] & MHAS_wealth$k47a_12<m[2])])
m3 <- median(MHAS_wealth$k47a_12[which(MHAS_wealth$k47a_12>m[2] & MHAS_wealth$k47a_12<m[3])])
m4 <- median(MHAS_wealth$k47a_12[which(MHAS_wealth$k47a_12>m[3])])

MHAS_wealth$salary <- car::recode(MHAS_wealth$k47a_12, "12*9999999=NA; 12*8888888=NA")
MHAS_wealth$salary[is.na(MHAS_wealth$salary)] <- apply(X = select(MHAS_wealth, k47b1_12, k47b2_12, k47b3_12)[is.na(MHAS_wealth$salary),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$salary <- car::recode(MHAS_wealth$salary, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

MHAS_wealth$k50a_12 <- MHAS_wealth$k50a_12*12
m1 <- median(MHAS_wealth$k50a_12[which(MHAS_wealth$k50a_12<m[1])])
m2 <- median(MHAS_wealth$k50a_12[which(MHAS_wealth$k50a_12>m[1] & MHAS_wealth$k50a_12<m[2])])
m3 <- median(MHAS_wealth$k50a_12[which(MHAS_wealth$k50a_12>m[2] & MHAS_wealth$k50a_12<m[3])])
m4 <- median(MHAS_wealth$k50a_12[which(MHAS_wealth$k50a_12>m[3])])

MHAS_wealth$salary2 <- car::recode(MHAS_wealth$k50a_12, "12*9999999=NA; 12*8888888=NA")
MHAS_wealth$salary2[is.na(MHAS_wealth$salary2)] <- apply(X = select(MHAS_wealth, k50b1_12, k50b2_12, k50b3_12)[is.na(MHAS_wealth$salary2),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$salary2 <- car::recode(MHAS_wealth$salary2, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

MHAS_wealth$k48a_12 <- MHAS_wealth$k48a_12*12
m1 <- median(MHAS_wealth$k48a_12[which(MHAS_wealth$k48a_12<m[1])])
m2 <- median(MHAS_wealth$k48a_12[which(MHAS_wealth$k48a_12>m[1] & MHAS_wealth$k48a_12<m[2])])
m3 <- median(MHAS_wealth$k48a_12[which(MHAS_wealth$k48a_12>m[2] & MHAS_wealth$k48a_12<m[3])])
m4 <- median(MHAS_wealth$k48a_12[which(MHAS_wealth$k48a_12>m[3])])

MHAS_wealth$bonus <- car::recode(MHAS_wealth$k48a_12, "12*9999999=NA; 12*8888888=NA")
MHAS_wealth$bonus[is.na(MHAS_wealth$bonus)] <- apply(X = select(MHAS_wealth, k48b1_12, k48b2_12, k48b3_12)[is.na(MHAS_wealth$bonus),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$bonus <- car::recode(MHAS_wealth$bonus, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

MHAS_wealth$k51a_12 <- MHAS_wealth$k51a_12*12
m1 <- median(MHAS_wealth$k51a_12[which(MHAS_wealth$k51a_12<m[1])])
m2 <- median(MHAS_wealth$k51a_12[which(MHAS_wealth$k51a_12>m[1] & MHAS_wealth$k51a_12<m[2])])
m3 <- median(MHAS_wealth$k51a_12[which(MHAS_wealth$k51a_12>m[2] & MHAS_wealth$k51a_12<m[3])])
m4 <- median(MHAS_wealth$k51a_12[which(MHAS_wealth$k51a_12>m[3])])

MHAS_wealth$bonus2 <- car::recode(MHAS_wealth$k51a_12, "12*9999999=NA; 12*8888888=NA")
MHAS_wealth$bonus2[is.na(MHAS_wealth$bonus2)] <- apply(X = select(MHAS_wealth, k51b1_12, k51b2_12, k51b3_12)[is.na(MHAS_wealth$bonus2),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$bonus2 <- car::recode(MHAS_wealth$bonus2, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

MHAS_wealth$k53a_12 <- MHAS_wealth$k53a_12*12
m1 <- median(MHAS_wealth$k53a_12[which(MHAS_wealth$k53a_12<m[1])])
m2 <- median(MHAS_wealth$k53a_12[which(MHAS_wealth$k53a_12>m[1] & MHAS_wealth$k53a_12<m[2])])
m3 <- median(MHAS_wealth$k53a_12[which(MHAS_wealth$k53a_12>m[2] & MHAS_wealth$k53a_12<m[3])])
m4 <- median(MHAS_wealth$k53a_12[which(MHAS_wealth$k53a_12>m[3])])

MHAS_wealth$s_salary <- car::recode(MHAS_wealth$k53a_12, "12*9999999=NA; 12*8888888=NA")
MHAS_wealth$s_salary[is.na(MHAS_wealth$s_salary)] <- apply(X = select(MHAS_wealth, k53b1_12, k53b2_12, k53b3_12)[is.na(MHAS_wealth$s_salary),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$s_salary <- car::recode(MHAS_wealth$s_salary, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

MHAS_wealth$k54a_12 <- MHAS_wealth$k54a_12*12
m1 <- median(MHAS_wealth$k54a_12[which(MHAS_wealth$k54a_12<m[1])])
m2 <- median(MHAS_wealth$k54a_12[which(MHAS_wealth$k54a_12>m[1] & MHAS_wealth$k54a_12<m[2])])
m3 <- median(MHAS_wealth$k54a_12[which(MHAS_wealth$k54a_12>m[2] & MHAS_wealth$k54a_12<m[3])])
m4 <- median(MHAS_wealth$k54a_12[which(MHAS_wealth$k54a_12>m[3])])

MHAS_wealth$s_bonus <- car::recode(MHAS_wealth$k54a_12, "12*9999999=NA; 12*8888888=NA")
MHAS_wealth$s_bonus[is.na(MHAS_wealth$s_bonus)] <- apply(X = select(MHAS_wealth, k54b1_12, k54b2_12, k54b3_12)[is.na(MHAS_wealth$s_bonus),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$s_bonus <- car::recode(MHAS_wealth$s_bonus, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

MHAS_wealth$k56a_12 <- MHAS_wealth$k56a_12*12
m1 <- median(MHAS_wealth$k56a_12[which(MHAS_wealth$k56a_12<m[1])])
m2 <- median(MHAS_wealth$k56a_12[which(MHAS_wealth$k56a_12>m[1] & MHAS_wealth$k56a_12<m[2])])
m3 <- median(MHAS_wealth$k56a_12[which(MHAS_wealth$k56a_12>m[2] & MHAS_wealth$k56a_12<m[3])])
m4 <- median(MHAS_wealth$k56a_12[which(MHAS_wealth$k56a_12>m[3])])

MHAS_wealth$s_salary2 <- car::recode(MHAS_wealth$k56a_12, "12*9999999=NA; 12*8888888=NA")
MHAS_wealth$s_salary2[is.na(MHAS_wealth$s_salary2)] <- apply(X = select(MHAS_wealth, k56b1_12, k56b2_12, k56b3_12)[is.na(MHAS_wealth$s_salary2),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$s_salary2 <- car::recode(MHAS_wealth$s_salary2, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

MHAS_wealth$k57a_12 <- MHAS_wealth$k57a_12*12
m1 <- median(MHAS_wealth$k57a_12[which(MHAS_wealth$k57a_12<m[1])])
m2 <- median(MHAS_wealth$k57a_12[which(MHAS_wealth$k57a_12>m[1] & MHAS_wealth$k57a_12<m[2])])
m3 <- median(MHAS_wealth$k57a_12[which(MHAS_wealth$k57a_12>m[2] & MHAS_wealth$k57a_12<m[3])])
m4 <- median(MHAS_wealth$k57a_12[which(MHAS_wealth$k57a_12>m[3])])

MHAS_wealth$s_bonus2 <- car::recode(MHAS_wealth$k57a_12, "12*9999999=NA; 12*8888888=NA")
MHAS_wealth$s_bonus2[is.na(MHAS_wealth$s_bonus2)] <- apply(X = select(MHAS_wealth, k57b1_12, k57b2_12, k57b3_12)[is.na(MHAS_wealth$s_bonus2),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$s_bonus2 <- car::recode(MHAS_wealth$s_bonus2, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

MHAS_wealth$k61_1_12 <- MHAS_wealth$k61_1_12*12
m <- c(750, 1500, 6000)*12
m1 <- median(MHAS_wealth$k61_1_12[which(MHAS_wealth$k61_1_12<m[1])])
m2 <- median(MHAS_wealth$k61_1_12[which(MHAS_wealth$k61_1_12>m[1] & MHAS_wealth$k61_1_12<m[2])])
m3 <- median(MHAS_wealth$k61_1_12[which(MHAS_wealth$k61_1_12>m[2] & MHAS_wealth$k61_1_12<m[3])])
m4 <- median(MHAS_wealth$k61_1_12[which(MHAS_wealth$k61_1_12>m[3])])

MHAS_wealth$pension <- car::recode(MHAS_wealth$k61_1_12, "12*9999999=NA; 12*8888888=NA")
MHAS_wealth$pension[is.na(MHAS_wealth$pension)] <- apply(X = select(MHAS_wealth, k62a1_12, k62b1_12, k62c1_12)[is.na(MHAS_wealth$pension),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$pension <- car::recode(MHAS_wealth$pension, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

MHAS_wealth$k61_2_12 <- MHAS_wealth$k61_2_12*12
m1 <- median(MHAS_wealth$k61_2_12[which(MHAS_wealth$k61_2_12<m[1])])
m2 <- median(MHAS_wealth$k61_2_12[which(MHAS_wealth$k61_2_12>m[1] & MHAS_wealth$k61_2_12<m[2])])
m3 <- median(MHAS_wealth$k61_2_12[which(MHAS_wealth$k61_2_12>m[2] & MHAS_wealth$k61_2_12<m[3])])
m4 <- median(MHAS_wealth$k61_2_12[which(MHAS_wealth$k61_2_12>m[3])])

MHAS_wealth$pension2 <- car::recode(MHAS_wealth$k61_2_12, "12*9999999=NA; 12*8888888=NA")
MHAS_wealth$pension2[is.na(MHAS_wealth$pension2)] <- apply(X = select(MHAS_wealth, k62a2_12, k62b2_12, k62c2_12)[is.na(MHAS_wealth$pension2),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$pension2 <- car::recode(MHAS_wealth$pension2, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

MHAS_wealth$k61_3_12 <- MHAS_wealth$k61_3_12*12
m1 <- median(MHAS_wealth$k61_3_12[which(MHAS_wealth$k61_3_12<m[1])])
m2 <- median(MHAS_wealth$k61_3_12[which(MHAS_wealth$k61_3_12>m[1] & MHAS_wealth$k61_3_12<m[2])])
m3 <- median(MHAS_wealth$k61_3_12[which(MHAS_wealth$k61_3_12>m[2] & MHAS_wealth$k61_3_12<m[3])])
m4 <- median(MHAS_wealth$k61_3_12[which(MHAS_wealth$k61_3_12>m[3])])

MHAS_wealth$pension3 <- car::recode(MHAS_wealth$k61_3_12, "12*9999999=NA; 12*8888888=NA")
MHAS_wealth$pension3[is.na(MHAS_wealth$pension3)] <- apply(X = select(MHAS_wealth, k62a3_12, k62b3_12, k62c3_12)[is.na(MHAS_wealth$pension3),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$pension3 <- car::recode(MHAS_wealth$pension3, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

MHAS_wealth$k61_4_12 <- MHAS_wealth$k61_4_12*12
m1 <- median(MHAS_wealth$k61_4_12[which(MHAS_wealth$k61_4_12<m[1])])
m2 <- median(MHAS_wealth$k61_4_12[which(MHAS_wealth$k61_4_12>m[1] & MHAS_wealth$k61_4_12<m[2])])
m3 <- median(MHAS_wealth$k61_4_12[which(MHAS_wealth$k61_4_12>m[2] & MHAS_wealth$k61_4_12<m[3])])
m4 <- median(MHAS_wealth$k61_4_12[which(MHAS_wealth$k61_4_12>m[3])])

MHAS_wealth$pension4 <- car::recode(MHAS_wealth$k61_4_12, "12*9999999=NA; 12*8888888=NA")
MHAS_wealth$pension4[is.na(MHAS_wealth$pension4)] <- apply(X = select(MHAS_wealth, k62a4_12, k62b4_12, k62c4_12)[is.na(MHAS_wealth$pension4),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$pension4 <- car::recode(MHAS_wealth$pension4, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

MHAS_wealth$k67_1_12 <- MHAS_wealth$k67_1_12*12
m1 <- median(MHAS_wealth$k67_1_12[which(MHAS_wealth$k67_1_12<m[1])])
m2 <- median(MHAS_wealth$k67_1_12[which(MHAS_wealth$k67_1_12>m[1] & MHAS_wealth$k67_1_12<m[2])])
m3 <- median(MHAS_wealth$k67_1_12[which(MHAS_wealth$k67_1_12>m[2] & MHAS_wealth$k67_1_12<m[3])])
m4 <- median(MHAS_wealth$k67_1_12[which(MHAS_wealth$k67_1_12>m[3])])

MHAS_wealth$s_pension <- car::recode(MHAS_wealth$k67_1_12, "12*9999999=NA; 12*8888888=NA")
MHAS_wealth$s_pension[is.na(MHAS_wealth$s_pension)] <- apply(X = select(MHAS_wealth, k68a1_12, k68b1_12, k68c1_12)[is.na(MHAS_wealth$s_pension),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$s_pension <- car::recode(MHAS_wealth$s_pension, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

MHAS_wealth$k67_2_12 <- MHAS_wealth$k67_2_12*12
m1 <- median(MHAS_wealth$k67_2_12[which(MHAS_wealth$k67_2_12<m[1])])
m2 <- median(MHAS_wealth$k67_2_12[which(MHAS_wealth$k67_2_12>m[1] & MHAS_wealth$k67_2_12<m[2])])
m3 <- median(MHAS_wealth$k67_2_12[which(MHAS_wealth$k67_2_12>m[2] & MHAS_wealth$k67_2_12<m[3])])
m4 <- median(MHAS_wealth$k67_2_12[which(MHAS_wealth$k67_2_12>m[3])])

MHAS_wealth$s_pension2 <- car::recode(MHAS_wealth$k67_2_12, "12*9999999=NA; 12*8888888=NA")
MHAS_wealth$s_pension2[is.na(MHAS_wealth$s_pension2)] <- apply(X = select(MHAS_wealth, k68a2_12, k68b2_12, k68c2_12)[is.na(MHAS_wealth$s_pension2),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$s_pension2 <- car::recode(MHAS_wealth$s_pension2, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

MHAS_wealth$k67_3_12 <- MHAS_wealth$k67_3_12*12
m1 <- median(MHAS_wealth$k67_3_12[which(MHAS_wealth$k67_3_12<m[1])])
m2 <- median(MHAS_wealth$k67_3_12[which(MHAS_wealth$k67_3_12>m[1] & MHAS_wealth$k67_3_12<m[2])])
m3 <- median(MHAS_wealth$k67_3_12[which(MHAS_wealth$k67_3_12>m[2] & MHAS_wealth$k67_3_12<m[3])])
m4 <- median(MHAS_wealth$k67_3_12[which(MHAS_wealth$k67_3_12>m[3])])

MHAS_wealth$s_pension3 <- car::recode(MHAS_wealth$k67_3_12, "12*9999999=NA; 12*8888888=NA")
MHAS_wealth$s_pension3[is.na(MHAS_wealth$s_pension3)] <- apply(X = select(MHAS_wealth, k68a3_12, k68b3_12, k68c3_12)[is.na(MHAS_wealth$s_pension3),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$s_pension3 <- car::recode(MHAS_wealth$s_pension3, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

MHAS_wealth$k67_4_12 <- MHAS_wealth$k67_4_12*12
m1 <- median(MHAS_wealth$k67_4_12[which(MHAS_wealth$k67_4_12<m[1])])
m2 <- median(MHAS_wealth$k67_4_12[which(MHAS_wealth$k67_4_12>m[1] & MHAS_wealth$k67_4_12<m[2])])
m3 <- median(MHAS_wealth$k67_4_12[which(MHAS_wealth$k67_4_12>m[2] & MHAS_wealth$k67_4_12<m[3])])
m4 <- median(MHAS_wealth$k67_4_12[which(MHAS_wealth$k67_4_12>m[3])])

MHAS_wealth$s_pension4 <- car::recode(MHAS_wealth$k67_4_12, "12*9999999=NA; 12*8888888=NA")
MHAS_wealth$s_pension4[is.na(MHAS_wealth$s_pension4)] <- apply(X = select(MHAS_wealth, k68a4_12, k68b4_12, k68c4_12)[is.na(MHAS_wealth$s_pension4),], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], sep=""))
MHAS_wealth$s_pension4 <- car::recode(MHAS_wealth$s_pension4, "'1NA1'=m4; '1NA2'=m3; '1NA9'=m[3]; '21NA'=m2; '22NA'=m1; '29NA'=m[1]; '9NANA'=NA; 'NANANA'=NA")

MHAS_wealth$k80_1_12 <- car::recode(MHAS_wealth$k80_1_12*12, "12*9999999=NA; 12*8888888=NA")
MHAS_wealth$k80_2_12 <- car::recode(MHAS_wealth$k80_2_12*12, "12*9999999=NA; 12*8888888=NA")
MHAS_wealth$k80_3_12 <- car::recode(MHAS_wealth$k80_3_12*12, "12*9999999=NA; 12*8888888=NA")
MHAS_wealth$k83_1_12 <- car::recode(MHAS_wealth$k83_1_12*12, "12*9999999=NA; 12*8888888=NA")
MHAS_wealth$k83_2_12 <- car::recode(MHAS_wealth$k83_2_12*12, "12*9999999=NA; 12*8888888=NA")
MHAS_wealth$k83_3_12 <- car::recode(MHAS_wealth$k83_3_12*12, "12*9999999=NA; 12*8888888=NA")
```


```{r local3, echo=F}
vari <- MHAS_wealth$bisnes1
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- MHAS_wealth$bisnes2
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- MHAS_wealth$i_bisnes1
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- MHAS_wealth$i_bisnes2
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- MHAS_wealth$estate1
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- MHAS_wealth$estate2
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- MHAS_wealth$i_estate1
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- MHAS_wealth$i_estate2
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- MHAS_wealth$accounts
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- MHAS_wealth$i_accounts
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- MHAS_wealth$loans
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- MHAS_wealth$i_loans
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- MHAS_wealth$stocks
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- MHAS_wealth$i_stocks
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- MHAS_wealth$vehicles
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- MHAS_wealth$i_assets
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- MHAS_wealth$others_assets
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- MHAS_wealth$salary
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- MHAS_wealth$bonus
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- MHAS_wealth$salary2
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- MHAS_wealth$bonus2
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- MHAS_wealth$s_salary
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- MHAS_wealth$s_bonus
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- MHAS_wealth$s_salary2
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- MHAS_wealth$s_bonus2
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- MHAS_wealth$pension
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- MHAS_wealth$pension2
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- MHAS_wealth$pension3
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- MHAS_wealth$pension4
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- MHAS_wealth$s_pension
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- MHAS_wealth$s_pension2
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- MHAS_wealth$s_pension3
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- MHAS_wealth$s_pension4
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- MHAS_wealth$k80_1_12
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- MHAS_wealth$k80_2_12
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- MHAS_wealth$k80_3_12
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- MHAS_wealth$k83_1_12
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- MHAS_wealth$k83_2_12
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")

vari <- MHAS_wealth$k83_3_12
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
```

#### Harmonisation algorithm
To compute the harmonized variable from the study specific varibale sum up all the variables and divide the population into 5 groups each containing 20$\%$ of the corresponding N and the missing values have to be recoded as follows: 

* `NA into 999`

**R script:**

```{r harmo3}
MHAS_wealth$sum <- apply(X = select(MHAS_wealth, bisnes1, bisnes2, i_bisnes1, i_bisnes2, estate1, estate2, i_estate1, i_estate2, accounts, i_accounts, loans, i_loans, stocks, i_stocks, vehicles, i_assets, others_assets, salary, bonus, salary2, bonus2, s_salary, s_bonus, s_salary2, s_bonus2, pension, pension2, pension3, pension4, s_pension, s_pension2, s_pension3, s_pension4, k80_1_12, k80_2_12, k80_3_12, k83_1_12, k83_2_12, k83_3_12), MARGIN = 1, FUN = function(x) sum(as.numeric(x), na.rm = TRUE))
MHAS_wealth$sum <- car::recode(MHAS_wealth$sum, "0=NA")

qq <- quantile(MHAS_wealth$sum, probs = seq(0, 1, .2), na.rm = TRUE)

MHAS_ds_w3 <- tibble(id=MHAS_wealth$id)
MHAS_ds_w3$wealth <- car::recode(MHAS_wealth$sum, "0:qq[2]=1; (qq[2]+1):qq[3]=2; (qq[3]+1):qq[4]=3; (qq[4]+1):qq[5]=4; (qq[5]+1):hi=5")
MHAS_ds_w3$wealth <- car::recode(MHAS_ds_w3$wealth, "NA=999")
MHAS_ds_w3$wealth <- as.integer(MHAS_ds_w3$wealth)
MHAS_ds_w3$wealth <- labelled(MHAS_ds_w3$wealth, labels = c("Missing"=999, "Do not know"=998, "Refuse"=997, "Not applicable"=996, "Does not answer"=995,  "Not attempt not done"=994, "Disable to measure"=993, "Impute"=992, "CAPI interviewer error"=991))
```

#### Statistics of the new harmonised variable
```{r descript3, echo=F}
vari <- MHAS_ds_w3$wealth
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[3], caption = ds_label) 
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[2], caption = "Type of missing")
ggplot(MHAS_ds_w3, aes(x=factor(wealth))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab(ds_label) + ylab("Frequency")
```

#### Validation
```{r crosstabulation3, echo=F}
```





```{r importOPAL3, echo=F}
#opal.assign.data(o, 'MHAS_ds_w3', MHAS_ds_w3)
#opal.symbol_import(o,'MHAS_ds_w3', project='_Athlos_Harm_Dataset')
wealth <- MHAS_ds_w3
save(wealth, file = "../RData/w3/wealth.RData")
rm(wealth)

MHAS_m_ds_w3 <- MHAS_ds_w3
MHAS_m_ds_w3$wealth <- car::recode(MHAS_m_ds_w3$wealth, "c(991, 992, 993, 994, 995, 996, 997,998, 999)=NA")
#opal.assign.data(o, 'MHAS_m_ds_w3', MHAS_m_ds_w3)
#opal.symbol_import(o,'MHAS_m_ds_w3', project='_Athlos_Harm_Dataset')
```


# Quality estimation

After taxes, last year's income was collected.
Questions for the cases of interviews without spouse (single interview) were adapted in the study, and only 
ask about the respondent's information. 
In terms of sources of income, they ask about businesses, leased properties, work, pension, and transfers 
from institutions or relatives.

```{r closeRsession, echo=FALSE}
opal.logout(o)
```
