---
title: "Has friend(s)/confidant"
output:
  html_document:
    highlight: tango
    number_sections: yes
    theme: united
    toc: yes
    toc_depth: 6
    toc_float:
      collapsed: yes
      smooth_scroll: yes
---

<!-- ########################################################## --> 

<!-- # Installation, loading packages -->
<!-- **R script:** -->

```{r setup, include=FALSE}
source("M:/WPs/WP1/Maelstrom/data_process/athlos-project.github.io/setup_ania.r")
```

<!-- ########################################################## --> 



# Description of DataSchema variable

The description of harmonised variable is the following:

* Short name: `confidant`
* Variable label: `Has friend(s)/confidant`
* Domain: `Social environment`
* Value type: `categorical`
* Category coding:

**Code** | **Category Label**
-------- | ------------------
0        | No
1        | Yes

* Category missings: 

**Code** | **Category Label**
----| ------------------
991 | CAPI/interviewer error
992 | Impute
993 | Disable to measure
994 | Not attempt/not done
995 | Does not answer
996 | Not applicable
997 | Refuse
998 | Do not know
999 | Missing



<!-- ########################################################## --> 

# Data process

## aksst

## Wave 1 

#### Study-specific variables description

The study-specific variable elected to be harmonised is:

* Name: `	tome177`
* Label: `Q22:FRIENDS -1-TOTAL NUMBER OF MALE FRIENDS- CHILDHOOD confidant`

* Name: `	tome178`
* Label: `Q22:FRIENDS -2-TOTAL NUMBER OF MALE FRIENDS- BUSINESS`

* Name: `	tome179`
* Label: `Q22:FRIENDS -3-TOTAL NUMBER OF MALE FRIENDS- HOBBY`

* Name: `	tome180`
* Label: `Q22:FRIENDS -4-TOTAL NUMBER OF MALE FRIENDS- VIA PARTNER OR CHILD`

* Name: `	tome181`
* Label: `Q22:FRIENDS -5-TOTAL NUMBER OF MALE FRIENDS- VIA FRIEND AFTER GRADUATING`

* Name: `	tome182`
* Label: `Q22:FRIENDS -6-TOTAL NUMBER OF MALE FRIENDS- NEIGHBORHOODS`

* Name: `	tome183`
* Label: `Q22:FRIENDS -7-TOTAL NUMBER OF MALE FRIENDS- OTHER CHANCE`

* Name: `	tome206`
* Label: `Q22:FRIENDS -1-TOTAL NUMBER OF FEMALE FRIENDS- CHILDHOOD confidant`

* Name: `	tome207`
* Label: `Q22:FRIENDS -2-TOTAL NUMBER OF FEMALE FRIENDS- BUSINESS`

* Name: `	tome208`
* Label: `Q22:FRIENDS -3-TOTAL NUMBER OF FEMALE FRIENDS- HOBBY`

* Name: `	tome209`
* Label: `Q22:FRIENDS -4-TOTAL NUMBER OF FEMALE FRIENDS- VIA PARTNER OR CHILD`

* Name: `	tome210`
* Label: `Q22:FRIENDS -5-TOTAL NUMBER OF FEMALE FRIENDS- VIA FRIEND AFTER GRADUATING`

* Name: `	tome211`
* Label: `Q22:FRIENDS -6-TOTAL NUMBER OF FEMALE FRIENDS- NEIGHBORHOODS`

* Name: `	tome212`
* Label: `Q22:FRIENDS -7-TOTAL NUMBER OF FEMALE FRIENDS- OTHER CHANCE`



* Description: 
```{r assign1-5}
opal.assign.table.tibble(o, 'JSTAR_aksst_w1_confidant','JSTAR_datasets_restricted.jstar_2007_5cities', 
                        variables=list('tome177','tome178','tome179','tome180','tome181','tome182',
                                       'tome183','tome206','tome207','tome208','tome209','tome210',
                                       'tome211','tome212'), missings = TRUE)
```

```{r local1-5}
JSTAR_aksst_w1_confidant <- opal.execute(o,'JSTAR_aksst_w1_confidant')

vari <- JSTAR_aksst_w1_confidant$tome177
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_aksst_w1_confidant$tome177, missing_values = NA)
ggplot(JSTAR_aksst_w1_confidant, aes(x=factor(tome177))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF MALE FRIENDS- CHILDHOOD confidant") + ylab("Frequency")

vari <- JSTAR_aksst_w1_confidant$tome178
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_aksst_w1_confidant$tome178, missing_values = NA)
ggplot(JSTAR_aksst_w1_confidant, aes(x=factor(tome178))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF MALE FRIENDS- BUSINESS") + ylab("Frequency")

vari <- JSTAR_aksst_w1_confidant$tome179
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_aksst_w1_confidant$tome179, missing_values = NA)
ggplot(JSTAR_aksst_w1_confidant, aes(x=factor(tome179))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF MALE FRIENDS- HOBBY") + ylab("Frequency")

vari <- JSTAR_aksst_w1_confidant$tome180
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_aksst_w1_confidant$tome180, missing_values = NA)
ggplot(JSTAR_aksst_w1_confidant, aes(x=factor(tome180))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF MALE FRIENDS- VIA PARTNER OR CHILD") + ylab("Frequency")

vari <- JSTAR_aksst_w1_confidant$tome181
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_aksst_w1_confidant$tome181, missing_values = NA)
ggplot(JSTAR_aksst_w1_confidant, aes(x=factor(tome181))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF MALE FRIENDS- VIA FRIEND AFTER GRADUATING") + ylab("Frequency")

vari <- JSTAR_aksst_w1_confidant$tome182
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_aksst_w1_confidant$tome182, missing_values = NA)
ggplot(JSTAR_aksst_w1_confidant, aes(x=factor(tome182))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF MALE FRIENDS- NEIGHBORHOODS") + ylab("Frequency")

vari <- JSTAR_aksst_w1_confidant$tome183
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_aksst_w1_confidant$tome183, missing_values = NA)
ggplot(JSTAR_aksst_w1_confidant, aes(x=factor(tome183))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF MALE FRIENDS- OTHER CHANCE") + ylab("Frequency")

vari <- JSTAR_aksst_w1_confidant$tome206
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_aksst_w1_confidant$tome206, missing_values = NA)
ggplot(JSTAR_aksst_w1_confidant, aes(x=factor(tome206))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF FEMALE FRIENDS- CHILDHOOD confidant") + ylab("Frequency")

vari <- JSTAR_aksst_w1_confidant$tome207
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_aksst_w1_confidant$tome207, missing_values = NA)
ggplot(JSTAR_aksst_w1_confidant, aes(x=factor(tome207))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF FEMALE FRIENDS- BUSINESS") + ylab("Frequency")

vari <- JSTAR_aksst_w1_confidant$tome208
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_aksst_w1_confidant$tome208, missing_values = NA)
ggplot(JSTAR_aksst_w1_confidant, aes(x=factor(tome208))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF FEMALE FRIENDS- HOBBY") + ylab("Frequency")

vari <- JSTAR_aksst_w1_confidant$tome209
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_aksst_w1_confidant$tome209, missing_values = NA)
ggplot(JSTAR_aksst_w1_confidant, aes(x=factor(tome209))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF FEMALE FRIENDS- VIA PARTNER OR CHILD") + ylab("Frequency")

vari <- JSTAR_aksst_w1_confidant$tome210
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_aksst_w1_confidant$tome210, missing_values = NA)
ggplot(JSTAR_aksst_w1_confidant, aes(x=factor(tome210))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF FEMALE FRIENDS- VIA FRIEND AFTER GRADUATING") + ylab("Frequency")

vari <- JSTAR_aksst_w1_confidant$tome211
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_aksst_w1_confidant$tome211, missing_values = NA)
ggplot(JSTAR_aksst_w1_confidant, aes(x=factor(tome211))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF FEMALE FRIENDS- NEIGHBORHOODS") + ylab("Frequency")

vari <- JSTAR_aksst_w1_confidant$tome212
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_aksst_w1_confidant$tome212, missing_values = NA)
ggplot(JSTAR_aksst_w1_confidant, aes(x=factor(tome212))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF FEMALE FRIENDS- OTHER CHANCE") + ylab("Frequency")

```

#### Harmonisation algorithm
To compute the harmonize variable from the study-specific variable it has to be recoded as follows:

* `0 in tome177-183 AND tome206-212 into 0`
* `Any other then 0 at any tome177-183 OR tome206-212 into 1`
* `NA into 999`

 

**R script:** 
```{r harmo1-5, echo=TRUE}
JSTAR_aksst_ds_w1 <- tibble(id=JSTAR_aksst_w1_confidant$id)

JSTAR_aksst_w1_confidant$tome177 <- car::recode(as.vector(JSTAR_aksst_w1_confidant$tome177), "NA='-999'")
JSTAR_aksst_w1_confidant$tome178 <- car::recode(as.vector(JSTAR_aksst_w1_confidant$tome178), "NA='-999'")
JSTAR_aksst_w1_confidant$tome179 <- car::recode(as.vector(JSTAR_aksst_w1_confidant$tome179), "NA='-999'")
JSTAR_aksst_w1_confidant$tome180 <- car::recode(as.vector(JSTAR_aksst_w1_confidant$tome180), "NA='-999'")
JSTAR_aksst_w1_confidant$tome181 <- car::recode(as.vector(JSTAR_aksst_w1_confidant$tome181), "NA='-999'")
JSTAR_aksst_w1_confidant$tome182 <- car::recode(as.vector(JSTAR_aksst_w1_confidant$tome182), "NA='-999'")
JSTAR_aksst_w1_confidant$tome183 <- car::recode(as.vector(JSTAR_aksst_w1_confidant$tome183), "NA='-999'")
JSTAR_aksst_w1_confidant$tome206 <- car::recode(as.vector(JSTAR_aksst_w1_confidant$tome206), "NA='-999'")
JSTAR_aksst_w1_confidant$tome207 <- car::recode(as.vector(JSTAR_aksst_w1_confidant$tome207), "NA='-999'")
JSTAR_aksst_w1_confidant$tome208 <- car::recode(as.vector(JSTAR_aksst_w1_confidant$tome208), "NA='-999'")
JSTAR_aksst_w1_confidant$tome209 <- car::recode(as.vector(JSTAR_aksst_w1_confidant$tome209), "NA='-999'")
JSTAR_aksst_w1_confidant$tome210 <- car::recode(as.vector(JSTAR_aksst_w1_confidant$tome210), "NA='-999'")
JSTAR_aksst_w1_confidant$tome211 <- car::recode(as.vector(JSTAR_aksst_w1_confidant$tome211), "NA='-999'")
JSTAR_aksst_w1_confidant$tome212 <- car::recode(as.vector(JSTAR_aksst_w1_confidant$tome212), "NA='-999'")


JSTAR_aksst_ds_w1$confidant <- c(NA) # I think it is required here
for(i in 1:dim(JSTAR_aksst_w1_confidant)[1]){
if(JSTAR_aksst_w1_confidant$tome177[i] == 0 & JSTAR_aksst_w1_confidant$tome178[i] == 0 & 
   JSTAR_aksst_w1_confidant$tome179[i] == 0 & JSTAR_aksst_w1_confidant$tome180[i] == 0 & 
   JSTAR_aksst_w1_confidant$tome181[i] == 0 & JSTAR_aksst_w1_confidant$tome182[i] == 0 &
   JSTAR_aksst_w1_confidant$tome183[i] == 0 & JSTAR_aksst_w1_confidant$tome206[i] == 0 & 
   JSTAR_aksst_w1_confidant$tome207[i] == 0 & JSTAR_aksst_w1_confidant$tome208[i] == 0 & 
   JSTAR_aksst_w1_confidant$tome209[i] == 0 & JSTAR_aksst_w1_confidant$tome210[i] == 0 & 
   JSTAR_aksst_w1_confidant$tome211[i] == 0 & JSTAR_aksst_w1_confidant$tome212[i] == 0){
   JSTAR_aksst_ds_w1$confidant[i] = 0
   } else if(JSTAR_aksst_w1_confidant$tome177[i] > 0 | JSTAR_aksst_w1_confidant$tome178[i] > 0 | 
        JSTAR_aksst_w1_confidant$tome179[i] > 0 | JSTAR_aksst_w1_confidant$tome180[i] > 0 | 
        JSTAR_aksst_w1_confidant$tome181[i] > 0 | JSTAR_aksst_w1_confidant$tome182[i] > 0 |
        JSTAR_aksst_w1_confidant$tome183[i] > 0 | JSTAR_aksst_w1_confidant$tome206[i] > 0 | 
        JSTAR_aksst_w1_confidant$tome207[i] > 0 | JSTAR_aksst_w1_confidant$tome208[i] > 0 | 
        JSTAR_aksst_w1_confidant$tome209[i] > 0 | JSTAR_aksst_w1_confidant$tome210[i] > 0 | 
        JSTAR_aksst_w1_confidant$tome211[i] > 0 | JSTAR_aksst_w1_confidant$tome212[i] > 0){
        JSTAR_aksst_ds_w1$confidant[i] = 1
        }

}
JSTAR_aksst_ds_w1$confidant <- car::recode(as.vector(JSTAR_aksst_ds_w1$confidant), "NA='999'")
JSTAR_aksst_ds_w1$confidant <- labelled(JSTAR_aksst_ds_w1$confidant, labels = c("No"=0, "Yes"=1, "Missing"=999, "Do not know"=998, "Refuse"=997, "Not applicable"=996, "Don't answer"=995,  "Not attempt/not done/not yet recorded"=994, "Disable to measure"=993, "Impute"=992, "CAPI/interviewer error"=991))
```

#### Statistical description of the new harmonised variable
```{r descript1-5}
vari <- JSTAR_aksst_ds_w1$confidant 
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[3])
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[2], caption = "Type of missing")
#Categorical_summary(var = JSTAR_aksst_ds_w1$confidant, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))
ggplot(JSTAR_aksst_ds_w1, aes(x=factor(confidant))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Has friend(s)/confidant(s)?") + ylab("Frequency")
```

#### Validation
```{r crosstabulation1-5}

```


### Wave 2
Not found.

### Wave 3
Not found.


## cth
### Wave 1 

#### Study-specific variables description

The study-specific variable elected to be harmonised is:

* Name: `	q22_2_1`
* Label: `Q22:FRIENDS -1-TOTAL NUMBER OF MALE FRIENDS- CHILDHOOD confidant`

* Name: `	q22_2_2`
* Label: `Q22:FRIENDS -2-TOTAL NUMBER OF MALE FRIENDS- WORK`

* Name: `	q22_2_3`
* Label: `Q22:FRIENDS -3-TOTAL NUMBER OF MALE FRIENDS- HOBBY`

* Name: `	q22_2_4`
* Label: `Q22:FRIENDS -4-TOTAL NUMBER OF MALE FRIENDS- THROUGH SPOUSE OR CHILDREN`

* Name: `	q22_2_5`
* Label: `Q22:FRIENDS -5-TOTAL NUMBER OF MALE FRIENDS- THROUGH FRIEND AFTER GRADUATING`

* Name: `	q22_2_6`
* Label: `Q22:FRIENDS -6-TOTAL NUMBER OF MALE FRIENDS- NEIGHBORHOODS`

* Name: `	q22_2_7`
* Label: `Q22:FRIENDS -7-TOTAL NUMBER OF MALE FRIENDS- OTHER CHANCE`

* Name: `	q22_6_1`
* Label: `Q22:FRIENDS -1-TOTAL NUMBER OF FEMALE FRIENDS- CHILDHOOD confidant`

* Name: `	q22_6_2`
* Label: `Q22:FRIENDS -2-TOTAL NUMBER OF FEMALE FRIENDS- WORK`

* Name: `	q22_6_3`
* Label: `Q22:FRIENDS -3-TOTAL NUMBER OF FEMALE FRIENDS- HOBBY`

* Name: `	q22_6_4`
* Label: `Q22:FRIENDS -4-TOTAL NUMBER OF FEMALE FRIENDS- THROUGH SPOUSE OR CHILDREN`

* Name: `	q22_6_5`
* Label: `Q22:FRIENDS -5-TOTAL NUMBER OF FEMALE FRIENDS- THROUGH FRIEND AFTER GRADUATING`

* Name: `	q22_6_6`
* Label: `Q22:FRIENDS -6-TOTAL NUMBER OF FEMALE FRIENDS- NEIGHBORHOODS`

* Name: `	q22_6_7`
* Label: `Q22:FRIENDS -7-TOTAL NUMBER OF FEMALE FRIENDS- OTHER CHANCE`



* Description: 
```{r assign1-3}
opal.assign.table.tibble(o, 'JSTAR_cth_w1_confidant','JSTAR_datasets_restricted.jstar_2011_3cities', 
                        variables=list('q22_2_1','q22_2_2','q22_2_3','q22_2_4','q22_2_5','q22_2_6',
                                       'q22_2_7','q22_6_1','q22_6_2','q22_6_3','q22_6_4','q22_6_5',
                                       'q22_6_6','q22_6_7'), missings = TRUE)
```

```{r local1-3}
JSTAR_cth_w1_confidant <- opal.execute(o,'JSTAR_cth_w1_confidant')

vari <- JSTAR_cth_w1_confidant$q22_2_1
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_cth_w1_confidant$q22_2_1, missing_values = NA)
ggplot(JSTAR_cth_w1_confidant, aes(x=factor(q22_2_1))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF MALE FRIENDS- CHILDHOOD confidant") + ylab("Frequency")

vari <- JSTAR_cth_w1_confidant$q22_2_2
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_cth_w1_confidant$q22_2_2, missing_values = NA)
ggplot(JSTAR_cth_w1_confidant, aes(x=factor(q22_2_2))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF MALE FRIENDS- WORK") + ylab("Frequency")

vari <- JSTAR_cth_w1_confidant$q22_2_3
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_cth_w1_confidant$q22_2_3, missing_values = NA)
ggplot(JSTAR_cth_w1_confidant, aes(x=factor(q22_2_3))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF MALE FRIENDS- HOBBY") + ylab("Frequency")

vari <- JSTAR_cth_w1_confidant$q22_2_4
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_cth_w1_confidant$q22_2_4, missing_values = NA)
ggplot(JSTAR_cth_w1_confidant, aes(x=factor(q22_2_4))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF MALE FRIENDS- THROUGH SPOUSE OR CHILDREN") + ylab("Frequency")

vari <- JSTAR_cth_w1_confidant$q22_2_5
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_cth_w1_confidant$q22_2_5, missing_values = NA)
ggplot(JSTAR_cth_w1_confidant, aes(x=factor(q22_2_5))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF MALE FRIENDS- THROUGH FRIEND AFTER GRADUATING") + ylab("Frequency")

vari <- JSTAR_cth_w1_confidant$q22_2_6
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_cth_w1_confidant$q22_2_6, missing_values = NA)
ggplot(JSTAR_cth_w1_confidant, aes(x=factor(q22_2_6))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF MALE FRIENDS- NEIGHBORHOODS") + ylab("Frequency")

vari <- JSTAR_cth_w1_confidant$q22_2_7
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_cth_w1_confidant$q22_2_7, missing_values = NA)
ggplot(JSTAR_cth_w1_confidant, aes(x=factor(q22_2_7))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF MALE FRIENDS- OTHER CHANCE") + ylab("Frequency")

vari <- JSTAR_cth_w1_confidant$q22_6_1
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_cth_w1_confidant$q22_6_1, missing_values = NA)
ggplot(JSTAR_cth_w1_confidant, aes(x=factor(q22_6_1))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF FEMALE FRIENDS- CHILDHOOD confidant") + ylab("Frequency")

vari <- JSTAR_cth_w1_confidant$q22_6_2
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_cth_w1_confidant$q22_6_2, missing_values = NA)
ggplot(JSTAR_cth_w1_confidant, aes(x=factor(q22_6_2))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF FEMALE FRIENDS- WORK") + ylab("Frequency")

vari <- JSTAR_cth_w1_confidant$q22_6_3
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_cth_w1_confidant$q22_6_3, missing_values = NA)
ggplot(JSTAR_cth_w1_confidant, aes(x=factor(q22_6_3))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF FEMALE FRIENDS- HOBBY") + ylab("Frequency")

vari <- JSTAR_cth_w1_confidant$q22_6_4
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_cth_w1_confidant$q22_6_4, missing_values = NA)
ggplot(JSTAR_cth_w1_confidant, aes(x=factor(q22_6_4))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF FEMALE FRIENDS- THROUGH SPOUSE OR CHILDREN") + ylab("Frequency")

vari <- JSTAR_cth_w1_confidant$q22_6_5
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_cth_w1_confidant$q22_6_5, missing_values = NA)
ggplot(JSTAR_cth_w1_confidant, aes(x=factor(q22_6_5))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF FEMALE FRIENDS- THROUGH FRIEND AFTER GRADUATING") + ylab("Frequency")

vari <- JSTAR_cth_w1_confidant$q22_6_6
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_cth_w1_confidant$q22_6_6, missing_values = NA)
ggplot(JSTAR_cth_w1_confidant, aes(x=factor(q22_6_6))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF FEMALE FRIENDS- NEIGHBORHOODS") + ylab("Frequency")

vari <- JSTAR_cth_w1_confidant$q22_6_7
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_cth_w1_confidant$q22_6_7, missing_values = NA)
ggplot(JSTAR_cth_w1_confidant, aes(x=factor(q22_6_7))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF FEMALE FRIENDS- OTHER CHANCE") + ylab("Frequency")

```

#### Harmonisation algorithm
To compute the harmonize variable from the study-specific variable it has to be recoded as follows:

* `0 in q22_2_1-7 AND q22_6_1-7 into 0`
* `Any other then 0 at any q22_2_1-7 OR q22_6_1-7 into 1`
* `NA into 999`

 

**R script:** 
```{r harmo1-3, echo=TRUE}
JSTAR_cth_ds_w1 <- tibble(id=JSTAR_cth_w1_confidant$id)

JSTAR_cth_w1_confidant$q22_2_1 <- car::recode(as.vector(JSTAR_cth_w1_confidant$q22_2_1), "NA='-999'")
JSTAR_cth_w1_confidant$q22_2_2 <- car::recode(as.vector(JSTAR_cth_w1_confidant$q22_2_2), "NA='-999'")
JSTAR_cth_w1_confidant$q22_2_3 <- car::recode(as.vector(JSTAR_cth_w1_confidant$q22_2_3), "NA='-999'")
JSTAR_cth_w1_confidant$q22_2_4 <- car::recode(as.vector(JSTAR_cth_w1_confidant$q22_2_4), "NA='-999'")
JSTAR_cth_w1_confidant$q22_2_5 <- car::recode(as.vector(JSTAR_cth_w1_confidant$q22_2_5), "NA='-999'")
JSTAR_cth_w1_confidant$q22_2_6 <- car::recode(as.vector(JSTAR_cth_w1_confidant$q22_2_6), "NA='-999'")
JSTAR_cth_w1_confidant$q22_2_7 <- car::recode(as.vector(JSTAR_cth_w1_confidant$q22_2_7), "NA='-999'")
JSTAR_cth_w1_confidant$q22_6_1 <- car::recode(as.vector(JSTAR_cth_w1_confidant$q22_6_1), "NA='-999'")
JSTAR_cth_w1_confidant$q22_6_2 <- car::recode(as.vector(JSTAR_cth_w1_confidant$q22_6_2), "NA='-999'")
JSTAR_cth_w1_confidant$q22_6_3 <- car::recode(as.vector(JSTAR_cth_w1_confidant$q22_6_3), "NA='-999'")
JSTAR_cth_w1_confidant$q22_6_4 <- car::recode(as.vector(JSTAR_cth_w1_confidant$q22_6_4), "NA='-999'")
JSTAR_cth_w1_confidant$q22_6_5 <- car::recode(as.vector(JSTAR_cth_w1_confidant$q22_6_5), "NA='-999'")
JSTAR_cth_w1_confidant$q22_6_6 <- car::recode(as.vector(JSTAR_cth_w1_confidant$q22_6_6), "NA='-999'")
JSTAR_cth_w1_confidant$q22_6_7 <- car::recode(as.vector(JSTAR_cth_w1_confidant$q22_6_7), "NA='-999'")


JSTAR_cth_ds_w1$confidant <- c(NA) # I think it is required here
for(i in 1:dim(JSTAR_cth_w1_confidant)[1]){
if(JSTAR_cth_w1_confidant$q22_2_1[i] == 0 & JSTAR_cth_w1_confidant$q22_2_2[i] == 0 & 
   JSTAR_cth_w1_confidant$q22_2_3[i] == 0 & JSTAR_cth_w1_confidant$q22_2_4[i] == 0 & 
   JSTAR_cth_w1_confidant$q22_2_5[i] == 0 & JSTAR_cth_w1_confidant$q22_2_6[i] == 0 &
   JSTAR_cth_w1_confidant$q22_2_7[i] == 0 & JSTAR_cth_w1_confidant$q22_6_1[i] == 0 & 
   JSTAR_cth_w1_confidant$q22_6_2[i] == 0 & JSTAR_cth_w1_confidant$q22_6_3[i] == 0 & 
   JSTAR_cth_w1_confidant$q22_6_4[i] == 0 & JSTAR_cth_w1_confidant$q22_6_5[i] == 0 & 
   JSTAR_cth_w1_confidant$q22_6_6[i] == 0 & JSTAR_cth_w1_confidant$q22_6_7[i] == 0){
   JSTAR_cth_ds_w1$confidant[i] = 0
   } else if(JSTAR_cth_w1_confidant$q22_2_1[i] > 0 | JSTAR_cth_w1_confidant$q22_2_2[i] > 0 | 
        JSTAR_cth_w1_confidant$q22_2_3[i] > 0 | JSTAR_cth_w1_confidant$q22_2_4[i] > 0 | 
        JSTAR_cth_w1_confidant$q22_2_5[i] > 0 | JSTAR_cth_w1_confidant$q22_2_6[i] > 0 |
        JSTAR_cth_w1_confidant$q22_2_7[i] > 0 | JSTAR_cth_w1_confidant$q22_6_1[i] > 0 | 
        JSTAR_cth_w1_confidant$q22_6_2[i] > 0 | JSTAR_cth_w1_confidant$q22_6_3[i] > 0 | 
        JSTAR_cth_w1_confidant$q22_6_4[i] > 0 | JSTAR_cth_w1_confidant$q22_6_5[i] > 0 | 
        JSTAR_cth_w1_confidant$q22_6_6[i] > 0 | JSTAR_cth_w1_confidant$q22_6_7[i] > 0){
        JSTAR_cth_ds_w1$confidant[i] = 1
        }
}

JSTAR_cth_ds_w1$confidant <- car::recode(as.vector(JSTAR_cth_ds_w1$confidant), "NA='999'")
JSTAR_cth_ds_w1$confidant <- labelled(JSTAR_cth_ds_w1$confidant, labels = c("No"=0, "Yes"=1, "Missing"=999, "Do not know"=998, "Refuse"=997, "Not applicable"=996, "Don't answer"=995,  "Not attempt/not done/not yet recorded"=994, "Disable to measure"=993, "Impute"=992, "CAPI/interviewer error"=991))
```

#### Statistical description of the new harmonised variable
```{r descript1-3}
vari <- JSTAR_cth_ds_w1$confidant 
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[3])
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[2], caption = "Type of missing")
#Categorical_summary(var = JSTAR_cth_ds_w1$confidant, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))
ggplot(JSTAR_cth_ds_w1, aes(x=factor(confidant))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Has friend(s)/confidant(s)?") + ylab("Frequency")
```

#### Validation
```{r crosstabulation1-3}

```


## tn

### Wave 1 

#### Study-specific variables description

The study-specific variable elected to be harmonised is:

* Name: `	tome177`
* Label: `Q22:FRIENDS -1-TOTAL NUMBER OF MALE FRIENDS- CHILDHOOD confidant`

* Name: `	tome178`
* Label: `Q22:FRIENDS -2-TOTAL NUMBER OF MALE FRIENDS- BUSINESS`

* Name: `	tome179`
* Label: `Q22:FRIENDS -3-TOTAL NUMBER OF MALE FRIENDS- HOBBY`

* Name: `	tome180`
* Label: `Q22:FRIENDS -4-TOTAL NUMBER OF MALE FRIENDS- VIA PARTNER OR CHILD`

* Name: `	tome181`
* Label: `Q22:FRIENDS -5-TOTAL NUMBER OF MALE FRIENDS- VIA FRIEND AFTER GRADUATING`

* Name: `	tome182`
* Label: `Q22:FRIENDS -6-TOTAL NUMBER OF MALE FRIENDS- NEIGHBORHOODS`

* Name: `	tome183`
* Label: `Q22:FRIENDS -7-TOTAL NUMBER OF MALE FRIENDS- OTHER CHANCE`

* Name: `	tome206`
* Label: `Q22:FRIENDS -1-TOTAL NUMBER OF FEMALE FRIENDS- CHILDHOOD confidant`

* Name: `	tome207`
* Label: `Q22:FRIENDS -2-TOTAL NUMBER OF FEMALE FRIENDS- BUSINESS`

* Name: `	tome208`
* Label: `Q22:FRIENDS -3-TOTAL NUMBER OF FEMALE FRIENDS- HOBBY`

* Name: `	tome209`
* Label: `Q22:FRIENDS -4-TOTAL NUMBER OF FEMALE FRIENDS- VIA PARTNER OR CHILD`

* Name: `	tome210`
* Label: `Q22:FRIENDS -5-TOTAL NUMBER OF FEMALE FRIENDS- VIA FRIEND AFTER GRADUATING`

* Name: `	tome211`
* Label: `Q22:FRIENDS -6-TOTAL NUMBER OF FEMALE FRIENDS- NEIGHBORHOODS`

* Name: `	tome212`
* Label: `Q22:FRIENDS -7-TOTAL NUMBER OF FEMALE FRIENDS- OTHER CHANCE`



* Description: 
```{r assign1-2}
opal.assign.table.tibble(o, 'JSTAR_tn_w1_confidant','JSTAR_datasets_restricted.jstar_2009_2cities', 
                        variables=list('tome177','tome178','tome179','tome180','tome181','tome182',
                                       'tome183','tome206','tome207','tome208','tome209','tome210',
                                       'tome211','tome212'), missings = TRUE)
```

```{r local1-2}
JSTAR_tn_w1_confidant <- opal.execute(o,'JSTAR_tn_w1_confidant')
vari <- JSTAR_tn_w1_confidant$tome177
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_tn_w1_confidant$tome177, missing_values = NA)
ggplot(JSTAR_tn_w1_confidant, aes(x=factor(tome177))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF MALE FRIENDS- CHILDHOOD confidant") + ylab("Frequency")

vari <- JSTAR_tn_w1_confidant$tome178
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_tn_w1_confidant$tome178, missing_values = NA)
ggplot(JSTAR_tn_w1_confidant, aes(x=factor(tome178))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF MALE FRIENDS- BUSINESS") + ylab("Frequency")

vari <- JSTAR_tn_w1_confidant$tome179
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_tn_w1_confidant$tome179, missing_values = NA)
ggplot(JSTAR_tn_w1_confidant, aes(x=factor(tome179))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF MALE FRIENDS- HOBBY") + ylab("Frequency")

vari <- JSTAR_tn_w1_confidant$tome180
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_tn_w1_confidant$tome180, missing_values = NA)
ggplot(JSTAR_tn_w1_confidant, aes(x=factor(tome180))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF MALE FRIENDS- VIA PARTNER OR CHILD") + ylab("Frequency")

vari <- JSTAR_tn_w1_confidant$tome181
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_tn_w1_confidant$tome181, missing_values = NA)
ggplot(JSTAR_tn_w1_confidant, aes(x=factor(tome181))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF MALE FRIENDS- VIA FRIEND AFTER GRADUATING") + ylab("Frequency")

vari <- JSTAR_tn_w1_confidant$tome182
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_tn_w1_confidant$tome182, missing_values = NA)
ggplot(JSTAR_tn_w1_confidant, aes(x=factor(tome182))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF MALE FRIENDS- NEIGHBORHOODS") + ylab("Frequency")

vari <- JSTAR_tn_w1_confidant$tome183
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_tn_w1_confidant$tome183, missing_values = NA)
ggplot(JSTAR_tn_w1_confidant, aes(x=factor(tome183))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF MALE FRIENDS- OTHER CHANCE") + ylab("Frequency")

vari <- JSTAR_tn_w1_confidant$tome206
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_tn_w1_confidant$tome206, missing_values = NA)
ggplot(JSTAR_tn_w1_confidant, aes(x=factor(tome206))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF FEMALE FRIENDS- CHILDHOOD confidant") + ylab("Frequency")

vari <- JSTAR_tn_w1_confidant$tome207
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_tn_w1_confidant$tome207, missing_values = NA)
ggplot(JSTAR_tn_w1_confidant, aes(x=factor(tome207))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF FEMALE FRIENDS- BUSINESS") + ylab("Frequency")

vari <- JSTAR_tn_w1_confidant$tome208
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_tn_w1_confidant$tome208, missing_values = NA)
ggplot(JSTAR_tn_w1_confidant, aes(x=factor(tome208))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF FEMALE FRIENDS- HOBBY") + ylab("Frequency")

vari <- JSTAR_tn_w1_confidant$tome209
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_tn_w1_confidant$tome209, missing_values = NA)
ggplot(JSTAR_tn_w1_confidant, aes(x=factor(tome209))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF FEMALE FRIENDS- VIA PARTNER OR CHILD") + ylab("Frequency")

vari <- JSTAR_tn_w1_confidant$tome210
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_tn_w1_confidant$tome210, missing_values = NA)
ggplot(JSTAR_tn_w1_confidant, aes(x=factor(tome210))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF FEMALE FRIENDS- VIA FRIEND AFTER GRADUATING") + ylab("Frequency")

vari <- JSTAR_tn_w1_confidant$tome211
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_tn_w1_confidant$tome211, missing_values = NA)
ggplot(JSTAR_tn_w1_confidant, aes(x=factor(tome211))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF FEMALE FRIENDS- NEIGHBORHOODS") + ylab("Frequency")

vari <- JSTAR_tn_w1_confidant$tome212
kable(Continuous_summary(vari, missing_values = NA)[3], caption = attributes(vari)$`spss::shortName`) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
#Continuous_summary(var = JSTAR_tn_w1_confidant$tome212, missing_values = NA)
ggplot(JSTAR_tn_w1_confidant, aes(x=factor(tome212))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("TOTAL NUMBER OF FEMALE FRIENDS- OTHER CHANCE") + ylab("Frequency")

```

#### Harmonisation algorithm
To compute the harmonize variable from the study-specific variable it has to be recoded as follows:

* `0 in tome177-183 AND tome206-212 into 0`
* `Any other then 0 at any tome177-183 OR tome206-212 into 1`
* `NA into 999`

 

**R script:** 
```{r harmo1-2, echo=TRUE}
JSTAR_tn_ds_w1 <- tibble(id=JSTAR_tn_w1_confidant$id)

JSTAR_tn_w1_confidant$tome177 <- car::recode(as.vector(JSTAR_tn_w1_confidant$tome177), "NA='-999'")
JSTAR_tn_w1_confidant$tome178 <- car::recode(as.vector(JSTAR_tn_w1_confidant$tome178), "NA='-999'")
JSTAR_tn_w1_confidant$tome179 <- car::recode(as.vector(JSTAR_tn_w1_confidant$tome179), "NA='-999'")
JSTAR_tn_w1_confidant$tome180 <- car::recode(as.vector(JSTAR_tn_w1_confidant$tome180), "NA='-999'")
JSTAR_tn_w1_confidant$tome181 <- car::recode(as.vector(JSTAR_tn_w1_confidant$tome181), "NA='-999'")
JSTAR_tn_w1_confidant$tome182 <- car::recode(as.vector(JSTAR_tn_w1_confidant$tome182), "NA='-999'")
JSTAR_tn_w1_confidant$tome183 <- car::recode(as.vector(JSTAR_tn_w1_confidant$tome183), "NA='-999'")
JSTAR_tn_w1_confidant$tome206 <- car::recode(as.vector(JSTAR_tn_w1_confidant$tome206), "NA='-999'")
JSTAR_tn_w1_confidant$tome207 <- car::recode(as.vector(JSTAR_tn_w1_confidant$tome207), "NA='-999'")
JSTAR_tn_w1_confidant$tome208 <- car::recode(as.vector(JSTAR_tn_w1_confidant$tome208), "NA='-999'")
JSTAR_tn_w1_confidant$tome209 <- car::recode(as.vector(JSTAR_tn_w1_confidant$tome209), "NA='-999'")
JSTAR_tn_w1_confidant$tome210 <- car::recode(as.vector(JSTAR_tn_w1_confidant$tome210), "NA='-999'")
JSTAR_tn_w1_confidant$tome211 <- car::recode(as.vector(JSTAR_tn_w1_confidant$tome211), "NA='-999'")
JSTAR_tn_w1_confidant$tome212 <- car::recode(as.vector(JSTAR_tn_w1_confidant$tome212), "NA='-999'")


JSTAR_tn_ds_w1$confidant <- c(NA) # I think it is required here
for(i in 1:dim(JSTAR_tn_w1_confidant)[1]){
if(JSTAR_tn_w1_confidant$tome177[i] == 0 & JSTAR_tn_w1_confidant$tome178[i] == 0 & 
   JSTAR_tn_w1_confidant$tome179[i] == 0 & JSTAR_tn_w1_confidant$tome180[i] == 0 & 
   JSTAR_tn_w1_confidant$tome181[i] == 0 & JSTAR_tn_w1_confidant$tome182[i] == 0 &
   JSTAR_tn_w1_confidant$tome183[i] == 0 & JSTAR_tn_w1_confidant$tome206[i] == 0 & 
   JSTAR_tn_w1_confidant$tome207[i] == 0 & JSTAR_tn_w1_confidant$tome208[i] == 0 & 
   JSTAR_tn_w1_confidant$tome209[i] == 0 & JSTAR_tn_w1_confidant$tome210[i] == 0 & 
   JSTAR_tn_w1_confidant$tome211[i] == 0 & JSTAR_tn_w1_confidant$tome212[i] == 0){
   JSTAR_tn_ds_w1$confidant[i] = 0
   } else if(JSTAR_tn_w1_confidant$tome177[i] > 0 | JSTAR_tn_w1_confidant$tome178[i] > 0 | 
        JSTAR_tn_w1_confidant$tome179[i] > 0 | JSTAR_tn_w1_confidant$tome180[i] > 0 | 
        JSTAR_tn_w1_confidant$tome181[i] > 0 | JSTAR_tn_w1_confidant$tome182[i] > 0 |
        JSTAR_tn_w1_confidant$tome183[i] > 0 | JSTAR_tn_w1_confidant$tome206[i] > 0 | 
        JSTAR_tn_w1_confidant$tome207[i] > 0 | JSTAR_tn_w1_confidant$tome208[i] > 0 | 
        JSTAR_tn_w1_confidant$tome209[i] > 0 | JSTAR_tn_w1_confidant$tome210[i] > 0 | 
        JSTAR_tn_w1_confidant$tome211[i] > 0 | JSTAR_tn_w1_confidant$tome212[i] > 0){
        JSTAR_tn_ds_w1$confidant[i] = 1
        }  
}

JSTAR_tn_ds_w1$confidant <- car::recode(as.vector(JSTAR_tn_ds_w1$confidant), "NA='999'")
JSTAR_tn_ds_w1$confidant <- labelled(JSTAR_tn_ds_w1$confidant, labels = c("No"=0, "Yes"=1, "Missing"=999, "Do not know"=998, "Refuse"=997, "Not applicable"=996, "Don't answer"=995,  "Not attempt/not done/not yet recorded"=994, "Disable to measure"=993, "Impute"=992, "CAPI/interviewer error"=991))
```

#### Statistical description of the new harmonised variable
```{r descript1-2}
vari <- JSTAR_tn_ds_w1$confidant 
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[3])
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[2], caption = "Type of missing")
#Categorical_summary(var = JSTAR_tn_ds_w1$confidant, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))
ggplot(JSTAR_tn_ds_w1, aes(x=factor(confidant))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Has friend(s)/confidant(s)?") + ylab("Frequency")
```

#### Validation
```{r crosstabulation1}

```

### Wave 2
Not found.


```{r save, echo=FALSE}
confidant <- JSTAR_tn_ds_w1
save(confidant, file = "../RData/tn_w1/confidant.RData")
rm(confidant)

confidant <- JSTAR_aksst_ds_w1
save(confidant, file = "../RData/aksst_w1/confidant.RData")
rm(confidant)

confidant <- JSTAR_cth_ds_w1
save(confidant, file = "../RData/cth_w1/confidant.RData")
rm(confidant)

```

# Quality estimation
```{r closeRsession, echo=FALSE} 
opal.logout(o)
```