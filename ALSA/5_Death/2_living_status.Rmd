---
title: "Living Status"
output:
  html_document:
    highlight: tango
    number_sections: yes
    theme: united
    toc: yes
    toc_depth: 6
    toc_float:
      collapsed: yes
      smooth_scroll: yes
---

<!-- ########################################################## --> 
<!-- # Installation, loading packages -->
```{r setup, include=FALSE}
source("../../setup.r")
```
<!-- ########################################################## --> 
<!-- # Loading DS description -->
```{r main, child='../../_DS_Rmd/living_statusDS.Rmd'}
```
```{r global, echo=F}
source('../../_DS_Rmd/living_statusDS.R')
```


# Data process

## ALSA

### Wave 1 

```{r assign1, echo=FALSE}
opal.assign.table.tibble(o, 'ALSA_id_w1','ALSA.ALSA-Wave1',
                         variables=list('SEX'), missings = TRUE)
ALSA_id_w1 <- opal.execute(o,'ALSA_id_w1')
```

#### Harmonisation algorithm
It's considered that at baseline all the individuals are alive. Therefore it is going to compute the variable with all the values as 0. 

**R script:**

```{r harmo1}
ALSA_ds_w1 <- tibble(id=ALSA_id_w1$id)
ALSA_ds_w1$living_status <- 0
ALSA_ds_w1$living_status <- labelled(ALSA_ds_w1$living_status, labels = c("Alive"=0, "Dead"=1, "Dropout"=2, "Missing"=999, "Do not know"=998, "Refuse"=997, "Not applicable"=996, "Does not answer"=995,  "Not attempt not done"=994, "Disable to measure"=993, "Impute"=992, "CAPI interviewer error"=991))
```

#### Statistics of the new harmonised variable
```{r descript1, echo=F}
vari <- ALSA_ds_w1$living_status
kable(Continuous_summary(var = vari, missing_values = miss_values_vector)[3], caption = ds_label)
kable(Continuous_summary(vari, missing_values = miss_values_vector)[2], caption = "Values")
pander(Continuous_summary(vari, missing_values = miss_values_vector)$summary, caption = "Summary")
ggplot(ALSA_ds_w1, aes(x=factor(living_status))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab(ds_label) + ylab("Frequency") 
```

#### Validation
```{r crosstabulation1, echo=F,results='asis', echo=F}
```



### Wave 2

#### Study-specific variable description

The study-specific variable elected to be harmonised is:

| **Name** | `deathdate`| `datew2` |
|-|-|-|
| **Label** | `date of death`| | 
| **Table name** | `Death_dates_laia` | `dates_of_interview_w2` |
| **Description** |  |  |

    
```{r assign2, echo=F}
opal.assign.table.tibble(o, 'ALSA_inter','ALSA.dates_of_interview_w2',
                         variables=list('datew2'), missings = TRUE)
ALSA_inter <- opal.execute(o,'ALSA_inter')
opal.assign.table.tibble(o, 'ALSA_death','ALSA.Death_dates_laia',
                         variables=list('deathdate'), missings = TRUE)
ALSA_death <- opal.execute(o,'ALSA_death')

ALSA_death <- ALSA_death %>% 
  mutate(deathdate = if_else(id == "501", NA_Date_, as.Date(as.numeric(deathdate), origin = "1970-01-01")))

ALSA_ls <- left_join(x = ALSA_death, y = ALSA_inter, by = 'id')
ALSA_ls$datew2 <- ALSA_ls$datew2 + years(1900)
```

```{r local2, echo=F}
vari <- ALSA_ls$datew2
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(ALSA_ls, aes(x=datew2)) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Date of interview") + ylab("Frequency") 

vari <- ALSA_ls$deathdate
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(ALSA_ls, aes(x=deathdate)) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Date of death") + ylab("Frequency") 
```

### Harmonisation algorithm
The harmonized variable is going to be recoded from date of death and interview variables as follow:

* `consider all the individuals as 2`
* `the individuals with data in the wave 2 interview as 0`
* `the individuals with date of death before the last day that the interview take place as 1`

R script:

```{r harmo2}
ALSA_ds_w2 <- tibble(id=ALSA_ls$id)
ALSA_ds_w2$living_status <- 2
ALSA_ds_w2$living_status[!is.na(ALSA_ls$datew2)] <- 0
ALSA_ds_w2$living_status[which(ALSA_ls$deathdate < ALSA_ls$datew2)] <- 1
ALSA_ds_w2$living_status[which(is.na(ALSA_ls$datew2) & ALSA_ls$deathdate<=as.Date("30/04/1994", "%d/%m/%Y"))] <- 1
ALSA_ds_w2$living_status <- labelled(ALSA_ds_w2$living_status, labels = c("Alive"=0, "Dead"=1, "Dropout"=2, "Missing"=999, "Do not know"=998, "Refuse"=997, "Not applicable"=996, "Does not answer"=995,  "Not attempt not done"=994, "Disable to measure"=993, "Impute"=992, "CAPI interviewer error"=991))
```

### Statistics of the new harmonised variable
```{r descript2, echo=F}
vari <- ALSA_ds_w2$living_status
kable(Categorical_summary(vari, missing_values = miss_values_vector)[3], caption = ds_label) 
kable(Categorical_summary(vari, missing_values = miss_values_vector)[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = miss_values_vector)[2], caption = "Type of missing")
ggplot(ALSA_ds_w2, aes(x=factor(living_status))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab(ds_label) + ylab("Frequency")
```

### Validation
```{r crosstabulation2, echo=F}
```


### Wave 3

#### Study-specific variable description

The study-specific variable elected to be harmonised is:

| **Name** | `deathdate`| `datew3` |
|-|-|-|
| **Label** | `date of death`| `Date of Wave3 interview` | 
| **Table name** | `Death_dates_laia` | `dates_of_interview_w3` |
| **Description** |  |  |

    
```{r assign3, echo=F}
opal.assign.table.tibble(o, 'ALSA_inter','ALSA.dates_of_interview_w3',
                         variables=list('datew3'), missings = TRUE)
ALSA_inter <- opal.execute(o,'ALSA_inter')
opal.assign.table.tibble(o, 'ALSA_death','ALSA.Death_dates_laia',
                         variables=list('deathdate'), missings = TRUE)
ALSA_death <- opal.execute(o,'ALSA_death')

ALSA_death <- ALSA_death %>% 
  mutate(deathdate = if_else(id == "501", NA_Date_, as.Date(as.numeric(deathdate), origin = "1970-01-01")))


ALSA_ls <- left_join(x = ALSA_death, y = ALSA_inter, by = 'id')
```

```{r local3, echo=F}
vari <- ALSA_ls$datew3
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(ALSA_ls, aes(x=datew3)) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Date of interview") + ylab("Frequency") 

vari <- ALSA_ls$deathdate
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(ALSA_ls, aes(x=deathdate)) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Date of death") + ylab("Frequency") 
```

### Harmonisation algorithm
The harmonized variable is going to be recoded from date of death and interview variables as follow:

* `consider all the individuals as 2`
* `the individuals with data in the wave 3 interview as 0`
* `the individuals with date of death before the last day that the interview take place as 1`

R script:

```{r harmo3}
ALSA_ds_w3 <- tibble(id=ALSA_ls$id)
ALSA_ds_w3$living_status <- 2
ALSA_ds_w3$living_status[!is.na(ALSA_ls$datew3)] <- 0
ALSA_ds_w3$living_status[ALSA_ls$deathdate < ALSA_ls$datew3] <- 1
ALSA_ds_w3$living_status[which(is.na(ALSA_ls$datew3) & ALSA_ls$deathdate<as.Date("28/02/1995", "%d/%m/%Y"))] <- 1
ALSA_ds_w3$living_status <- labelled(ALSA_ds_w3$living_status, labels = c("Alive"=0, "Dead"=1, "Dropout"=2, "Missing"=999, "Do not know"=998, "Refuse"=997, "Not applicable"=996, "Does not answer"=995,  "Not attempt not done"=994, "Disable to measure"=993, "Impute"=992, "CAPI interviewer error"=991))
```

### Statistics of the new harmonised variable
```{r descript3, echo=F}
vari <- ALSA_ds_w3$living_status
kable(Categorical_summary(vari, missing_values = miss_values_vector)[3], caption = ds_label) 
kable(Categorical_summary(vari, missing_values = miss_values_vector)[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = miss_values_vector)[2], caption = "Type of missing")
ggplot(ALSA_ds_w3, aes(x=factor(living_status))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab(ds_label) + ylab("Frequency")
```

### Validation
```{r crosstabulation3, echo=F}
```


### Wave 4

#### Study-specific variable description

The study-specific variable elected to be harmonised is:

| **Name** | `deathdate`| `DATEW4` |
|-|-|-|
| **Label** | `date of death`| `DATE OF INTERVIEW` | 
| **Table name** | `Death_dates_laia` | `ALSA-Wave4` |
| **Description** |  |  |

    
```{r assign4, echo=F}
opal.assign.table.tibble(o, 'ALSA_inter','ALSA.ALSA-Wave4',
                         variables=list('DATEW4'), missings = TRUE)
ALSA_inter <- opal.execute(o,'ALSA_inter')
ALSA_inter$DATEW4 <- as.Date(ALSA_inter$DATEW4, "%d.%m.%y")

opal.assign.table.tibble(o, 'ALSA_death','ALSA.Death_dates_laia',
                         variables=list('deathdate'), missings = TRUE)
ALSA_death <- opal.execute(o,'ALSA_death')

ALSA_death <- ALSA_death %>% 
  mutate(deathdate = if_else(id == "501", NA_Date_, as.Date(as.numeric(deathdate), origin = "1970-01-01")))

ALSA_ls <- left_join(x = ALSA_death, y = ALSA_inter, by = 'id')
```

```{r local4, echo=F}
vari <- ALSA_ls$DATEW4[which(year(ALSA_ls$DATEW4) %in% c(1991:1999))]
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(filter(ALSA_ls, year(DATEW4) %in% c(1991:1999)), aes(x=DATEW4)) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Date of interview") + ylab("Frequency") 

vari <- ALSA_ls$deathdate
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(ALSA_ls, aes(x=deathdate)) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Date of death") + ylab("Frequency") 
```

#### Harmonisation algorithm
The harmonized variable is going to be recoded from date of death and interview variables as follow:

* `consider all the individuals as 2`
* `the individuals with data in the wave 4 interview as 0`
* `the individuals with date of death before the last day that the interview take place as 1`

R script:

```{r harmo4}
ALSA_ds_w4 <- tibble(id=ALSA_ls$id)
ALSA_ds_w4$living_status <- 2
ALSA_ds_w4$living_status[!is.na(ALSA_ls$DATEW4)] <- 0
# ALSA_ds_w4$living_status[ALSA_ls$deathdate < ALSA_ls$DATEW4] <- 1
ALSA_ds_w4$living_status[which(is.na(ALSA_ls$DATEW4) & ALSA_ls$deathdate < as.Date("31/01/1996", "%d/%m/%Y"))] <- 1
ALSA_ds_w4$living_status <- labelled(ALSA_ds_w4$living_status, labels = c("Alive"=0, "Dead"=1, "Dropout"=2, "Missing"=999, "Do not know"=998, "Refuse"=997, "Not attempt not done"=996, "Does not answer"=995,  "Not applicable"=994, "Disable to measure"=993, "Impute"=992, "CAPI interviewer error"=991))
```

#### Statistics of the new harmonised variable
```{r descript4, echo=F}
vari <- ALSA_ds_w4$living_status
kable(Categorical_summary(vari, missing_values = miss_values_vector)[3], caption = ds_label) 
kable(Categorical_summary(vari, missing_values = miss_values_vector)[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = miss_values_vector)[2], caption = "Type of missing")
ggplot(ALSA_ds_w4, aes(x=factor(living_status))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab(ds_label) + ylab("Frequency")
```

#### Validation
```{r crosstabulation4, echo=F}
```


### Wave 5

#### Study-specific variable description

The study-specific variable elected to be harmonised is:

| **Name** | `deathdate`| `DATE` |
|-|-|-|
| **Label** | `date of death`| `DATE INTERVIEW COMPLETED` | 
| **Table name** | `Death_dates_laia` | `ALSA-Wave5` |
| **Description** |  |

    
```{r assign5, echo=F}
opal.assign.table.tibble(o, 'ALSA_inter','ALSA.ALSA-Wave5',
                         variables=list('DATE'), missings = TRUE)
ALSA_inter <- opal.execute(o,'ALSA_inter')
ALSA_inter$DATE <- as.Date(ALSA_inter$DATE, "%m/%d/%Y")

opal.assign.table.tibble(o, 'ALSA_death','ALSA.Death_dates_laia',
                         variables=list('deathdate'), missings = TRUE)
ALSA_death <- opal.execute(o,'ALSA_death')

ALSA_death <- ALSA_death %>% 
  mutate(deathdate = if_else(id == "501", NA_Date_, as.Date(as.numeric(deathdate), origin = "1970-01-01")))

ALSA_ls <- left_join(x = ALSA_death, y = ALSA_inter, by = 'id')
```

```{r local5, echo=F}
vari <- ALSA_ls$DATE
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(ALSA_ls, aes(x=DATE)) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Date of interview") + ylab("Frequency") 

vari <- ALSA_ls$deathdate
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(ALSA_ls, aes(x=deathdate)) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Date of death") + ylab("Frequency") 
```

#### Harmonisation algorithm
The harmonized variable is going to be recoded from date of death and interview variables as follow:

* `consider all the individuals as 2`
* `the individuals with data in the wave 5 interview as 0`
* `the individuals with date of death before the last day that the interview take place as 1`

R script:

```{r harmo5}
ALSA_ds_w5 <- tibble(id=ALSA_ls$id)
ALSA_ds_w5$living_status <- 2
ALSA_ds_w5$living_status[!is.na(ALSA_ls$DATE)] <- 0
ALSA_ds_w5$living_status[ALSA_ls$deathdate < ALSA_ls$DATE] <- 1
ALSA_ds_w5$living_status[which(is.na(ALSA_ls$DATE) & ALSA_ls$deathdate < as.Date("03/12/1998", "%d/%m/%Y"))] <- 1
ALSA_ds_w5$living_status <- labelled(ALSA_ds_w5$living_status, labels = c("Alive"=0, "Dead"=1, "Dropout"=2, "Missing"=999, "Do not know"=998, "Refuse"=997, "Not attempt not done"=996, "Does not answer"=995,  "Not applicable"=994, "Disable to measure"=993, "Impute"=992, "CAPI interviewer error"=991))
```

#### Statistics of the new harmonised variable
```{r descript5, echo=F}
vari <- ALSA_ds_w5$living_status
kable(Categorical_summary(vari, missing_values = miss_values_vector)[3], caption = ds_label) 
kable(Categorical_summary(vari, missing_values = miss_values_vector)[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = miss_values_vector)[2], caption = "Type of missing")
ggplot(ALSA_ds_w5, aes(x=factor(living_status))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab(ds_label) + ylab("Frequency")
```

#### Validation
```{r crosstabulation2, echo=F}
```


### Wave 6

#### Study-specific variable description

The study-specific variable elected to be harmonised is:

| **Name** | `deathdate`| `DATEW6` |
|-|-|-|
| **Label** | `date of death`| `Wave6 interview date` | 
| **Table name** | `Death_dates_laia` | `ALSA-Wave6` |
| **Description** |  |  |

    
```{r assign6, echo=F}
opal.assign.table.tibble(o, 'ALSA_inter','ALSA.ALSA-Wave6',
                         variables=list('DATEW6'), missings = TRUE)
ALSA_inter <- opal.execute(o,'ALSA_inter')
opal.assign.table.tibble(o, 'ALSA_death','ALSA.Death_dates_laia',
                         variables=list('deathdate'), missings = TRUE)
ALSA_death <- opal.execute(o,'ALSA_death')
ALSA_death <- ALSA_death %>% 
  mutate(deathdate = if_else(id == "501", NA_Date_, as.Date(as.numeric(deathdate), origin = "1970-01-01")))

ALSA_ls <- left_join(x = ALSA_death, y = ALSA_inter, by = 'id')
```

```{r local6, echo=F}
vari <- ALSA_ls$DATEW6
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(ALSA_ls, aes(x=DATEW6)) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Date of interview") + ylab("Frequency") 

vari <- ALSA_ls$deathdate
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(ALSA_ls, aes(x=deathdate)) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Date of death") + ylab("Frequency") 
```

#### Harmonisation algorithm
The harmonized variable is going to be recoded from date of death and interview variables as follow:

* `consider all the individuals as 2`
* `the individuals with data in the wave 6 interview as 0`
* `the individuals with date of death before the last day that the interview take place as 1`

R script:

```{r harmo6}
ALSA_ds_w6 <- tibble(id=ALSA_ls$id)
ALSA_ds_w6$living_status <- 2
ALSA_ds_w6$living_status[!is.na(ALSA_ls$DATEW6)] <- 0
ALSA_ds_w6$living_status[ALSA_ls$deathdate < ALSA_ls$DATEW6] <- 1
ALSA_ds_w6$living_status[which(is.na(ALSA_ls$DATEW6) & ALSA_ls$deathdate<as.Date("13/12/2001", "%d/%m/%Y"))] <- 1
ALSA_ds_w6$living_status <- labelled(ALSA_ds_w6$living_status, labels = c("Alive"=0, "Dead"=1, "Dropout"=2, "Missing"=999, "Do not know"=998, "Refuse"=997, "Not attempt not done"=996, "Does not answer"=995,  "Not applicable"=994, "Disable to measure"=993, "Impute"=992, "CAPI interviewer error"=991))
```

#### Statistics of the new harmonised variable
```{r descript6, echo=F}
vari <- ALSA_ds_w6$living_status
kable(Categorical_summary(vari, missing_values = miss_values_vector)[3], caption = ds_label) 
kable(Categorical_summary(vari, missing_values = miss_values_vector)[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = miss_values_vector)[2], caption = "Type of missing")
ggplot(ALSA_ds_w6, aes(x=factor(living_status))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab(ds_label) + ylab("Frequency")
```

#### Validation
```{r crosstabulation6, echo=F}
```


### Wave 7

#### Study-specific variable description

The study-specific variable elected to be harmonised is:

| **Name** | `deathdate`| `datew7` |
|-|-|-|
| **Label** | `date of death`| `date of interview-W7` | 
| **Table name** | `Death_dates_laia` | `dates_of_interview_w7` |
| **Description** |  |  |

    
```{r assign7, echo=F}
opal.assign.table.tibble(o, 'ALSA_inter','ALSA.dates_of_interview_w7',
                         variables=list('datew7'), missings = TRUE)
ALSA_inter <- opal.execute(o,'ALSA_inter')
opal.assign.table.tibble(o, 'ALSA_death','ALSA.Death_dates_laia',
                         variables=list('deathdate'), missings = TRUE)
ALSA_death <- opal.execute(o,'ALSA_death')
ALSA_death <- ALSA_death %>% 
  mutate(deathdate = if_else(id == "501", NA_Date_, as.Date(as.numeric(deathdate), origin = "1970-01-01")))

ALSA_ls <- left_join(x = ALSA_death, y = ALSA_inter, by = 'id')
```

```{r local7, echo=F}
vari <- ALSA_ls$datew7
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(ALSA_ls, aes(x=datew7)) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Date of interview") + ylab("Frequency") 

vari <- ALSA_ls$deathdate
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(ALSA_ls, aes(x=deathdate)) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Date of death") + ylab("Frequency") 
```

#### Harmonisation algorithm
The harmonized variable is going to be recoded from date of death and interview variables as follow:

* `consider all the individuals as 2`
* `the individuals with data in the wave 7 interview as 0`
* `the individuals with date of death before the last day that the interview take place as 1`

R script:

```{r harmo7}
ALSA_ds_w7 <- tibble(id=ALSA_ls$id)
ALSA_ds_w7$living_status <- 2
ALSA_ds_w7$living_status[!is.na(ALSA_ls$datew7)] <- 0
ALSA_ds_w7$living_status[ALSA_ls$deathdate < ALSA_ls$datew7] <- 1
ALSA_ds_w7$living_status[which(is.na(ALSA_ls$datew7) & ALSA_ls$deathdate<as.Date("22/04/2004", "%d/%m/%Y"))] <- 1
ALSA_ds_w7$living_status <- labelled(ALSA_ds_w7$living_status, labels = c("Alive"=0, "Dead"=1, "Dropout"=2, "Missing"=999, "Do not know"=998, "Refuse"=997, "Not attempt not done"=996, "Does not answer"=995,  "Not applicable"=994, "Disable to measure"=993, "Impute"=992, "CAPI interviewer error"=991))
```

#### Statistics of the new harmonised variable
```{r descript7, echo=F}
vari <- ALSA_ds_w7$living_status
kable(Categorical_summary(vari, missing_values = miss_values_vector)[3], caption = ds_label) 
kable(Categorical_summary(vari, missing_values = miss_values_vector)[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = miss_values_vector)[2], caption = "Type of missing")
ggplot(ALSA_ds_w7, aes(x=factor(living_status))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab(ds_label) + ylab("Frequency")
```

#### Validation
```{r crosstabulation7, echo=F}
```


### Wave 8

#### Study-specific variable description

The study-specific variable elected to be harmonised is:

| **Name** | `deathdate`| `Date` |
|-|-|-|
| **Label** | `date of death`| `Date` | 
| **Table name** | `Death_dates_laia` | `.ALSA-Wave8` |
| **Description** |  |

    
```{r assign8, echo=F}
opal.assign.table.tibble(o, 'ALSA_inter','ALSA.ALSA-Wave8',
                         variables=list('Date'), missings = TRUE)
ALSA_inter <- opal.execute(o,'ALSA_inter')
ALSA_inter$Date <- as.Date(ALSA_inter$Date, "%Y%m%d")

opal.assign.table.tibble(o, 'ALSA_death','ALSA.Death_dates_laia',
                         variables=list('deathdate'), missings = TRUE)
ALSA_death <- opal.execute(o,'ALSA_death')
ALSA_death <- ALSA_death %>% 
  mutate(deathdate = if_else(id == "501", NA_Date_, as.Date(as.numeric(deathdate), origin = "1970-01-01")))

ALSA_ls <- left_join(x = ALSA_death, y = ALSA_inter, by = 'id')
```

```{r local8, echo=F}
vari <- ALSA_ls$Date
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(ALSA_ls, aes(x=Date)) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Date of interview") + ylab("Frequency") 

vari <- ALSA_ls$deathdate
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(ALSA_ls, aes(x=deathdate)) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Date of death") + ylab("Frequency") 
```

#### Harmonisation algorithm
The harmonized variable is going to be recoded from date of death and interview variables as follow:

* `consider all the individuals as 2`
* `the individuals with data in the wave 8 interview as 0`
* `the individuals with date of death before the last day that the interview take place as 1`

R script:

```{r harmo8}
ALSA_ds_w8 <- tibble(id=ALSA_ls$id)
ALSA_ds_w8$living_status <- 2
ALSA_ds_w8$living_status[!is.na(ALSA_ls$Date)] <- 0
ALSA_ds_w8$living_status[ALSA_ls$deathdate < ALSA_ls$Date] <- 1
ALSA_ds_w8$living_status[which(is.na(ALSA_ls$Date) & ALSA_ls$deathdate<as.Date("06/03/2006", "%d/%m/%Y"))] <- 1
ALSA_ds_w8$living_status <- labelled(ALSA_ds_w8$living_status, labels = c("Alive"=0, "Dead"=1, "Dropout"=2, "Missing"=999, "Do not know"=998, "Refuse"=997, "Not attempt not done"=996, "Does not answer"=995,  "Not applicable"=994, "Disable to measure"=993, "Impute"=992, "CAPI interviewer error"=991))
```

#### Statistics of the new harmonised variable
```{r descript8, echo=F}
vari <- ALSA_ds_w8$living_status
kable(Categorical_summary(vari, missing_values = miss_values_vector)[3], caption = ds_label) 
kable(Categorical_summary(vari, missing_values = miss_values_vector)[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = miss_values_vector)[2], caption = "Type of missing")
ggplot(ALSA_ds_w8, aes(x=factor(living_status))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab(ds_label) + ylab("Frequency")
```

#### Validation
```{r crosstabulation8, echo=F}
```


### Wave 9

#### Study-specific variable description

The study-specific variable elected to be harmonised is:

| **Name** | `deathdate`| `DATEW9` |
|-|-|-|
| **Label** | `date of death`| `Date of interview Wave 9` | 
| **Table name** | `Death_dates_laia` | `ALSA-Wave9` |
| **Description** |  |  |

    
```{r assign9, echo=F}
opal.assign.table.tibble(o, 'ALSA_inter','ALSA.ALSA-Wave9',
                         variables=list('DATEW9'), missings = TRUE)
ALSA_inter <- opal.execute(o,'ALSA_inter')
ALSA_inter$DATEW9 <- as.Date(ALSA_inter$DATEW9, "%Y%m%d")

opal.assign.table.tibble(o, 'ALSA_death','ALSA.Death_dates_laia',
                         variables=list('deathdate'), missings = TRUE)
ALSA_death <- opal.execute(o,'ALSA_death')
ALSA_death <- ALSA_death %>% 
  mutate(deathdate = if_else(id == "501", NA_Date_, as.Date(as.numeric(deathdate), origin = "1970-01-01")))


ALSA_ls <- left_join(x = ALSA_death, y = ALSA_inter, by = 'id')
```

```{r local9, echo=F}
vari <- ALSA_ls$DATEW9
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(ALSA_ls, aes(x=DATEW9)) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Date of interview") + ylab("Frequency") 

vari <- ALSA_ls$deathdate
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(ALSA_ls, aes(x=deathdate)) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Date of death") + ylab("Frequency") 
```

#### Harmonisation algorithm
The harmonized variable is going to be recoded from date of death and interview variables as follow:

* `consider all the individuals as 2`
* `the individuals with data in the wave 9 interview as 0`
* `the individuals with date of death before the last day that the interview take place as 1`

R script:

```{r harmo9}
ALSA_ds_w9 <- tibble(id=ALSA_ls$id)
ALSA_ds_w9$living_status <- 2
ALSA_ds_w9$living_status[!is.na(ALSA_ls$DATEW9)] <- 0
ALSA_ds_w9$living_status[ALSA_ls$deathdate < ALSA_ls$DATEW9] <- 1
ALSA_ds_w9$living_status[which(is.na(ALSA_ls$DATEW9) & ALSA_ls$deathdate<as.Date("04/07/2008", "%d/%m/%Y"))] <- 1
ALSA_ds_w9$living_status <- labelled(ALSA_ds_w9$living_status, labels = c("Alive"=0, "Dead"=1, "Dropout"=2, "Missing"=999, "Do not know"=998, "Refuse"=997, "Not attempt not done"=996, "Does not answer"=995,  "Not applicable"=994, "Disable to measure"=993, "Impute"=992, "CAPI interviewer error"=991))
```

#### Statistics of the new harmonised variable
```{r descript9, echo=F}
vari <- ALSA_ds_w9$living_status
kable(Categorical_summary(vari, missing_values = miss_values_vector)[3], caption = ds_label) 
kable(Categorical_summary(vari, missing_values = miss_values_vector)[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = miss_values_vector)[2], caption = "Type of missing")
ggplot(ALSA_ds_w9, aes(x=factor(living_status))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab(ds_label) + ylab("Frequency")
```

#### Validation
```{r crosstabulation9, echo=F}
```


### Wave 10

#### Study-specific variable description

The study-specific variable elected to be harmonised is:

| **Name** | `deathdate`| `Date` |
|-|-|-|
| **Label** | `date of death`| `Date` | 
| **Table name** | `Death_dates_laia` | `ALSA-Wave10` |
| **Description** |  |

    
```{r assign10, echo=F}
opal.assign.table.tibble(o, 'ALSA_inter','ALSA.ALSA-Wave10',
                         variables=list('Date'), missings = TRUE)
ALSA_inter <- opal.execute(o,'ALSA_inter')
opal.assign.table.tibble(o, 'ALSA_death','ALSA.Death_dates_laia',
                         variables=list('deathdate'), missings = TRUE)
ALSA_death <- opal.execute(o,'ALSA_death')
ALSA_death <- ALSA_death %>% 
  mutate(deathdate = if_else(id == "501", NA_Date_, as.Date(as.numeric(deathdate), origin = "1970-01-01")))

ALSA_ls <- left_join(x = ALSA_death, y = ALSA_inter, by = 'id')
```

```{r local10, echo=F}
vari <- ALSA_ls$Date
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(ALSA_ls, aes(x=Date)) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Date of interview") + ylab("Frequency") 

vari <- ALSA_ls$deathdate
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(ALSA_ls, aes(x=deathdate)) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Date of death") + ylab("Frequency") 
```

#### Harmonisation algorithm
The harmonized variable is going to be recoded from date of death and interview variables as follow:

* `consider all the individuals as 2`
* `the individuals with data in the wave 10 interview as 0`
* `the individuals with date of death before the last day that the interview take place as 1`

R script:

```{r harmo10}
ALSA_ds_w10 <- tibble(id=ALSA_ls$id)
ALSA_ds_w10$living_status <- 2
ALSA_ds_w10$living_status[!is.na(ALSA_ls$Date)] <- 0
ALSA_ds_w10$living_status[ALSA_ls$deathdate < ALSA_ls$Date] <- 1
ALSA_ds_w10$living_status[which(is.na(ALSA_ls$Date) & ALSA_ls$deathdate<as.Date("28/07/2009", "%d/%m/%Y"))] <- 1
ALSA_ds_w10$living_status <- labelled(ALSA_ds_w10$living_status, labels = c("Alive"=0, "Dead"=1, "Dropout"=2, "Missing"=999, "Do not know"=998, "Refuse"=997, "Not attempt not done"=996, "Does not answer"=995,  "Not applicable"=994, "Disable to measure"=993, "Impute"=992, "CAPI interviewer error"=991))
```

#### Statistics of the new harmonised variable
```{r descript10, echo=F}
vari <- ALSA_ds_w10$living_status
kable(Categorical_summary(vari, missing_values = miss_values_vector)[3], caption = ds_label) 
kable(Categorical_summary(vari, missing_values = miss_values_vector)[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = miss_values_vector)[2], caption = "Type of missing")
ggplot(ALSA_ds_w10, aes(x=factor(living_status))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab(ds_label) + ylab("Frequency")
```

#### Validation
```{r crosstabulation10, echo=F}
```


### Wave 11

#### Study-specific variable description

The study-specific variable elected to be harmonised is:

| **Name** | `deathdate`| `DATEW11` |
|-|-|-|
| **Label** | `date of death`| `Date of interview Wave 11` | 
| **Table name** | `Death_dates_laia` | `ALSA-Wave11` |
| **Description** |  |

    
```{r assign11, echo=F}
opal.assign.table.tibble(o, 'ALSA_inter','ALSA.ALSA-Wave11',
                         variables=list('DATEW11'), missings = TRUE)
ALSA_inter <- opal.execute(o,'ALSA_inter')
opal.assign.table.tibble(o, 'ALSA_death','ALSA.Death_dates_laia',
                         variables=list('deathdate'), missings = TRUE)
ALSA_death <- opal.execute(o,'ALSA_death')
ALSA_death <- ALSA_death %>% 
  mutate(deathdate = if_else(id == "501", NA_Date_, as.Date(as.numeric(deathdate), origin = "1970-01-01")))

ALSA_ls <- left_join(x = ALSA_death, y = ALSA_inter, by = 'id')
```

```{r local11, echo=F}
vari <- ALSA_ls$DATEW11
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(ALSA_ls, aes(x=DATEW11)) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Date of interview") + ylab("Frequency") 

vari <- ALSA_ls$deathdate
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(ALSA_ls, aes(x=deathdate)) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Date of death") + ylab("Frequency") 
```

#### Harmonisation algorithm
The harmonized variable is going to be recoded from date of death and interview variables as follow:

* `consider all the individuals as 2`
* `the individuals with data in the wave 11 interview as 0`
* `the individuals with date of death before the last day that the interview take place as 1`

R script:

```{r harmo11}
ALSA_ds_w11 <- tibble(id=ALSA_ls$id)
ALSA_ds_w11$living_status <- 2
ALSA_ds_w11$living_status[!is.na(ALSA_ls$DATEW11)] <- 0
ALSA_ds_w11$living_status[ALSA_ls$deathdate < ALSA_ls$DATEW11] <- 1
ALSA_ds_w11$living_status[which(is.na(ALSA_ls$DATEW11) & ALSA_ls$deathdate<as.Date("13/11/2010", "%d/%m/%Y"))] <- 1
ALSA_ds_w11$living_status <- labelled(ALSA_ds_w11$living_status, labels = c("Alive"=0, "Dead"=1, "Dropout"=2, "Missing"=999, "Do not know"=998, "Refuse"=997, "Not attempt not done"=996, "Does not answer"=995,  "Not applicable"=994, "Disable to measure"=993, "Impute"=992, "CAPI interviewer error"=991))
```

#### Statistics of the new harmonised variable
```{r descript11, echo=F}
vari <- ALSA_ds_w11$living_status
kable(Categorical_summary(vari, missing_values = miss_values_vector)[3], caption = ds_label) 
kable(Categorical_summary(vari, missing_values = miss_values_vector)[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = miss_values_vector)[2], caption = "Type of missing")
ggplot(ALSA_ds_w11, aes(x=factor(living_status))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab(ds_label) + ylab("Frequency")
```

#### Validation
```{r crosstabulation11, echo=F}
```


### Wave 12

#### Study-specific variable description

The study-specific variable elected to be harmonised is:

| **Name** | `deathdate`| `DATEW12` |
|-|-|-|
| **Label** | `date of death`| `Date of interview Wave 12` | 
| **Table name** | `Death_dates_laia` | `ALSA-Wave12` |
| **Description** |  |

    
```{r assign12, echo=F}
opal.assign.table.tibble(o, 'ALSA_inter','ALSA.ALSA-Wave12',
                         variables=list('DATEW12'), missings = TRUE)
ALSA_inter <- opal.execute(o,'ALSA_inter')
opal.assign.table.tibble(o, 'ALSA_death','ALSA.Death_dates_laia',
                         variables=list('deathdate'), missings = TRUE)
ALSA_death <- opal.execute(o,'ALSA_death')
ALSA_death <- ALSA_death %>% 
  mutate(deathdate = if_else(id == "501", NA_Date_, as.Date(as.numeric(deathdate), origin = "1970-01-01")))

ALSA_ls <- left_join(x = ALSA_death, y = ALSA_inter, by = 'id')
```

```{r local12, echo=F}
vari <- ALSA_ls$DATEW12
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(ALSA_ls, aes(x=DATEW12)) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Date of interview") + ylab("Frequency") 

vari <- ALSA_ls$deathdate
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(ALSA_ls, aes(x=deathdate)) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Date of death") + ylab("Frequency") 
```

#### Harmonisation algorithm
The harmonized variable is going to be recoded from date of death and interview variables as follow:

* `consider all the individuals as 2`
* `the individuals with data in the wave 12 interview as 0`
* `the individuals with date of death before the last day that the interview take place as 1`

R script:

```{r harmo12}
ALSA_ds_w12 <- tibble(id=ALSA_ls$id)
ALSA_ds_w12$living_status <- 2
ALSA_ds_w12$living_status[!is.na(ALSA_ls$DATEW12)] <- 0
ALSA_ds_w12$living_status[ALSA_ls$deathdate < ALSA_ls$DATEW12] <- 1
ALSA_ds_w12$living_status[which(is.na(ALSA_ls$DATEW12) & ALSA_ls$deathdate<as.Date("29/08/2013", "%d/%m/%Y"))] <- 1
ALSA_ds_w12$living_status <- labelled(ALSA_ds_w12$living_status, labels = c("Alive"=0, "Dead"=1, "Dropout"=2, "Missing"=999, "Do not know"=998, "Refuse"=997, "Not attempt not done"=996, "Does not answer"=995,  "Not applicable"=994, "Disable to measure"=993, "Impute"=992, "CAPI interviewer error"=991))
```

#### Statistics of the new harmonised variable
```{r descript12, echo=F}
vari <- ALSA_ds_w12$living_status
kable(Categorical_summary(vari, missing_values = miss_values_vector)[3], caption = ds_label) 
kable(Categorical_summary(vari, missing_values = miss_values_vector)[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = miss_values_vector)[2], caption = "Type of missing")
ggplot(ALSA_ds_w12, aes(x=factor(living_status))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab(ds_label) + ylab("Frequency")
```

#### Validation
```{r crosstabulation12, echo=F}
```


### Wave 13

#### Study-specific variable description

The study-specific variable elected to be harmonised is:

| **Name** | `deathdate`| `DATEW13` |
|-|-|-|
| **Label** | `date of death`| `Date of interview Wave 13` | 
| **Table name** | `Death_dates_laia` | `ALSA-Wave13` |
| **Description** |  |

    
```{r assign13, echo=F}
opal.assign.table.tibble(o, 'ALSA_inter','ALSA.ALSA-Wave13',
                         variables=list('DATEW13'), missings = TRUE)
ALSA_inter <- opal.execute(o,'ALSA_inter')

opal.assign.table.tibble(o, 'ALSA_death','ALSA.Death_dates_laia',
                         variables=list('deathdate'), missings = TRUE)
ALSA_death <- opal.execute(o,'ALSA_death')
ALSA_death <- ALSA_death %>% 
  mutate(deathdate = if_else(id == "501", NA_Date_, as.Date(as.numeric(deathdate), origin = "1970-01-01")))

ALSA_ls <- left_join(x = ALSA_death, y = ALSA_inter, by = 'id')
```

```{r local13, echo=F}
vari <- ALSA_ls$DATEW13
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(ALSA_ls, aes(x=DATEW13)) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Date of interview") + ylab("Frequency") 

vari <- ALSA_ls$deathdate
kable(Continuous_summary(vari, missing_values = NA)[3], caption = ds_label) 
pander(Continuous_summary(vari, missing_values = NA)$summary, caption = "Summary")
ggplot(ALSA_ls, aes(x=deathdate)) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Date of death") + ylab("Frequency") 
```

#### Harmonisation algorithm
The harmonized variable is going to be recoded from date of death and interview variables as follow:

* `consider all the individuals as 2`
* `the individuals with data in the wave 13 interview as 0`
* `the individuals with date of death before the last day that the interview take place as 1`

R script:

```{r harmo13}
ALSA_ds_w13 <- tibble(id=ALSA_ls$id)
ALSA_ds_w13$living_status <- 2
ALSA_ds_w13$living_status[!is.na(ALSA_ls$DATEW13)] <- 0
ALSA_ds_w13$living_status[ALSA_ls$deathdate < ALSA_ls$DATEW13] <- 1
ALSA_ds_w13$living_status[which(is.na(ALSA_ls$DATEW13) & ALSA_ls$deathdate<as.Date("24/06/2014", "%d/%m/%Y"))] <- 1
ALSA_ds_w13$living_status <- labelled(ALSA_ds_w13$living_status, labels = c("Alive"=0, "Dead"=1, "Dropout"=2, "Missing"=999, "Do not know"=998, "Refuse"=997, "Not attempt not done"=996, "Does not answer"=995,  "Not applicable"=994, "Disable to measure"=993, "Impute"=992, "CAPI interviewer error"=991))
```

#### Statistics of the new harmonised variable
```{r descript13, echo=F}
vari <- ALSA_ds_w13$living_status
kable(Categorical_summary(vari, missing_values = miss_values_vector)[3], caption = ds_label) 
kable(Categorical_summary(vari, missing_values = miss_values_vector)[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = miss_values_vector)[2], caption = "Type of missing")
ggplot(ALSA_ds_w13, aes(x=factor(living_status))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab(ds_label) + ylab("Frequency")
```

#### Validation
```{r crosstabulation13, echo=F}
```






## Summary of descriptive statistics of the harmonised variable accross populations and waves

Two tables are generated: 

1. Percentages of categories in each harmonised variable.

2. Frequencies and percentages of individuals with different trajectories.


```{r helpfunctions, echo=F}

source("../../helpfunctions.r")

```




```{r summ, echo=F}

# All study waves and populations with abbreviated and descriptive names


alsa.cw <- list(w1 = c("w1","W1"), w2 = c("w2","W2"), w3 = c("w3","W3"), w4 = c("w4","W4"), w5 = c("w5","W5"), w6 = c("w6","W6"), w7 = c("w7","W7"), w8 = c("w8","W8"), w9 = c("w9","W9"), w10 = c("w10","W10"), w11 = c("w11","W11"), w12 = c("w12","W12"), w13 = c("w13","W13"))

# Consider only harmonised waves
l.hds <- lapply(alsa.cw, function(wname) if(exists(paste0("ALSA_ds_",wname[1]))){wname = list(get(paste0("ALSA_ds_",wname[1])),wname[2])})
nullw <- which(sapply(l.hds, is.null))

if(length(nullw)!=0){
  l.hds <- l.hds[-nullw]
}

m.hds <- list()

lmlist <- list(lapply(l.hds,function(x)x[[1]]),m.hds)

if(length(l.hds)>0){
  # Labelling tibbles
  lmlist <- labelling(lmlist[[1]],lmlist[[2]])
  # Printing table of categories
  print(knitr::kable(summaries(lmlist[[1]],lmlist[[2]],lapply(l.hds,function(x)x[[2]])),caption=ds_label))
  # Printing table of trajectories
  f.dbb <- trajectories(lmlist[[2]],vbl_name=hd_vbl)
  print(knitr::kable(f.dbb))
  # Saving tibbles
  savingRD(lmlist[[1]],vbl_name=hd_vbl)
}



```




<!--
### Validation throughout waves

```{r valid_ws_hrs, eval=F, echo=F}
dbb <- left_join(x = ALSA_ds_w1, y = ALSA_ds_w2, by = "id", suffix = c(".w1", ".w2"))
dbb <- left_join(x = dbb, y = ALSA_ds_w3, by = "id")
names(dbb) <- c("id", "w1", "w2", "w3")
dbb <- left_join(x = dbb, y = ALSA_ds_w4, by = "id")
names(dbb) <- c("id", "w1", "w2", "w3", "w4")
dbb <- left_join(x = dbb, y = ALSA_ds_w5, by = "id")
names(dbb) <- c("id", "w1", "w2", "w3", "w4", "w5")
dbb <- left_join(x = dbb, y = ALSA_ds_w6, by = "id")
names(dbb) <- c("id", "w1", "w2", "w3", "w4", "w5", "w6")
dbb <- left_join(x = dbb, y = ALSA_ds_w7, by = "id")
names(dbb) <- c("id", "w1", "w2", "w3", "w4", "w5", "w6", "W7")
dbb <- left_join(x = dbb, y = ALSA_ds_w8, by = "id")
names(dbb) <- c("id", "w1", "w2", "w3", "w4", "w5", "w6", "W7", "w8")
dbb <- left_join(x = dbb, y = ALSA_ds_w9, by = "id")
names(dbb) <- c("id", "w1", "w2", "w3", "w4", "w5", "w6", "W7", "w8", "w9")
dbb <- left_join(x = dbb, y = ALSA_ds_w10, by = "id")
names(dbb) <- c("id", "w1", "w2", "w3", "w4", "w5", "w6", "W7", "w8", "w9", "w10")
dbb <- left_join(x = dbb, y = ALSA_ds_w11, by = "id")
names(dbb) <- c("id", "w1", "w2", "w3", "w4", "w5", "w6", "W7", "w8", "w9", "w10", "w11")
dbb <- left_join(x = dbb, y = ALSA_ds_w12, by = "id")
names(dbb) <- c("id", "w1", "w2", "w3", "w4", "w5", "w6", "W7", "w8", "w9", "w10", "w11", "w12")
dbb <- left_join(x = dbb, y = ALSA_ds_w13, by = "id")
names(dbb) <- c("id", "w1", "w2", "w3", "w4", "w5", "w6", "W7", "w8", "w9", "w10", "w11", "w12", "w13")
dbb$join <- apply(dbb[, 2:14], MARGIN = 1, FUN = function(x) paste(x[1], x[2], x[3], x[4], x[5], x[6], x[7], x[8], x[9], x[10], x[11], x[12], x[13], sep=""))
f.dbb <- frq(dbb$join)[[1]][, c(1, 2, 4)]
kable(f.dbb)
#kable(f.dbb[f.dbb[, 3] >= 0.3, ])
```
-->

# Quality estimation

The variable date of death is the same in all the waves, for this reason if one individual has date of death 
that does not mean that he/she is dead. The individuals that do not have date of interview in any wave but 
have date of death are considered as dead if the date of dead is erlier than the date of the last interview 
in that wave. 

```{r save, eval=F, echo=FALSE}
living_status <- ALSA_ds_w1
save(living_status, file = "../RData/w1/living_status.RData")
rm(living_status)

living_status <- ALSA_ds_w2
save(living_status, file = "../RData/w2/living_status.RData")
rm(living_status)

living_status <- ALSA_ds_w3
save(living_status, file = "../RData/w3/living_status.RData")
rm(living_status)

living_status <- ALSA_ds_w4
save(living_status, file = "../RData/w4/living_status.RData")
rm(living_status)

living_status <- ALSA_ds_w5
save(living_status, file = "../RData/w5/living_status.RData")
rm(living_status)

living_status <- ALSA_ds_w6
save(living_status, file = "../RData/w6/living_status.RData")
rm(living_status)

living_status <- ALSA_ds_w7
save(living_status, file = "../RData/w7/living_status.RData")
rm(living_status)

living_status <- ALSA_ds_w8
save(living_status, file = "../RData/w8/living_status.RData")
rm(living_status)

living_status <- ALSA_ds_w9
save(living_status, file = "../RData/w9/living_status.RData")
rm(living_status)

living_status <- ALSA_ds_w10
save(living_status, file = "../RData/w10/living_status.RData")
rm(living_status)

living_status <- ALSA_ds_w11
save(living_status, file = "../RData/w11/living_status.RData")
rm(living_status)

living_status <- ALSA_ds_w12
save(living_status, file = "../RData/w12/living_status.RData")
rm(living_status)

living_status <- ALSA_ds_w13
save(living_status, file = "../RData/w13/living_status.RData")
rm(living_status)
```


```{r closeRsession, echo=FALSE}
opal.logout(o)
```

