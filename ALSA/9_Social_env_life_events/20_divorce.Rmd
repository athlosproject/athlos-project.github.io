---
title: "Divorce/Separation"
output:
  html_document:
    highlight: tango
    number_sections: yes
    theme: united
    toc: yes
    toc_depth: 6
    toc_float:
      collapsed: yes
      smooth_scroll: yes
---

<!-- ########################################################## --> 

<!-- # Installation, loading packages -->
<!-- **R script:** -->

```{r setup, include=FALSE}
source("M:/WPs/WP1/Maelstrom/data_process/athlos-project.github.io/setup_ania.r")
```

<!-- ########################################################## --> 



# Description of DataSchema variable

The description of harmonised variables is the following:

* Short name: `divorce`
* Variable label: `Experience of divorce/separation`
* Domain: `Social environment`
* Value type: `cathegorical`
* Categories:

**Code** | **Category Label**
-------- | ------------------
0        | No
1        | Yes


* Category missings: 

**Code** | **Category Label**
----| ------------------
991 | CAPI/interviewer error
992 | Impute
993 | Disable to measure
994 | Not attempt/not done
995 | Does not answer
996 | Not applicable
997 | Refuse
998 | Do not know
999 | Missing


<!-- ########################################################## --> 

# Data process

## Australia


### Wave 1 

#### Study-specific variable description

The study-specific variable elected to be harmonised is:

* Name: `MARITST`
* Label: `Marital status`
* Categories: 
    + `1.0 = Married`
    + `2.0 = De facto`
    + `3.0 = Separated`
    + `4.0 = Divorced`
    + `5.0 = Widowed`
    + `6.0 = Never married`
* Missings: 
    + `9.0 = Missing`

* Description: 
```{r assign1, echo=F}
opal.assign.table.tibble(o, 'ALSA_w1_divorce','ALSA.ALSA-Wave1',variables=list('MARITST'), missings = TRUE)
```

```{r local1, echo=F}
ALSA_w1_divorce <- opal.execute(o,'ALSA_w1_divorce')
vari <- ALSA_w1_divorce$MARITST
kable(Categorical_summary(vari, missing_values = c(9))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(9))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(9))[2], caption = "Type of missing")
#Categorical_summary(var = ALSA_w1_divorce$MARITST, missing_values = NA)
ggplot(ALSA_w1_divorce, aes(x=factor(MARITST))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Marital status") + ylab("Frequency")
```

#### Harmonisation algorithm
To compute the harmonize variable from the study-specific variable it has to be recoded as follows:

* `3 or 4 into 1`
* `1,2,5,6 into 0`
* `9 Missing into 999`
* `NA into 999`

**R script:**

```{r harmo1, echo=TRUE}
ALSA_ds_w1 <- tibble(id=ALSA_w1_divorce$id)
ALSA_ds_w1$divorce <- car::recode(as.vector(ALSA_w1_divorce$MARITST), "3:4='1'; 1:2='0'; 5:6='0'; 9='999'; NA='999'")
ALSA_ds_w1$divorce <- labelled(ALSA_ds_w1$divorce, labels = c("No"=0, "Yes"=1, "Missing"=999, "Do not know"=998, "Refuse"=997, "Not applicable"=996, "Don't answer"=995,  "Not attempt/not done/not yet recorded"=994, "Disable to measure"=993, "Impute"=992, "CAPI/interviewer error"=991))
```

#### Statistical description of the new harmonised variable
```{r descript1, echo=F}
vari <- ALSA_ds_w1$divorce
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[3]) 
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[2], caption = "Type of missing")
#Categorical_summary(var = ALSA_ds_w1$divorce, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))
ggplot(ALSA_ds_w1, aes(x=factor(divorce))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Experience of divorce/separation") + ylab("Frequency")
```

#### Validation
```{r crosstabulation1, echo=F}
AfterH <- table(ALSA_ds_w1$divorce)
BeforeH <- table(ALSA_w1_divorce$MARITST, useNA='ifany')
BeforeH1 <- c(NA)
BeforeH1[[2]] <- sum(BeforeH[c(3:4)])
BeforeH1[[1]] <- sum(BeforeH[c(1:2,5:6)])
BeforeH1[[3]] <- BeforeH[[7]]
C <- rbind(BeforeH1,AfterH)
colnames(C) <- c("3:4->0","1:2&5:6->1","9->999")
kable(C)
```


### Wave 2

#### Study-specific variable description

The study-specific variable elected to be harmonised is:

* Name: `Q3`
* Label: `Marital status`
* Categories: 
    + `1.0 = No (still married, defacto)`
    + `2.0 = No (still SINGLE, separated)`
    + `3.0 = Yes, married`
    + `4.0 = Yes, defacto`
    + `5.0 = Yes, separated`
    + `6.0 = Yes, divorced`
    + `7.0 = Yes, widowed`
    

* Name: `divorce` *harmonized variable from Wave1*



* Description: 
```{r assign2, echo=F}
opal.assign.table.tibble(o, 'ALSA_w2_divorce','ALSA.ALSA-Wave2', variables=list('Q3'), missings = TRUE)
```

```{r local2, echo=F}
ALSA_w2_divorce <- opal.execute(o,'ALSA_w2_divorce')
vari<-ALSA_w2_divorce$Q3
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = ALSA_w2_divorce$Q3, missing_values = NA)
ggplot(ALSA_w2_divorce, aes(x=factor(Q3))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Marital status") + ylab("Frequency")
```

#### Harmonisation algorithm
To compute the harmonize variable from the study-specific variable it has to be recoded as follows:

* `if divorce=1 then (no matter what is Q3) OR Q3 equals 5 or 6 then recode into 1`
* `else if Q3 in {1,2,3,4,7} then recode into 0`
* `NA into 999`

**R script:**

```{r harmo2, echo=TRUE}

same_indiv <- function(old, new){
  
  new_2 <- matrix(NA, nrow = dim(new)[1], ncol=dim(old)[2])
  colnames(new_2) <- colnames(old)
  oldm <- as.matrix(old)
  
  for(i in 1:length(new$id)){
    if(sum(new$id[i]==old$id)>=1){
      new_2[i,] <- oldm[which(new$id[i]==old$id),]
    } else {
      new_2[i,] <- c(new$id[i], rep_len(NA,dim(old)[2]-1))
    }
  }
  new_2 <- data.frame(new_2)
  new_22 <- data.frame(id=new_2$id, Q3=new$Q3, divorce=new_2$divorce) 
                       # id = new_2$id
                       # colname_form_OLD_table = new_2$colname_form_OLD_table 
                       # colname_form_NEW_table = new$colname_form_NEW_table
  new_22
}

# old = ALSA_ds_w1 (divorce)
# new = ALSA_w2_divorce (Q3)

ALSA_w2_divorce_2 <- same_indiv(ALSA_ds_w1, ALSA_w2_divorce)

ALSA_ds_w2 <- tibble(id=ALSA_w2_divorce_2$id)

ALSA_w2_divorce_2$divorce <- car::recode(as.vector(ALSA_w2_divorce_2$divorce), "NA='-999'")
ALSA_w2_divorce_2$Q3 <- car::recode(as.vector(ALSA_w2_divorce_2$Q3), "NA='-999'")

ALSA_ds_w2$divorce <- c(NA)   
for(i in 1:dim(ALSA_w2_divorce_2[1])){
  if( ALSA_w2_divorce_2$divorce[i] == 1 | ALSA_w2_divorce_2$Q3[i] %in% c(5,6) ) { ALSA_ds_w2$divorce[i] = 1 }
  else if( ALSA_w2_divorce_2$Q3[i] %in% c(1,2,3,4,7) ) { ALSA_ds_w2$divorce[i] = 0 }
}

ALSA_ds_w2$divorce <- car::recode(as.vector(ALSA_ds_w2$divorce), "NA='999'")
ALSA_ds_w2$divorce <- labelled(ALSA_ds_w2$divorce, labels = c("No"=0, "Yes"=1, "Missing"=999, "Do not know"=998, "Refuse"=997, "Not applicable"=996, "Don't answer"=995,  "Not attempt/not done/not yet recorded"=994, "Disable to measure"=993, "Impute"=992, "CAPI/interviewer error"=991))
```

#### Statistical description of the new harmonised variable
```{r descript2, echo=F}
vari <- ALSA_ds_w2$divorce
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[3]) 
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[2], caption = "Type of missing")
#Categorical_summary(var = ALSA_ds_w2$divorce, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))
ggplot(ALSA_ds_w2, aes(x=factor(divorce))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Experience of divorce/separation") + ylab("Frequency")
```

#### Validation
```{r crosstabulation2, echo=F}
AfterH <- table(ALSA_ds_w2$divorce)
BeforeH <- table(ALSA_w2_divorce_2$divorce, ALSA_w2_divorce_2$Q3, useNA='ifany')
BeforeH1 <- c(NA)
BeforeH1[[2]] <- sum(sum(BeforeH[2,]), BeforeH[1,4])
BeforeH1[[1]] <- sum(BeforeH[c(1,3),c(1,2,3,5)])
C <- rbind(BeforeH1,AfterH)
colnames(C) <- c("0","1")
kable(C)
```


### Wave 3

#### Study-specific variable description

The study-specific variable elected to be harmonised is:

* Name: `MARITW3`
* Label: `CURRENT MARITAL STATUS`
* Categories: 
    + `1.0 = Married`
    + `2.0 = De facto`
    + `3.0 = Separated`
    + `4.0 = Divorced`
    + `5.0 = Widowed`
    + `6.0 = Never married`
* Missings: 
    + `9.0 = Missing`

* Name: `divorce` *harmonized variable from Wave2*

* Description: 
```{r assign3, echo=F}
opal.assign.table.tibble(o, 'ALSA_w3_divorce','ALSA.ALSA-Wave3', variables=list('MARITW3'), missings = TRUE)
```

```{r local3, echo=F}
ALSA_w3_divorce <- opal.execute(o,'ALSA_w3_divorce')
vari <- ALSA_w3_divorce$MARITW3
kable(Categorical_summary(vari, missing_values = c(9))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(9))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(9))[2], caption = "Type of missing")
#Categorical_summary(var = ALSA_w3_divorce$MARITW3, missing_values = NA)
ggplot(ALSA_w3_divorce, aes(x=factor(MARITW3))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Marital status") + ylab("Frequency")
```

#### Harmonisation algorithm
To recode the harmonize variable from the study-specific variable it has to be recoded as follows:  

* `if divorce=1 then (no matter what is MARITW3) OR MARITW3 equals 3 or 4 then recode into 1`
* `else if MARITW3 in {1,2,5,6} then recode into 0`
* `else if 9 or NA into 999`

**R script:**

```{r harmo3, echo=TRUE}

same_indiv <- function(old, new){
  new_2 <- matrix(NA, nrow = dim(new)[1], ncol=dim(old)[2])
  colnames(new_2) <- colnames(old)
  oldm <- as.matrix(old)
  
  for(i in 1:length(new$id)){
    if(sum(new$id[i]==old$id)>=1){
      new_2[i,] <- oldm[which(new$id[i]==old$id),]
    } else {
      new_2[i,] <- c(new$id[i], rep_len(NA,dim(old)[2]-1))
    }
  }
  new_2 <- data.frame(new_2)
  new_22 <- data.frame(id=new_2$id, MARITW3=new$MARITW3, divorce=new_2$divorce) 
                       # id = new_2$id
                       # colname_form_OLD_table = new_2$colname_form_OLD_table 
                       # colname_form_NEW_table = new$colname_form_NEW_table
  new_22
}

# old = ALSA_ds_w2 (divorce)
# new = ALSA_w3_divorce (MARITW3)

ALSA_w3_divorce_2 <- same_indiv(ALSA_ds_w2, ALSA_w3_divorce)
ALSA_ds_w3 <- tibble(id=ALSA_w3_divorce_2$id)

ALSA_w3_divorce_2$divorce <- car::recode(as.vector(ALSA_w3_divorce_2$divorce), "NA='-999'")
ALSA_w3_divorce_2$MARITW3 <- car::recode(as.vector(ALSA_w3_divorce_2$MARITW3), "NA='-999'")

ALSA_ds_w3$divorce <- c(NA)   
for(i in 1:dim(ALSA_w3_divorce_2[1])){
  if( ALSA_w3_divorce_2$divorce[i] == 1 | ALSA_w3_divorce_2$MARITW3[i] %in% c(3,4) ) { ALSA_ds_w3$divorce[i] = 1 }
  else if( ALSA_w3_divorce_2$MARITW3[i] %in% c(1,2,5,6) ) { ALSA_ds_w3$divorce[i] = 0 }
  else if( ALSA_w3_divorce_2$MARITW3[i] == 9 ) { ALSA_ds_w3$divorce[i] = 999 }
}

ALSA_ds_w3$divorce <- car::recode(as.vector(ALSA_ds_w3$divorce), "NA='999'")
ALSA_ds_w3$divorce <- labelled(ALSA_ds_w3$divorce, labels = c("No"=0, "Yes"=1, "Missing"=999, "Do not know"=998, "Refuse"=997, "Not applicable"=996, "Don't answer"=995,  "Not attempt/not done/not yet recorded"=994, "Disable to measure"=993, "Impute"=992, "CAPI/interviewer error"=991))
```

#### Statistical description of the new harmonised variable
```{r descript3, echo=F}
vari <- ALSA_ds_w3$divorce
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[3]) 
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[2], caption = "Type of missing")
#Categorical_summary(var = ALSA_ds_w3$divorce, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))
ggplot(ALSA_ds_w3, aes(x=factor(divorce))) + geom_bar(stat="count", width=0.4, fill="steelblue")+ xlab("Experience of divorce/separation") + ylab("Frequency")
```

##### Validation
```{r crosstabulation3, echo=F}
AfterH <- table(ALSA_ds_w3$divorce)
BeforeH <- table(ALSA_w3_divorce_2$divorce, ALSA_w3_divorce_2$MARITW3, useNA='ifany')
BeforeH1 <- c(NA)
BeforeH1[[2]] <- sum(sum(BeforeH[3,]), BeforeH[c(1,2),c(4,5)])
BeforeH1[[1]] <- sum(BeforeH[c(1,2),c(2:3,6:7)])
BeforeH1[[3]] <- sum(BeforeH[2,8], sum(BeforeH[c(1,2),1]))
C <- rbind(BeforeH1,AfterH)
colnames(C) <- c("0","1", "9&NA->999")
kable(C)
```




### Wave 4

#### Study-specific variable description

The study-specific variable elected to be harmonised is:

* Name: `MARITW4`
* Label: `MARITAL STATUS`
* Categories: 
    + `1.0 = Married`
    + `2.0 = De facto`
    + `3.0 = Separated`
    + `4.0 = Divorced`
    + `5.0 = Widowed`
    + `6.0 = Never married`
    
* Name: `divorce` *harmonized variable from Wave3*


* Description: 
```{r assign4, echo=F}
opal.assign.table.tibble(o, 'ALSA_w4_divorce','ALSA.ALSA-Wave4',variables=list('MARITW4'), missings = TRUE)
```

```{r local4, echo=F}
ALSA_w4_divorce <- opal.execute(o,'ALSA_w4_divorce')
vari <- ALSA_w4_divorce$MARITW4
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = ALSA_w4_divorce$MARITW4, missing_values = NA)
ggplot(ALSA_w4_divorce, aes(x=factor(MARITW4))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Marital status") + ylab("Frequency")
```

#### Harmonisation algorithm
To recode the harmonize variable from the study-specific variable it has to be recoded as follows:  

* `if divorce=1 then (no matter what is MARITW4) OR MARITW4 equals 3 or 4 then recode into 1`
* `else if MARITW4 in {1,2,5,6} then recode into 0`

**R script:**

```{r harmo4, echo=TRUE}

same_indiv <- function(old, new){
  new_2 <- matrix(NA, nrow = dim(new)[1], ncol=dim(old)[2])
  colnames(new_2) <- colnames(old)
  oldm <- as.matrix(old)
  
  for(i in 1:length(new$id)){
    if(sum(new$id[i]==old$id)>=1){
      new_2[i,] <- oldm[which(new$id[i]==old$id),]
    } else {
      new_2[i,] <- c(new$id[i], rep_len(NA,dim(old)[2]-1))
    }
  }
  new_2 <- data.frame(new_2)
  new_22 <- data.frame(id=new_2$id, MARITW4=new$MARITW4, divorce=new_2$divorce) 
                       # id = new_2$id
                       # colname_form_OLD_table = new_2$colname_form_OLD_table 
                       # colname_form_NEW_table = new$colname_form_NEW_table
  new_22
}

# old = ALSA_ds_w3 (divorce)
# new = ALSA_w4_divorce (MARITW4)

ALSA_w4_divorce_2 <- same_indiv(ALSA_ds_w3, ALSA_w4_divorce)
ALSA_ds_w4 <- tibble(id=ALSA_w4_divorce_2$id)

ALSA_w4_divorce_2$divorce <- car::recode(as.vector(ALSA_w4_divorce_2$divorce), "NA='-999'")
ALSA_w4_divorce_2$MARITW4 <- car::recode(as.vector(ALSA_w4_divorce_2$MARITW4), "NA='-999'")

ALSA_ds_w4$divorce <- c(NA)   
for(i in 1:dim(ALSA_w4_divorce_2[1])){
  if( ALSA_w4_divorce_2$divorce[i] == 1 | ALSA_w4_divorce_2$MARITW4[i] %in% c(3,4) ) { ALSA_ds_w4$divorce[i] = 1 }
  else if( ALSA_w4_divorce_2$MARITW4[i] %in% c(1,2,5,6) ) { ALSA_ds_w4$divorce[i] = 0 }
}

ALSA_ds_w4$divorce <- car::recode(as.vector(ALSA_ds_w4$divorce), "NA='999'")
ALSA_ds_w4$divorce <- labelled(ALSA_ds_w4$divorce, labels = c("No"=0, "Yes"=1, "Missing"=999, "Do not know"=998, "Refuse"=997, "Not applicable"=996, "Don't answer"=995,  "Not attempt/not done/not yet recorded"=994, "Disable to measure"=993, "Impute"=992, "CAPI/interviewer error"=991))
```

#### Statistical description of the new harmonised variable
```{r descript4, echo=F}
vari <- ALSA_ds_w4$divorce
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[3]) 
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[2], caption = "Type of missing")
#Categorical_summary(var = ALSA_ds_w4$divorce, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))
ggplot(ALSA_ds_w4, aes(x=factor(divorce))) + geom_bar(stat="count", width=0.4, fill="steelblue")+ xlab("Experience of divorce/separation") + ylab("Frequency")
```

##### Validation
```{r crosstabulation4, echo=F}
AfterH <- table(ALSA_ds_w4$divorce)
BeforeH <- table(ALSA_w4_divorce_2$divorce, ALSA_w4_divorce_2$MARITW4, useNA='ifany')
BeforeH1 <- c(NA)
BeforeH1[[2]] <- sum(sum(BeforeH[3,]), sum(BeforeH[c(1,2,4),c(3,4)]))
BeforeH1[[1]] <- sum(BeforeH[c(1,2,4),c(1,2,5,6)])
C <- rbind(BeforeH1,AfterH)
colnames(C) <- c("0","1")
kable(C)
```



### Wave 5

#### Study-specific variable description

The study-specific variable elected to be harmonised is:

* Name: `MARITW5`
* Label: `Q3 COULD YOU PLEASE TELL ME YOUR CURRENT MARITAL STATUS?`
* Categories: 
    + `1.0 = Married`
    + `2.0 = De facto`
    + `3.0 = Separated`
    + `4.0 = Divorced`
    + `5.0 = Widowed`
    + `6.0 = Never married`
    + `8.0 = Other`
* Missings:    
    + `7.0 = Refused (Do not read)`
    
* Name: `divorce` *harmonized variable from Wave4*

* Description: 
```{r assign5, echo=F}
opal.assign.table.tibble(o, 'ALSA_w5_divorce','ALSA.ALSA-Wave5',variables=list('MARITW5'), missings = TRUE)
```

```{r local5, echo=F}
ALSA_w5_divorce <- opal.execute(o,'ALSA_w5_divorce')
vari <- ALSA_w5_divorce$MARITW5
kable(Categorical_summary(vari, missing_values = c(7))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(7))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(7))[2], caption = "Type of missing")
#Categorical_summary(var = ALSA_w5_divorce$MARITW5, missing_values = NA)
ggplot(ALSA_w5_divorce, aes(x=factor(MARITW5))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Marital status") + ylab("Frequency")
```

#### Harmonisation algorithm
To recode the harmonize variable from the study-specific variable it has to be recoded as follows:  

* `if divorce=1 then (no matter what is MARITW5) OR MARITW5 equals 3 or 4 then recode into 1`
* `else if MARITW5 in {1,2,5,6} then recode into 0`
* `else if MARITW5=7 then recode into 997`
* `else if MARITW5=8 then recode into 999`

**R script:**

```{r harmo5, echo=TRUE}

same_indiv <- function(old, new){
  new_2 <- matrix(NA, nrow = dim(new)[1], ncol=dim(old)[2])
  colnames(new_2) <- colnames(old)
  oldm <- as.matrix(old)
  
  for(i in 1:length(new$id)){
    if(sum(new$id[i]==old$id)>=1){
      new_2[i,] <- oldm[which(new$id[i]==old$id),]
    } else {
      new_2[i,] <- c(new$id[i], rep_len(NA,dim(old)[2]-1))
    }
  }
  new_2 <- data.frame(new_2)
  new_22 <- data.frame(id=new_2$id, MARITW5=new$MARITW5, divorce=new_2$divorce) 
                       # id = new_2$id
                       # colname_form_OLD_table = new_2$colname_form_OLD_table 
                       # colname_form_NEW_table = new$colname_form_NEW_table
  new_22
}

# old = ALSA_ds_w4 (divorce)
# new = ALSA_w5_divorce (MARITW5)

ALSA_w5_divorce_2 <- same_indiv(ALSA_ds_w4, ALSA_w5_divorce)
ALSA_ds_w5 <- tibble(id=ALSA_w5_divorce_2$id)

ALSA_w5_divorce_2$divorce <- car::recode(as.vector(ALSA_w5_divorce_2$divorce), "NA='-999'")
ALSA_w5_divorce_2$MARITW5 <- car::recode(as.vector(ALSA_w5_divorce_2$MARITW5), "NA='-999'")

ALSA_ds_w5$divorce <- c(NA)   
for(i in 1:dim(ALSA_w5_divorce_2[1])){
  if( ALSA_w5_divorce_2$divorce[i] == 1 | ALSA_w5_divorce_2$MARITW5[i] %in% c(3,4) ) { ALSA_ds_w5$divorce[i] = 1 }
  else if( ALSA_w5_divorce_2$MARITW5[i] %in% c(1,2,5,6) ) { ALSA_ds_w5$divorce[i] = 0 }
  else if( ALSA_w5_divorce_2$MARITW5[i] == 7 ) { ALSA_ds_w5$divorce[i] = 997 }
  else if( ALSA_w5_divorce_2$MARITW5[i] == 8 ) { ALSA_ds_w5$divorce[i] = 999 }
}

ALSA_ds_w5$divorce <- car::recode(as.vector(ALSA_ds_w5$divorce), "NA='999'")
ALSA_ds_w5$divorce <- labelled(ALSA_ds_w5$divorce, labels = c("No"=0, "Yes"=1, "Missing"=999, "Do not know"=998, "Refuse"=997, "Not applicable"=996, "Don't answer"=995,  "Not attempt/not done/not yet recorded"=994, "Disable to measure"=993, "Impute"=992, "CAPI/interviewer error"=991))
```

#### Statistical description of the new harmonised variable
```{r descript5, echo=F}
vari <- ALSA_ds_w5$divorce
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[3]) 
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[2], caption = "Type of missing")
#Categorical_summary(var = ALSA_ds_w5$divorce, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))
ggplot(ALSA_ds_w5, aes(x=factor(divorce))) + geom_bar(stat="count", width=0.4, fill="steelblue")+ xlab("Experience of divorce/separation") + ylab("Frequency")
```

##### Validation
```{r crosstabulation5, echo=F}
AfterH <- table(ALSA_ds_w5$divorce)
BeforeH <- table(ALSA_w5_divorce_2$divorce, ALSA_w5_divorce_2$MARITW5, useNA='ifany')
BeforeH1 <- c(NA)
BeforeH1[[2]] <- sum(sum(BeforeH[3,]), sum(BeforeH[c(1,2),c(3,4)]))
BeforeH1[[1]] <- sum(BeforeH[c(1,2),c(1,2,5,6)])
BeforeH1[[3]] <- BeforeH[2,7]
C <- rbind(BeforeH1,AfterH)
colnames(C) <- c("0","1","7->997")
kable(C)
```



### Wave 6

#### Study-specific variable description

The study-specific variable elected to be harmonised is:

* Name: `MARITW6`
* Label: `marital status`
* Categories: 
    + `1.0 = Married`
    + `2.0 = De facto`
    + `3.0 = Separated`
    + `4.0 = Divorced`
    + `5.0 = Widowed`
    + `6.0 = Never married`
* Missings:    
    + `0.0 = no answer`

* Name: `divorce` *harmonized variable from Wave5*

* Description: 
```{r assign6, echo=F}
opal.assign.table.tibble(o, 'ALSA_w6_divorce','ALSA.ALSA-Wave6',variables=list('MARITW6'), missings = TRUE)
```

```{r local6, echo=F}
ALSA_w6_divorce <- opal.execute(o,'ALSA_w6_divorce')
vari <- ALSA_w6_divorce$MARITW6
kable(Categorical_summary(vari, missing_values = c(0))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(0))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(0))[2], caption = "Type of missing")
#Categorical_summary(var = ALSA_w6_divorce$MARITW6, missing_values = NA)
ggplot(ALSA_w6_divorce, aes(x=factor(MARITW6))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Marital status") + ylab("Frequency")
```

#### Harmonisation algorithm
To recode the harmonize variable from the study-specific variable it has to be recoded as follows:  

* `if divorce=1 then (no matter what is MARITW6) OR MARITW6 equals 3 or 4 then recode into 1`
* `else if MARITW6 in {1,2,5,6} then recode into 0`
* `else if MARITW6=0 then recode into 995`

**R script:**

```{r harmo6, echo=TRUE}

same_indiv <- function(old, new){
  new_2 <- matrix(NA, nrow = dim(new)[1], ncol=dim(old)[2])
  colnames(new_2) <- colnames(old)
  oldm <- as.matrix(old)
  
  for(i in 1:length(new$id)){
    if(sum(new$id[i]==old$id)>=1){
      new_2[i,] <- oldm[which(new$id[i]==old$id),]
    } else {
      new_2[i,] <- c(new$id[i], rep_len(NA,dim(old)[2]-1))
    }
  }
  new_2 <- data.frame(new_2)
  new_22 <- data.frame(id=new_2$id, MARITW6=new$MARITW6, divorce=new_2$divorce) 
                       # id = new_2$id
                       # colname_form_OLD_table = new_2$colname_form_OLD_table 
                       # colname_form_NEW_table = new$colname_form_NEW_table
  new_22
}

# old = ALSA_ds_w5 (divorce)
# new = ALSA_w6_divorce (MARITW6)

ALSA_w6_divorce_2 <- same_indiv(ALSA_ds_w5, ALSA_w6_divorce)
ALSA_ds_w6 <- tibble(id=ALSA_w6_divorce_2$id)

ALSA_w6_divorce_2$divorce <- car::recode(as.vector(ALSA_w6_divorce_2$divorce), "NA='-999'")
ALSA_w6_divorce_2$MARITW6 <- car::recode(as.vector(ALSA_w6_divorce_2$MARITW6), "NA='-999'")

ALSA_ds_w6$divorce <- c(NA)   
for(i in 1:dim(ALSA_w6_divorce_2[1])){
  if( ALSA_w6_divorce_2$divorce[i] == 1 | ALSA_w6_divorce_2$MARITW6[i] %in% c(3,4) ) { ALSA_ds_w6$divorce[i] = 1 }
  else if( ALSA_w6_divorce_2$MARITW6[i] %in% c(1,2,5,6) ) { ALSA_ds_w6$divorce[i] = 0 }
  else if( ALSA_w6_divorce_2$MARITW6[i] == 0 ) { ALSA_ds_w6$divorce[i] = 995 }
}


ALSA_ds_w6$divorce <- car::recode(as.vector(ALSA_ds_w6$divorce), "NA='999'")
ALSA_ds_w6$divorce <- labelled(ALSA_ds_w6$divorce, labels = c("No"=0, "Yes"=1, "Missing"=999, "Do not know"=998, "Refuse"=997, "Not applicable"=996, "Don't answer"=995,  "Not attempt/not done/not yet recorded"=994, "Disable to measure"=993, "Impute"=992, "CAPI/interviewer error"=991))
```

#### Statistical description of the new harmonised variable
```{r descript6, echo=F}
vari <- ALSA_ds_w6$divorce
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[3]) 
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[2], caption = "Type of missing")
#Categorical_summary(var = ALSA_ds_w6$divorce, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))
ggplot(ALSA_ds_w6, aes(x=factor(divorce))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Experience of divorce/separation") + ylab("Frequency")
```

#### Validation
```{r crosstabulation6, echo=F}
AfterH <- table(ALSA_ds_w6$divorce)
BeforeH <- table(ALSA_w6_divorce_2$divorce, ALSA_w6_divorce_2$MARITW6, useNA='ifany')
BeforeH1 <- c(NA)
BeforeH1[[2]] <- sum(sum(BeforeH[3,]), sum(BeforeH[c(1,2,4),c(4,5)]))
BeforeH1[[1]] <- sum(BeforeH[c(1,2,4),c(2,3,6,7)])
BeforeH1[[3]] <- sum(BeforeH[,1])
C <- rbind(BeforeH1,AfterH)
colnames(C) <- c("0","1","0->995")
kable(C)
```




### Wave 7

#### Study-specific variable description

The study-specific variable elected to be harmonised is:

* Name: `maritw7`
* Label: `Marital status`
* Categories: 
    + `1.0 = Married`
    + `2.0 = De facto`
    + `3.0 = Separated`
    + `4.0 = Divorced`
    + `5.0 = Widowed`
    + `6.0 = Never married`
* Missings:    
    + `0.0 = Not Answered`
    
* Name: `divorce` *harmonized variable from Wave6*

* Description: 
```{r assign7, echo=F}
opal.assign.table.tibble(o, 'ALSA_w7_divorce','ALSA.ALSA-Wave7',variables=list('maritw7'), missings = TRUE)
```

```{r local7, echo=F}
ALSA_w7_divorce <- opal.execute(o,'ALSA_w7_divorce')
vari <- ALSA_w7_divorce$maritw7
kable(Categorical_summary(vari, missing_values = c(0))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(0))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(0))[2], caption = "Type of missing")
#Categorical_summary(var = ALSA_w7_divorce$maritw7, missing_values = NA)
ggplot(ALSA_w7_divorce, aes(x=factor(maritw7))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Marital status") + ylab("Frequency")
```

#### Harmonisation algorithm
To recode the harmonize variable from the study-specific variable it has to be recoded as follows:  

* `if divorce=1 then (no matter what is maritw7) OR maritw7 equals 3 or 4 then recode into 1`
* `else if maritw7 in {1,2,5,6} then recode into 0`
* `else if maritw7=0 then recode into 995`

**R script:**

```{r harmo7, echo=TRUE}

same_indiv <- function(old, new){
  new_2 <- matrix(NA, nrow = dim(new)[1], ncol=dim(old)[2])
  colnames(new_2) <- colnames(old)
  oldm <- as.matrix(old)
  
  for(i in 1:length(new$id)){
    if(sum(new$id[i]==old$id)>=1){
      new_2[i,] <- oldm[which(new$id[i]==old$id),]
    } else {
      new_2[i,] <- c(new$id[i], rep_len(NA,dim(old)[2]-1))
    }
  }
  new_2 <- data.frame(new_2)
  new_22 <- data.frame(id=new_2$id, maritw7=new$maritw7, divorce=new_2$divorce) 
                       # id = new_2$id
                       # colname_form_OLD_table = new_2$colname_form_OLD_table 
                       # colname_form_NEW_table = new$colname_form_NEW_table
  new_22
}

# old = ALSA_ds_w6 (divorce)
# new = ALSA_w7_divorce (maritw7)

ALSA_w7_divorce_2 <- same_indiv(ALSA_ds_w6, ALSA_w7_divorce)
ALSA_ds_w7 <- tibble(id=ALSA_w7_divorce_2$id)

ALSA_w7_divorce_2$divorce <- car::recode(as.vector(ALSA_w7_divorce_2$divorce), "NA='-999'")
ALSA_w7_divorce_2$maritw7 <- car::recode(as.vector(ALSA_w7_divorce_2$maritw7), "NA='-999'")

ALSA_ds_w7$divorce <- c(NA)   
for(i in 1:dim(ALSA_w7_divorce_2[1])){
  if( ALSA_w7_divorce_2$divorce[i] == 1 | ALSA_w7_divorce_2$maritw7[i] %in% c(3,4) ) { ALSA_ds_w7$divorce[i] = 1 }
  else if( ALSA_w7_divorce_2$maritw7[i] %in% c(1,2,5,6) ) { ALSA_ds_w7$divorce[i] = 0 }
  else if( ALSA_w7_divorce_2$maritw7[i] == 0 ) { ALSA_ds_w7$divorce[i] = 995 }
}

ALSA_ds_w7$divorce <- car::recode(as.vector(ALSA_ds_w7$divorce), "NA='999'")
ALSA_ds_w7$divorce <- labelled(ALSA_ds_w7$divorce, labels = c("No"=0, "Yes"=1, "Missing"=999, "Do not know"=998, "Refuse"=997, "Not applicable"=996, "Don't answer"=995,  "Not attempt/not done/not yet recorded"=994, "Disable to measure"=993, "Impute"=992, "CAPI/interviewer error"=991))
```

#### Statistical description of the new harmonised variable
```{r descript7, echo=F}
vari <- ALSA_ds_w7$divorce
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[3]) 
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[2], caption = "Type of missing")
#Categorical_summary(var = ALSA_ds_w7$divorce, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))
ggplot(ALSA_ds_w7, aes(x=factor(divorce))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Experience of divorce/separation") + ylab("Frequency")
```

#### Validation
```{r crosstabulation7, echo=F}
AfterH <- table(ALSA_ds_w7$divorce)
BeforeH <- table(ALSA_w7_divorce_2$divorce, ALSA_w7_divorce_2$maritw7, useNA='ifany')
BeforeH1 <- c(NA)
BeforeH1[[2]] <- sum(sum(BeforeH[3,]), sum(BeforeH[c(1,2,4),c(4,5)]))
BeforeH1[[1]] <- sum(BeforeH[c(1,2,4),c(3,6,7)])
BeforeH1[[3]] <- sum(BeforeH[2,2])
BeforeH1[[4]] <- sum(BeforeH[c(1,2,4),1])
C <- rbind(BeforeH1,AfterH)
colnames(C) <- c("0","1","0->995","NA->999")
kable(C)
```




### Wave 8

#### Study-specific variable description

The study-specific variable elected to be harmonised is:

* Name: `maritw8`
* Label: `Marital status`
* Categories: 
    + `1.0 = Married`
    + `2.0 = De facto`
    + `3.0 = Separated`
    + `4.0 = Divorced`
    + `5.0 = Widowed`
    + `6.0 = Never married`
* Missings:    
    + `0.0 = Not Answered`
    
* Name: `divorce` *harmonized variable from Wave7*
    

* Description: 
```{r assign8, echo=F}
opal.assign.table.tibble(o, 'ALSA_w8_divorce','ALSA.ALSA-Wave8',variables=list('maritw8'), missings = TRUE)
```

```{r local8, echo=F}
ALSA_w8_divorce <- opal.execute(o,'ALSA_w8_divorce')
vari <- ALSA_w8_divorce$maritw8
kable(Categorical_summary(vari, missing_values = c(0))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(0))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(0))[2], caption = "Type of missing")
#Categorical_summary(var = ALSA_w8_divorce$maritw8, missing_values = NA)
ggplot(ALSA_w8_divorce, aes(x=factor(maritw8))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Marital status") + ylab("Frequency")
```

#### Harmonisation algorithm
To recode the harmonize variable from the study-specific variable it has to be recoded as follows:  

* `if divorce=1 then (no matter what is maritw8) OR maritw8 equals 3 or 4 then recode into 1`
* `else if maritw8 in {1,2,5,6} then recode into 0`
* `else if maritw8=0 then recode into 995`

**R script:**

```{r harmo8, echo=TRUE}

same_indiv <- function(old, new){
  new_2 <- matrix(NA, nrow = dim(new)[1], ncol=dim(old)[2])
  colnames(new_2) <- colnames(old)
  oldm <- as.matrix(old)
  
  for(i in 1:length(new$id)){
    if(sum(new$id[i]==old$id)>=1){
      new_2[i,] <- oldm[which(new$id[i]==old$id),]
    } else {
      new_2[i,] <- c(new$id[i], rep_len(NA,dim(old)[2]-1))
    }
  }
  new_2 <- data.frame(new_2)
  new_22 <- data.frame(id=new_2$id, maritw8=new$maritw8, divorce=new_2$divorce) 
                       # id = new_2$id
                       # colname_form_OLD_table = new_2$colname_form_OLD_table 
                       # colname_form_NEW_table = new$colname_form_NEW_table
  new_22
}

# old = ALSA_ds_w7 (divorce)
# new = ALSA_w8_divorce (maritw8)

ALSA_w8_divorce_2 <- same_indiv(ALSA_ds_w7, ALSA_w8_divorce)
ALSA_ds_w8 <- tibble(id=ALSA_w8_divorce_2$id)

ALSA_w8_divorce_2$divorce <- car::recode(as.vector(ALSA_w8_divorce_2$divorce), "NA='-999'")
ALSA_w8_divorce_2$maritw8 <- car::recode(as.vector(ALSA_w8_divorce_2$maritw8), "NA='-999'")

ALSA_ds_w8$divorce <- c(NA)   
for(i in 1:dim(ALSA_w8_divorce_2[1])){
  if( ALSA_w8_divorce_2$divorce[i] == 1 | ALSA_w8_divorce_2$maritw8[i] %in% c(3,4) ) { ALSA_ds_w8$divorce[i] = 1 }
  else if( ALSA_w8_divorce_2$maritw8[i] %in% c(1,2,5,6) ) { ALSA_ds_w8$divorce[i] = 0 }
  else if( ALSA_w8_divorce_2$maritw8[i] == 0 ) { ALSA_ds_w8$divorce[i] = 995 }
}

ALSA_ds_w8$divorce <- car::recode(as.vector(ALSA_ds_w8$divorce), "NA='999'")
ALSA_ds_w8$divorce <- labelled(ALSA_ds_w8$divorce, labels = c("No"=0, "Yes"=1, "Missing"=999, "Do not know"=998, "Refuse"=997, "Not applicable"=996, "Don't answer"=995,  "Not attempt/not done/not yet recorded"=994, "Disable to measure"=993, "Impute"=992, "CAPI/interviewer error"=991))
```

#### Statistical description of the new harmonised variable
```{r descript8, echo=F}
vari <- ALSA_ds_w8$divorce
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[3]) 
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[2], caption = "Type of missing")
#Categorical_summary(var = ALSA_ds_w8$divorce, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))
ggplot(ALSA_ds_w8, aes(x=factor(divorce))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Experience of divorce/separation") + ylab("Frequency")
```

#### Validation
```{r crosstabulation8, echo=F}
AfterH <- table(ALSA_ds_w8$divorce)
BeforeH <- table(ALSA_w8_divorce_2$divorce, ALSA_w8_divorce_2$maritw8, useNA='ifany')
BeforeH1 <- c(NA)
BeforeH1[[2]] <- sum(sum(BeforeH[2,]), sum(BeforeH[c(1,3,4),c(3,4)]))
BeforeH1[[1]] <- sum(BeforeH[c(1,3,4),c(2,5,6)])
BeforeH1[[3]] <- BeforeH[1,1]
C <- rbind(BeforeH1,AfterH)
colnames(C) <- c("0","1","0->995")
kable(C)
```



### Wave 9

#### Study-specific variable description

The study-specific variable elected to be harmonised is:

* Name: `MARITW9`
* Label: `Marital status`
* Categories: 
    + `1.0 = Married`
    + `2.0 = De facto`
    + `3.0 = Separated`
    + `4.0 = Divorced`
    + `5.0 = Widowed`
    + `6.0 = Never married`
* Missings:    
    + `0.0 = Not Answered`
    
* Name: `divorce` *harmonized variable from Wave8*

* Description: 
```{r assign9, echo=F}
opal.assign.table.tibble(o, 'ALSA_w9_divorce','ALSA.ALSA-Wave9',variables=list('MARITW9'), missings = TRUE)
ALSA_w9_divorce <- opal.execute(o,'ALSA_w9_divorce')
```

```{r local9, echo=F}
vari <- ALSA_w9_divorce$MARITW9
kable(Categorical_summary(vari, missing_values = c(0))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(0))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(0))[2], caption = "Type of missing")
#Categorical_summary(var = ALSA_w9_divorce$MARITW9, missing_values = NA)
ggplot(ALSA_w9_divorce, aes(x=factor(MARITW9))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Marital status") + ylab("Frequency")
```

#### Harmonisation algorithm
To recode the harmonize variable from the study-specific variable it has to be recoded as follows:  

* `if divorce=1 then (no matter what is MARITW9) OR MARITW9 equals 3 or 4 then recode into 1`
* `else if MARITW9 in {1,2,5,6} then recode into 0`
* `else if MARITW9=0 then recode into 995`

**R script:**

```{r harmo9, echo=TRUE}

same_indiv <- function(old, new){
  new_2 <- matrix(NA, nrow = dim(new)[1], ncol=dim(old)[2])
  colnames(new_2) <- colnames(old)
  oldm <- as.matrix(old)
  
  for(i in 1:length(new$id)){
    if(sum(new$id[i]==old$id)>=1){
      new_2[i,] <- oldm[which(new$id[i]==old$id),]
    } else {
      new_2[i,] <- c(new$id[i], rep_len(NA,dim(old)[2]-1))
    }
  }
  new_2 <- data.frame(new_2)
  new_22 <- data.frame(id=new_2$id, MARITW9=new$MARITW9, divorce=new_2$divorce) 
                       # id = new_2$id
                       # colname_form_OLD_table = new_2$colname_form_OLD_table 
                       # colname_form_NEW_table = new$colname_form_NEW_table
  new_22
}

# old = ALSA_ds_w8 (divorce)
# new = ALSA_w9_divorce (MARITW9)

ALSA_w9_divorce_2 <- same_indiv(ALSA_ds_w8, ALSA_w9_divorce)
ALSA_ds_w9 <- tibble(id=ALSA_w9_divorce_2$id)

ALSA_w9_divorce_2$divorce <- car::recode(as.vector(ALSA_w9_divorce_2$divorce), "NA='-999'")
ALSA_w9_divorce_2$MARITW9 <- car::recode(as.vector(ALSA_w9_divorce_2$MARITW9), "NA='-999'")

ALSA_ds_w9$divorce <- c(NA)   
for(i in 1:dim(ALSA_w9_divorce_2[1])){
  if( ALSA_w9_divorce_2$divorce[i] == 1 | ALSA_w9_divorce_2$MARITW9[i] %in% c(3,4) ) { ALSA_ds_w9$divorce[i] = 1 }
  else if( ALSA_w9_divorce_2$MARITW9[i] %in% c(1,2,5,6) ) { ALSA_ds_w9$divorce[i] = 0 }
  else if( ALSA_w9_divorce_2$MARITW9[i] == 0 ) { ALSA_ds_w9$divorce[i] = 995 }
}

ALSA_ds_w9$divorce <- car::recode(as.vector(ALSA_ds_w9$divorce), "NA='999'")
ALSA_ds_w9$divorce <- labelled(ALSA_ds_w9$divorce, labels = c("No"=0, "Yes"=1, "Missing"=999, "Do not know"=998, "Refuse"=997, "Not applicable"=996, "Don't answer"=995,  "Not attempt/not done/not yet recorded"=994, "Disable to measure"=993, "Impute"=992, "CAPI/interviewer error"=991))
```

#### Statistical description of the new harmonised variable
```{r descript9, echo=F}
vari <- ALSA_ds_w9$divorce
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[3]) 
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[2], caption = "Type of missing")
#Categorical_summary(var = ALSA_ds_w9$divorce, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))
ggplot(ALSA_ds_w9, aes(x=factor(divorce))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Experience of divorce/separation") + ylab("Frequency")
```

#### Validation
```{r crosstabulation9, echo=F}
AfterH <- table(ALSA_ds_w9$divorce)
BeforeH <- table(ALSA_w9_divorce_2$divorce, ALSA_w9_divorce_2$MARITW9, useNA='ifany')
BeforeH1 <- c(NA)
BeforeH1[[2]] <- sum(sum(BeforeH[3,]), sum(BeforeH[c(1,2,4),5]))
BeforeH1[[1]] <- sum(BeforeH[c(1,2,4),c(3,4,6,7)])
BeforeH1[[3]] <- BeforeH[2,2]
BeforeH1[[4]] <- sum(BeforeH[c(1,2),1])
C <- rbind(BeforeH1,AfterH)
colnames(C) <- c("0","1","0->995","NA->999")
kable(C)
```




### Wave 10

#### Study-specific variable description

The study-specific variable elected to be harmonised is:

* Name: `maritw10`
* Label: `marital status`
* Categories: 
    + `1.0 = Married`
    + `2.0 = De facto`
    + `3.0 = Separated`
    + `4.0 = Divorced`
    + `5.0 = Widowed`
    + `6.0 = Never married`
* Missings:    
    + `99.0 = Not Answered`
    
* Name: `divorce` *harmonized variable from Wave9*


* Description: 
```{r assign10, echo=F}
opal.assign.table.tibble(o, 'ALSA_w10_divorce','ALSA.ALSA-Wave10',variables=list('maritw10'), missings = TRUE)
ALSA_w10_divorce <- opal.execute(o,'ALSA_w10_divorce')
```

```{r local10, echo=F}
vari <- ALSA_w10_divorce$maritw10
kable(Categorical_summary(vari, missing_values = c(99))[3], caption = attributes(vari)$`spss::shortName`) 
kable(Categorical_summary(vari, missing_values = c(99))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(99))[2], caption = "Type of missing")
#Categorical_summary(var = ALSA_w10_divorce$maritw10, missing_values = NA)
ggplot(ALSA_w10_divorce, aes(x=factor(maritw10))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Marital status") + ylab("Frequency")
```

#### Harmonisation algorithm
To recode the harmonize variable from the study-specific variable it has to be recoded as follows:  

* `if divorce=1 then (no matter what is maritw10) OR maritw10 equals 3 or 4 then recode into 1`
* `else if maritw10 in {1,2,5,6} then recode into 0`
* `else if maritw10=99 then recode into 995`

**R script:**

```{r harmo10, echo=TRUE}

same_indiv <- function(old, new){
  new_2 <- matrix(NA, nrow = dim(new)[1], ncol=dim(old)[2])
  colnames(new_2) <- colnames(old)
  oldm <- as.matrix(old)
  
  for(i in 1:length(new$id)){
    if(sum(new$id[i]==old$id)>=1){
      new_2[i,] <- oldm[which(new$id[i]==old$id),]
    } else {
      new_2[i,] <- c(new$id[i], rep_len(NA,dim(old)[2]-1))
    }
  }
  new_2 <- data.frame(new_2)
  new_22 <- data.frame(id=new_2$id, maritw10=new$maritw10, divorce=new_2$divorce) 
                       # id = new_2$id
                       # colname_form_OLD_table = new_2$colname_form_OLD_table 
                       # colname_form_NEW_table = new$colname_form_NEW_table
  new_22
}

# old = ALSA_ds_w9 (divorce)
# new = ALSA_w10_divorce (maritw10)

ALSA_w10_divorce_2 <- same_indiv(ALSA_ds_w9, ALSA_w10_divorce)
ALSA_ds_w10 <- tibble(id=ALSA_w10_divorce_2$id)

ALSA_w10_divorce_2$divorce <- car::recode(as.vector(ALSA_w10_divorce_2$divorce), "NA='-999'")
ALSA_w10_divorce_2$maritw10 <- car::recode(as.vector(ALSA_w10_divorce_2$maritw10), "NA='-999'")

ALSA_ds_w10$divorce <- c(NA)   
for(i in 1:dim(ALSA_w10_divorce_2[1])){
  if( ALSA_w10_divorce_2$divorce[i] == 1 | ALSA_w10_divorce_2$maritw10[i] %in% c(3,4) ) { ALSA_ds_w10$divorce[i] = 1 }
  else if( ALSA_w10_divorce_2$maritw10[i] %in% c(1,2,5,6) ) { ALSA_ds_w10$divorce[i] = 0 }
  else if( ALSA_w10_divorce_2$maritw10[i] == 99 ) { ALSA_ds_w10$divorce[i] = 995 }
}

ALSA_ds_w10$divorce <- car::recode(as.vector(ALSA_ds_w10$divorce), "NA='999'")
ALSA_ds_w10$divorce <- labelled(ALSA_ds_w10$divorce, labels = c("No"=0, "Yes"=1, "Missing"=999, "Do not know"=998, "Refuse"=997, "Not applicable"=996, "Don't answer"=995,  "Not attempt/not done/not yet recorded"=994, "Disable to measure"=993, "Impute"=992, "CAPI/interviewer error"=991))
```

#### Statistical description of the new harmonised variable
```{r descript10, echo=F}
vari <- ALSA_ds_w10$divorce
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[3]) 
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[2], caption = "Type of missing")
#Categorical_summary(var = ALSA_ds_w10$divorce, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))
ggplot(ALSA_ds_w10, aes(x=factor(divorce))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Experience of divorce/separation") + ylab("Frequency")
```

#### Validation
```{r crosstabulation10, echo=F}
AfterH <- table(ALSA_ds_w10$divorce)
BeforeH <- table(ALSA_w10_divorce_2$divorce, ALSA_w10_divorce_2$maritw10, useNA='ifany')
BeforeH1 <- c(NA)
BeforeH1[[2]] <- sum(sum(BeforeH[2,]), sum(BeforeH[c(1,3,4),3]))
BeforeH1[[1]] <- sum(BeforeH[c(1,3,4),c(1,2,4,5)])
BeforeH1[[3]] <- sum(BeforeH[c(1,3,4),6])
C <- rbind(BeforeH1,AfterH)
colnames(C) <- c("0","1","99->995")
kable(C)
```





### Wave 11

#### Study-specific variable description

The study-specific variable elected to be harmonised is:

* Name: `MARITW11`
* Label: `marital status`
* Categories: 
    + `1.0 = Married`
    + `2.0 = De facto`
    + `3.0 = Separated`
    + `4.0 = Divorced`
    + `5.0 = Widowed`
    + `6.0 = Never married`
    
* Name: `divorce` *harmonized variable from Wave10*


* Description: 
```{r assign11, echo=F}
opal.assign.table.tibble(o, 'ALSA_w11_divorce','ALSA.ALSA-Wave11',variables=list('MARITW11'), missings = TRUE)
```

```{r local11, echo=F}
ALSA_w11_divorce <- opal.execute(o,'ALSA_w11_divorce')
vari <- ALSA_w11_divorce$MARITW11
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = ALSA_w11_divorce$MARITW11, missing_values = NA)
ggplot(ALSA_w11_divorce, aes(x=factor(MARITW11))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Marital status") + ylab("Frequency")
```

#### Harmonisation algorithm
To recode the harmonize variable from the study-specific variable it has to be recoded as follows:  

* `if divorce=1 then (no matter what is MARITW11) OR MARITW11 equals 3 or 4 then recode into 1`
* `else if MARITW11 in {1,2,5,6} then recode into 0`

**R script:**

```{r harmo11, echo=TRUE}

same_indiv <- function(old, new){
  new_2 <- matrix(NA, nrow = dim(new)[1], ncol=dim(old)[2])
  colnames(new_2) <- colnames(old)
  oldm <- as.matrix(old)
  
  for(i in 1:length(new$id)){
    if(sum(new$id[i]==old$id)>=1){
      new_2[i,] <- oldm[which(new$id[i]==old$id),]
    } else {
      new_2[i,] <- c(new$id[i], rep_len(NA,dim(old)[2]-1))
    }
  }
  new_2 <- data.frame(new_2)
  new_22 <- data.frame(id=new_2$id, MARITW11=new$MARITW11, divorce=new_2$divorce) 
                       # id = new_2$id
                       # colname_form_OLD_table = new_2$colname_form_OLD_table 
                       # colname_form_NEW_table = new$colname_form_NEW_table
  new_22
}

# old = ALSA_ds_w10 (divorce)
# new = ALSA_w11_divorce (MARITW11)

ALSA_w11_divorce_2 <- same_indiv(ALSA_ds_w10, ALSA_w11_divorce)
ALSA_ds_w11 <- tibble(id=ALSA_w11_divorce_2$id)

ALSA_w11_divorce_2$divorce <- car::recode(as.vector(ALSA_w11_divorce_2$divorce), "NA='-999'")
ALSA_w11_divorce_2$MARITW11 <- car::recode(as.vector(ALSA_w11_divorce_2$MARITW11), "NA='-999'")

ALSA_ds_w11$divorce <- c(NA)   
for(i in 1:dim(ALSA_w11_divorce_2[1])){
  if( ALSA_w11_divorce_2$divorce[i] == 1 | ALSA_w11_divorce_2$MARITW11[i] %in% c(3,4) ) { ALSA_ds_w11$divorce[i] = 1 }
  else if( ALSA_w11_divorce_2$MARITW11[i] %in% c(1,2,5,6) ) { ALSA_ds_w11$divorce[i] = 0 }
}

ALSA_ds_w11$divorce <- car::recode(as.vector(ALSA_ds_w11$divorce), "NA='999'")
ALSA_ds_w11$divorce <- labelled(ALSA_ds_w11$divorce, labels = c("No"=0, "Yes"=1, "Missing"=999, "Do not know"=998, "Refuse"=997, "Not applicable"=996, "Don't answer"=995,  "Not attempt/not done/not yet recorded"=994, "Disable to measure"=993, "Impute"=992, "CAPI/interviewer error"=991))
```

#### Statistical description of the new harmonised variable
```{r descript11, echo=F}
vari <- ALSA_ds_w11$divorce
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[3]) 
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[2], caption = "Type of missing")
#Categorical_summary(var = ALSA_ds_w11$divorce, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))
ggplot(ALSA_ds_w11, aes(x=factor(divorce))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Experience of divorce/separation") + ylab("Frequency")
```

#### Validation
```{r crosstabulation11, echo=F}
AfterH <- table(ALSA_ds_w11$divorce)
BeforeH <- table(ALSA_w11_divorce_2$divorce, ALSA_w11_divorce_2$MARITW11, useNA='ifany')
BeforeH1 <- c(NA)
BeforeH1[[2]] <- sum(sum(BeforeH[3,]), sum(BeforeH[c(1,2,4),3]))
BeforeH1[[1]] <- sum(BeforeH[c(1,2,4),c(1,2,4,5)])
C <- rbind(BeforeH1,AfterH)
colnames(C) <- c("0","1")
kable(C)
```



### Wave 12

#### Study-specific variable description

The study-specific variable elected to be harmonised is:

* Name: `MARITW12`
* Label: `marital status`
* Categories: 
    + `1.0 = Married`
    + `2.0 = De facto`
    + `3.0 = Separated`
    + `4.0 = Divorced`
    + `5.0 = Widowed`
    + `6.0 = Never married`
    
* Name: `divorce` *harmonized variable from Wave11*
    
* Description: 
```{r assign12, echo=F}
opal.assign.table.tibble(o, 'ALSA_w12_divorce','ALSA.ALSA-Wave12',variables=list('MARITW12'), missings = TRUE)
```

```{r local12, echo=F}
ALSA_w12_divorce <- opal.execute(o,'ALSA_w12_divorce')
vari <- ALSA_w12_divorce$MARITW12
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = ALSA_w12_divorce$MARITW12, missing_values = NA)
ggplot(ALSA_w12_divorce, aes(x=factor(MARITW12))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Marital status") + ylab("Frequency")
```

#### Harmonisation algorithm
To recode the harmonize variable from the study-specific variable it has to be recoded as follows:  

* `if divorce=1 then (no matter what is MARITW12) OR MARITW12 equals 3 or 4 then recode into 1`
* `else if MARITW12 in {1,2,5,6} then recode into 0`

**R script:**

```{r harmo12, echo=TRUE}

same_indiv <- function(old, new){
  new_2 <- matrix(NA, nrow = dim(new)[1], ncol=dim(old)[2])
  colnames(new_2) <- colnames(old)
  oldm <- as.matrix(old)
  
  for(i in 1:length(new$id)){
    if(sum(new$id[i]==old$id)>=1){
      new_2[i,] <- oldm[which(new$id[i]==old$id),]
    } else {
      new_2[i,] <- c(new$id[i], rep_len(NA,dim(old)[2]-1))
    }
  }
  new_2 <- data.frame(new_2)
  new_22 <- data.frame(id=new_2$id, MARITW12=new$MARITW12, divorce=new_2$divorce) 
                       # id = new_2$id
                       # colname_form_OLD_table = new_2$colname_form_OLD_table 
                       # colname_form_NEW_table = new$colname_form_NEW_table
  new_22
}

# old = ALSA_ds_w11 (divorce)
# new = ALSA_w12_divorce (MARITW12)

ALSA_w12_divorce_2 <- same_indiv(ALSA_ds_w11, ALSA_w12_divorce)
ALSA_ds_w12 <- tibble(id=ALSA_w12_divorce_2$id)

ALSA_w12_divorce_2$divorce <- car::recode(as.vector(ALSA_w12_divorce_2$divorce), "NA='-999'")
ALSA_w12_divorce_2$MARITW12 <- car::recode(as.vector(ALSA_w12_divorce_2$MARITW12), "NA='-999'")

ALSA_ds_w12$divorce <- c(NA)   
for(i in 1:dim(ALSA_w12_divorce_2[1])){
  if( ALSA_w12_divorce_2$divorce[i] == 1 | ALSA_w12_divorce_2$MARITW12[i] %in% c(3,4) ) { ALSA_ds_w12$divorce[i] = 1 }
  else if( ALSA_w12_divorce_2$MARITW12[i] %in% c(1,2,5,6) ) { ALSA_ds_w12$divorce[i] = 0 }
}

ALSA_ds_w12$divorce <- car::recode(as.vector(ALSA_ds_w12$divorce), "NA='999'")
ALSA_ds_w12$divorce <- labelled(ALSA_ds_w12$divorce, labels = c("No"=0, "Yes"=1, "Missing"=999, "Do not know"=998, "Refuse"=997, "Not applicable"=996, "Don't answer"=995,  "Not attempt/not done/not yet recorded"=994, "Disable to measure"=993, "Impute"=992, "CAPI/interviewer error"=991))
```

#### Statistical description of the new harmonised variable
```{r descript12, echo=F}
vari <- ALSA_ds_w12$divorce
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[3]) 
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[2], caption = "Type of missing")
#Categorical_summary(var = ALSA_ds_w12$divorce, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))
ggplot(ALSA_ds_w12, aes(x=factor(divorce))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Experience of divorce/separation") + ylab("Frequency")
```

#### Validation
```{r crosstabulation12, echo=F}
AfterH <- table(ALSA_ds_w12$divorce)
BeforeH <- table(ALSA_w12_divorce_2$divorce, ALSA_w12_divorce_2$MARITW12, useNA='ifany')
BeforeH1 <- c(NA)
BeforeH1[[2]] <- sum(sum(BeforeH[3,]), sum(BeforeH[c(1,2),2]))
BeforeH1[[1]] <- sum(BeforeH[c(1,2),c(1,3,4)])
C <- rbind(BeforeH1,AfterH)
colnames(C) <- c("0","1")
kable(C)
```




### Wave 13

#### Study-specific variable description

The study-specific variable elected to be harmonised is:

* Name: `MARITW13`
* Label: `marital status`
* Categories: 
    + `1.0 = Married`
    + `2.0 = De facto`
    + `3.0 = Separated`
    + `4.0 = Divorced`
    + `5.0 = Widowed`
    + `6.0 = Never married`
    
* Name: `divorce` *harmonized variable from Wave12*


* Description: 
```{r assign13, echo=F}
opal.assign.table.tibble(o, 'ALSA_w13_divorce','ALSA.ALSA-Wave13',variables=list('MARITW13'), missings = TRUE)
```

```{r local13, echo=F}
ALSA_w13_divorce <- opal.execute(o,'ALSA_w13_divorce')
vari <- ALSA_w13_divorce$MARITW13
kable(Categorical_summary(vari, missing_values = NA)[2], caption = attributes(vari)$`spss::shortName`)
kable(Categorical_summary(vari, missing_values = NA)[1], caption = "Category")
#Categorical_summary(var = ALSA_w13_divorce$MARITW13, missing_values = NA)
ggplot(ALSA_w13_divorce, aes(x=factor(MARITW13))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Marital status") + ylab("Frequency")
```

#### Harmonisation algorithm
To recode the harmonize variable from the study-specific variable it has to be recoded as follows:  

* `if divorce=1 then (no matter what is MARITW13) OR MARITW13 equals 3 or 4 then recode into 1`
* `else if MARITW13 in {1,2,5,6} then recode into 0`

**R script:**

```{r harmo13, echo=TRUE}

same_indiv <- function(old, new){
  new_2 <- matrix(NA, nrow = dim(new)[1], ncol=dim(old)[2])
  colnames(new_2) <- colnames(old)
  oldm <- as.matrix(old)
  
  for(i in 1:length(new$id)){
    if(sum(new$id[i]==old$id)>=1){
      new_2[i,] <- oldm[which(new$id[i]==old$id),]
    } else {
      new_2[i,] <- c(new$id[i], rep_len(NA,dim(old)[2]-1))
    }
  }
  new_2 <- data.frame(new_2)
  new_22 <- data.frame(id=new_2$id, MARITW13=new$MARITW13, divorce=new_2$divorce) 
                       # id = new_2$id
                       # colname_form_OLD_table = new_2$colname_form_OLD_table 
                       # colname_form_NEW_table = new$colname_form_NEW_table
  new_22
}

# old = ALSA_ds_w12 (divorce)
# new = ALSA_w13_divorce (MARITW13)

ALSA_w13_divorce_2 <- same_indiv(ALSA_ds_w12, ALSA_w13_divorce)
ALSA_ds_w13 <- tibble(id=ALSA_w13_divorce_2$id)

ALSA_w13_divorce_2$divorce <- car::recode(as.vector(ALSA_w13_divorce_2$divorce), "NA='-999'")
ALSA_w13_divorce_2$MARITW13 <- car::recode(as.vector(ALSA_w13_divorce_2$MARITW13), "NA='-999'")

ALSA_ds_w13$divorce <- c(NA)   
for(i in 1:dim(ALSA_w13_divorce_2[1])){
  if( ALSA_w13_divorce_2$divorce[i] == 1 | ALSA_w13_divorce_2$MARITW13[i] %in% c(3,4) ) { ALSA_ds_w13$divorce[i] = 1 }
  else if( ALSA_w13_divorce_2$MARITW13[i] %in% c(1,2,5,6) ) { ALSA_ds_w13$divorce[i] = 0 }
}

ALSA_ds_w13$divorce <- car::recode(as.vector(ALSA_ds_w13$divorce), "NA='999'")
ALSA_ds_w13$divorce <- labelled(ALSA_ds_w13$divorce, labels = c("No"=0, "Yes"=1, "Missing"=999, "Do not know"=998, "Refuse"=997, "Not applicable"=996, "Don't answer"=995,  "Not attempt/not done/not yet recorded"=994, "Disable to measure"=993, "Impute"=992, "CAPI/interviewer error"=991))
```

#### Statistical description of the new harmonised variable
```{r descript13, echo=F}
vari <- ALSA_ds_w13$divorce
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[3]) 
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[1], caption = "Category")
kable(Categorical_summary(vari, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))[2], caption = "Type of missing")
#Categorical_summary(var = ALSA_ds_w13$divorce, missing_values = c(991, 992, 993, 994, 995, 996, 997, 998, 999))
ggplot(ALSA_ds_w13, aes(x=factor(divorce))) + geom_bar(stat="count", width=0.4, fill="steelblue") + xlab("Experience of divorce/separation") + ylab("Frequency")
```

#### Validation
```{r crosstabulation13, echo=F}
AfterH <- table(ALSA_ds_w13$divorce)
BeforeH <- table(ALSA_w13_divorce_2$divorce, ALSA_w13_divorce_2$MARITW13, useNA='ifany')
BeforeH1 <- c(NA)
BeforeH1[[2]] <- sum(sum(BeforeH[2,]), sum(BeforeH[c(1),2]))
BeforeH1[[1]] <- sum(BeforeH[c(1),c(1,3,4)])
C <- rbind(BeforeH1,AfterH)
colnames(C) <- c("0","1")
kable(C)
```


```{r save, echo=FALSE}
divorce <- ALSA_ds_w1
save(divorce, file = "../RData/w1/divorce.RData")
rm(divorce)

divorce <- ALSA_ds_w2
save(divorce, file = "../RData/w2/divorce.RData")
rm(divorce)

divorce <- ALSA_ds_w3
save(divorce, file = "../RData/w3/divorce.RData")
rm(divorce)

divorce <- ALSA_ds_w4
save(divorce, file = "../RData/w4/divorce.RData")
rm(divorce)

divorce <- ALSA_ds_w5
save(divorce, file = "../RData/w5/divorce.RData")
rm(divorce)

divorce <- ALSA_ds_w6
save(divorce, file = "../RData/w6/divorce.RData")
rm(divorce)

divorce <- ALSA_ds_w7
save(divorce, file = "../RData/w7/divorce.RData")
rm(divorce)

divorce <- ALSA_ds_w8
save(divorce, file = "../RData/w8/divorce.RData")
rm(divorce)

divorce <- ALSA_ds_w9
save(divorce, file = "../RData/w9/divorce.RData")
rm(divorce)

divorce <- ALSA_ds_w10
save(divorce, file = "../RData/w10/divorce.RData")
rm(divorce)

divorce <- ALSA_ds_w11
save(divorce, file = "../RData/w11/divorce.RData")
rm(divorce)

divorce <- ALSA_ds_w12
save(divorce, file = "../RData/w12/divorce.RData")
rm(divorce)

divorce <- ALSA_ds_w13
save(divorce, file = "../RData/w13/divorce.RData")
rm(divorce)

```



# Quality estimation
```{r closeRsession, echo=FALSE} 
opal.logout(o)
```
 
